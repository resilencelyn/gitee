<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yunze.common.mapper.yunze.YzCategoryMapper">

    <sql id="selwhere">
        <where>
            <if test="value!=null and value!=''">
                <if test="type==1">
                    and category_name LIKE CONCAT(#{value},'%')
                </if>
                <if test="type==2">
                    and category_code LIKE CONCAT(#{value},'%')
                </if>
            </if>
            <if test="category_status != '' and category_status != null ">
                category_status =#{category_status}
            </if>
            <if test="timetype != null and timetype != '' and staTime!=null and endTime != null">
                AND
                <if test="timetype == 1">
                    DATE_FORMAT( modified_time , '%Y-%m-%d' )
                </if>
                BETWEEN #{staTime} AND #{endTime}
            </if>
        </where>
    </sql>

    <!--查询总数-->
    <select id="selMapCount" parameterType="java.util.HashMap"  resultType="java.lang.Integer">
        SELECT
            COUNT(1)
        FROM
            yz_wx_by_product_category
        <include refid="selwhere"/>
    </select>

    <!--查询所有-->
    <select id="CategoryList" parameterType="java.util.HashMap" resultType="java.util.HashMap">
        SELECT category_id,category_name,category_code,parent_id,category_level,
               category_status,
               DATE_FORMAT( modified_time, "%Y-%m-%d %H:%i:%S" ) AS modified_time
        FROM
            yz_wx_by_product_category
        <include refid="selwhere"/>
        LIMIT #{StarRow},#{PageSize}
    </select>


</mapper>