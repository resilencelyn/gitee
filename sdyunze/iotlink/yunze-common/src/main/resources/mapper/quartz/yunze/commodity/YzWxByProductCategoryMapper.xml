<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yunze.common.mapper.yunze.commodity.YzWxByProductCategoryMapper">


    <sql id="selwhere" >
        <where>
            <if test="value!=null and value!=''">
                <if test="type==1">
                    and category_name LIKE CONCAT(#{value},'%')
                </if>
            </if>
        </where>
    </sql>

    <!--获取商品分类 分类 1 级 状态可看 -->
    <select id="getCategory" parameterType="java.util.HashMap" resultType="java.util.HashMap">
        SELECT
            category_id,
            category_name,
            category_code
        FROM
            yz_wx_by_product_category
    </select>


    <!--获取商品分类 分类 1 级 状态可看 -->
    <select id="findConcise" parameterType="java.util.HashMap" resultType="java.util.HashMap">
        SELECT
            category_id,
			category_name as 'text',
			category_code as 'value'
        FROM
        	yz_wx_by_product_category
        <where>
            category_status = '1'
            and category_level = '1'
        </where>
    </select>


    <select id="selMap"  parameterType="java.util.HashMap" resultType="java.util.HashMap">
        SELECT
            category_id,
            category_name,
            category_code,
            parent_id,
            category_level,
            category_status,
            DATE_FORMAT( modified_time, "%Y-%m-%d %H:%i:%S" ) AS modified_time
        FROM
            yz_wx_by_product_category
        <include refid="selwhere"/>
    </select>



    <insert id="save"  parameterType="java.util.HashMap">
        INSERT INTO
        yz_wx_by_product_category
        (
            category_name,
            category_code,
            parent_id,
            category_level,
            category_status,
            modified_time
        )
        VALUE(
            #{category_name},
            #{category_code},
            #{parent_id},
            #{category_level},
            1,
            now()
        )
    </insert>


    <update id="upd"  parameterType="java.util.HashMap">
        update
        yz_wx_by_product_category
       <set>
           category_name = #{category_name},
           category_code = #{category_code},
           parent_id = #{parent_id},
           category_level = #{category_level},
           category_status = #{category_status}
       </set>
       <where>
           category_id = #{category_id}
       </where>
    </update>



    <select id="findCode" parameterType="java.util.HashMap" resultType="java.lang.String">
        SELECT
            category_code
        FROM
            yz_wx_by_product_category
        <where>
            category_id = #{category_id}
        </where>
    </select>


</mapper>