(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[650],{59126:function(X,T,n){"use strict";n.r(T),n.d(T,{Data:function(){return W},default:function(){return Je}});var l=n(67294),b=n(60674),h=n(18111),Z=n(2824),O=n(5527),C=n(2299),A=n(11628),k=n(21063),e=n(85893),w=(0,C.Pi)(function(){var a=(0,l.useContext)(h.xi),t=a.dataStore,i=(0,A.IE)(),r=i.schema,s=t.records||[],o=(0,l.useMemo)(function(){var x=(0,h.ZZ)(r);if(x.length==0)x.push({name:"\u6682\u65E0\u6570\u636E!"});else return x.push({name:"totalTime",title:"\u7B54\u5377\u65F6\u957F"}),x.push({name:"deviceType",title:"\u8BBE\u5907\u7C7B\u578B"}),x.push({name:"platform",title:"\u5E73\u53F0\u7C7B\u578B"}),x},[r]),y=(0,l.useState)({width:-1,height:-1}),c=(0,Z.Z)(y,2),d=c[0],f=c[1];return(0,l.useEffect)(function(){r&&t.loadData()},[r]),(0,e.jsx)(O.Z,{bounds:!0,onResize:function(u){u.bounds&&f(u.bounds)},children:function(u){var m=u.measureRef;return(0,e.jsx)("div",{className:"dataTable-container",ref:m,children:(0,e.jsx)(k._$,{editable:!1,height:d.height,width:d.width,selectionMode:"row",allowSorting:!0,schema:o,data:(0,h.IR)(s,o),onSelect:function(D){t.selected=D.filter(function(g){return g}).map(function(g){return g._i})},onDoubleClick:function(D){return D.style==="cell"||D.style==="activeCell"?(t.currentIndex=D.data._i,!0):!1}})})}})}),q=n(1013),_=n.n(q),nn=n(71194),z=n(50146),tn=n(57663),E=n(71577),$=n(7354),ee=(0,C.Pi)(function(a){var t=a.onCancel,i=(0,l.useContext)(h.xi),r=i.dataStore,s=(0,A.IE)(),o=s.schema,y=(0,l.useRef)(null),c=(0,l.useRef)(null),d=(0,l.useRef)(new Date().getTime()),f=(0,l.useState)(!1),x=(0,Z.Z)(f,2),u=x[0],m=x[1],I=function(){return o?(0,e.jsx)($.O,{ref:c,schema:o,headerVisible:!1,paginationVisible:!1,footerVisible:!1,onUpload:r.upload}):(0,e.jsx)(e.Fragment,{})},D=function(p){var P;m(!0),(P=c.current)===null||P===void 0||P.submit().then(function(N){N?r.saveData({answer:N.values,attachment:N.attachments,metaInfo:{answerInfo:{startTime:d.current,endTime:new Date().getTime()}}}).then(function(){d.current=new Date().getTime(),m(!1),r.loadData(),p&&p()}):m(!1)})};return(0,e.jsx)("div",{ref:y,className:"add-data",children:(0,e.jsx)(z.Z,{visible:!0,maskClosable:!1,getContainer:function(){return y.current},title:"\u6DFB\u52A0\u6570\u636E",width:600,onCancel:t,footer:(0,e.jsxs)("div",{className:"footer",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)(E.Z,{type:"primary",loading:u,onClick:function(){return D(t)},children:"\u63D0\u4EA4"}),(0,e.jsx)(E.Z,{onClick:function(){t()},children:"\u53D6\u6D88"})]}),(0,e.jsx)("div",{children:(0,e.jsx)(E.Z,{loading:u,type:"link",onClick:function(){D(function(){var p;return(p=c.current)===null||p===void 0?void 0:p.reset()})},children:"\u63D0\u4EA4\u5E76\u518D\u586B\u4E00\u4EFD"})})]}),children:(0,e.jsx)("div",{style:{maxHeight:300,overflowY:"auto"},children:I()})})})}),ne=(0,C.Pi)(function(){var a=(0,l.useState)(!1),t=(0,Z.Z)(a,2),i=t[0],r=t[1];return(0,e.jsxs)("div",{className:"toolbar-item",children:[(0,e.jsxs)("a",{onClick:function(){return r(!0)},children:[(0,e.jsx)(_(),{size:18,style:{cursor:"pointer"}}),"\u6DFB\u52A0\u6570\u636E"]}),i&&(0,e.jsx)(ee,{onCancel:function(){return r(!1)}})]})}),te=n(93756),ae=n.n(te),re=(0,C.Pi)(function(){var a=(0,l.useContext)(h.xi),t=a.dataStore;return(0,e.jsx)("div",{className:"toolbar-item",style:{width:45,borderRight:"1px solid #c5c5c5"},children:(0,e.jsx)("a",{onClick:function(){t.loadData()},children:(0,e.jsx)(ae(),{size:18,style:{cursor:"pointer"}})})})}),an=n(34792),U=n(48086),se=n(84199),ie=n.n(se),le=n(57119),oe=(0,C.Pi)(function(){var a=(0,l.useContext)(h.xi),t=a.dataStore,i=t.selected,r=(0,l.useRef)(null),s=function(){(i==null?void 0:i.length)===0?U.default.error("\u8BF7\u9009\u62E9\u8981\u5220\u9664\u7684\u533A\u57DF"):z.Z.confirm({title:"\u5220\u9664\u6570\u636E",getContainer:r.current,icon:(0,e.jsx)(le.Z,{}),content:(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"delete-content",children:["\u786E\u5B9A\u8981\u5220\u9664\u8FD9 ",(0,e.jsx)("span",{children:i==null?void 0:i.length}),"\u6761\u6570\u636E\u5417\uFF1F"]}),(0,e.jsx)("div",{className:"delete-description",children:"\u63D0\u793A\uFF1A\u5220\u9664\u7684\u6570\u636E\u53EF\u4EE5\u5728\u56DE\u6536\u7AD9\u91CC\u9762\u627E\u56DE"})]}),okText:"\u5220\u9664",okType:"danger",cancelText:"\u53D6\u6D88",onOk:function(){t.deleteData()},onCancel:function(){}})};return(0,e.jsx)("div",{className:"toolbar-item",ref:r,children:(0,e.jsxs)("a",{onClick:s,children:[(0,e.jsx)(ie(),{size:18,style:{cursor:"pointer"}}),"\u5220\u9664\u6570\u636E"]})})}),rn=n(59250),H=n(13013),sn=n(30887),R=n(54689),ue=n(72147),ce=n.n(ue);function de(a,t){var i=a,r=new Blob(["\uFEFF"+i],{type:"application/csv;charset=utf-8;"});if(window.navigator.msSaveBlob)navigator.msSaveBlob(r,t);else{var s=document.createElement("a"),o=URL.createObjectURL(r);s.href=o,s.setAttribute("style","visibility:hidden"),s.download=t,document.body.appendChild(s),s.click(),document.body.removeChild(s)}}var ve=(0,C.Pi)(function(){var a=(0,l.useContext)(h.xi),t=a.dataStore,i=(0,A.IE)();return(0,e.jsx)("div",{className:"toolbar-item",children:(0,e.jsx)("a",{title:"Download result",children:(0,e.jsx)(H.Z,{placement:"bottomLeft",trigger:["click"],overlay:(0,e.jsxs)(R.Z,{style:{minWidth:80,padding:0},children:[(0,e.jsx)(R.Z.Item,{disabled:!0,onClick:function(){var s=(0,h.ZZ)(i.schema),o=[];o.push(s.map(function(c){return c.title})),(0,h.IR)(t.records,s).map(function(c){var d=[];s.forEach(function(f){var x=c[f.name]||"";f.type==="image"?d.push("\u9644\u4EF6"):d.push('"'.concat(x.replaceAll('"','""'),'"'))}),o.push(d)});var y=o.map(function(c){return c.join(",")}).join(`
`);de(y,"".concat(i.name,".csv"))},children:"CSV \u6587\u4EF6"},"csv"),(0,e.jsx)(R.Z.Item,{onClick:function(){t.downloadSurvey()},children:"Excel \u6587\u4EF6"},"excel")]}),children:(0,e.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,e.jsx)(ce(),{size:18,style:{cursor:"pointer"}}),"\u5BFC\u51FA"]})})})})}),fe=n(14098),xe=n.n(fe),ln=n(57338),he=n(25084),on=n(62350),me=n(75443),un=n(13062),S=n(71230),cn=n(89032),v=n(15746),je=n(1870),Ce=n(58491),ye=n(57254),Q=n(24843),ge=n(27400),De=(0,C.Pi)(function(){var a=(0,l.useContext)(h.xi),t=a.dataStore,i=(0,A.IE)(),r=i.schema,s=(0,ge.a)(),o=s.isMobile,y=(0,l.useRef)(null),c=(0,l.useRef)(null),d=(0,Q.A)("-edit"),f=t.currentIndex,x=t.records.length||0,u=t.records[f],m=u.metaInfo,I=(0,l.useState)(!0),D=(0,Z.Z)(I,2),g=D[0],p=D[1],P=(0,l.useState)(!1),N=(0,Z.Z)(P,2),Xe=N[0],L=N[1],ke=(0,l.useState)(!1),G=(0,Z.Z)(ke,2),we=G[0],K=G[1];(0,l.useEffect)(function(){var j,F=u.answer,B=u.attachment;(j=c.current)===null||j===void 0||j.setValues(F,B)},[u]),(0,l.useEffect)(function(){var j;(j=c.current)===null||j===void 0||j.toggleReadOnly(g)},[g]);var qe=function(){t.currentIndex=-1},_e=function(){return r?(0,e.jsx)($.O,{ref:c,schema:r,headerVisible:!1,footerVisible:!1,paginationVisible:!1,readOnly:g,onUpload:t.upload}):(0,e.jsx)(e.Fragment,{})},Y=function(F){F==="up"?t.currentIndex=t.currentIndex-1:t.currentIndex=t.currentIndex+1},J=function(){return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(S.Z,{children:[(0,e.jsx)(v.Z,{span:8,children:"\u5E8F\u53F7:"}),(0,e.jsx)(v.Z,{span:16,children:f+1})]}),(0,e.jsxs)(S.Z,{children:[(0,e.jsx)(v.Z,{span:8,children:"\u63D0\u4EA4\u4EBA:"}),(0,e.jsx)(v.Z,{span:16,children:"\u65E0"})]}),(0,e.jsxs)(S.Z,{children:[(0,e.jsx)(v.Z,{span:8,children:"\u7B54\u5377\u65F6\u957F:"}),(0,e.jsx)(v.Z,{span:16,children:(0,h.gh)(m.answerInfo.endTime-m.answerInfo.startTime)})]}),(0,e.jsxs)(S.Z,{children:[(0,e.jsx)(v.Z,{span:8,children:"\u63D0\u4EA4\u65F6\u95F4:"}),(0,e.jsx)(v.Z,{span:16,children:u.createAt})]}),(0,e.jsxs)(S.Z,{children:[(0,e.jsx)(v.Z,{span:8,children:"\u4FEE\u6539\u65F6\u95F4:"}),(0,e.jsx)(v.Z,{span:16,children:u.updateAt||"-"})]}),(0,e.jsxs)(S.Z,{children:[(0,e.jsx)(v.Z,{span:8,children:"\u586B\u5199\u8BBE\u5907:"}),(0,e.jsx)(v.Z,{span:16,children:m.clientInfo.deviceType})]}),(0,e.jsxs)(S.Z,{children:[(0,e.jsx)(v.Z,{span:8,children:"\u64CD\u4F5C\u7CFB\u7EDF:"}),(0,e.jsx)(v.Z,{span:16,children:m.clientInfo.platform})]}),(0,e.jsxs)(S.Z,{children:[(0,e.jsx)(v.Z,{span:8,children:"\u6D4F\u89C8\u5668:"}),(0,e.jsx)(v.Z,{span:16,children:m.clientInfo.browser})]}),(0,e.jsxs)(S.Z,{children:[(0,e.jsx)(v.Z,{span:8,children:"IP:"}),(0,e.jsx)(v.Z,{span:16,children:m.clientInfo.remoteIp})]})]})},en=function(){return g?(0,e.jsxs)("div",{children:[(0,e.jsx)(E.Z,{type:"primary",onClick:function(){return p(!1)},children:"\u4FEE\u6539"}),(0,e.jsx)(E.Z,{type:"primary",danger:!0,style:{marginLeft:5},children:(0,e.jsx)(me.Z,{title:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u8FD9\u6761\u6570\u636E\u5417\uFF1F",icon:(0,e.jsx)(je.Z,{style:{color:"red"}}),okText:"\u5220\u9664",cancelText:"\u53D6\u6D88",onConfirm:function(){t.deleteData(f).then(function(){return qe()})},children:(0,e.jsx)("a",{href:"#",children:"\u5220\u9664"})})}),(0,e.jsx)(E.Z,{type:"link",style:{marginLeft:5},onClick:function(){return K(!0)},children:(0,e.jsx)("a",{href:"#",children:"\u8BE6\u60C5"})}),(0,e.jsx)(he.Z,{placement:"right",autoFocus:!1,visible:we,onClose:function(){return K(!1)},children:J()})]}):(0,e.jsxs)("div",{children:[(0,e.jsx)(E.Z,{type:"primary",loading:Xe,onClick:function(){var B;L(!0),(B=c.current)===null||B===void 0||B.submit().then(function(V){V?t.updateData({answer:V.values,attachment:V.attachments,id:u.id}).then(function(){L(!1),p(!0)}):L(!1)})},children:"\u63D0\u4EA4"}),(0,e.jsx)(E.Z,{style:{marginLeft:10},onClick:function(){return p(!0)},children:"\u53D6\u6D88"})]})};return(0,e.jsx)("div",{ref:y,className:"edit-data ".concat(d),children:(0,e.jsx)(z.Z,{visible:f>=0,maskClosable:!1,getContainer:function(){return y.current},title:!1,width:800,onCancel:function(){return t.currentIndex=-1},footer:!1,children:(0,e.jsxs)(S.Z,{gutter:16,children:[(0,e.jsxs)(v.Z,{xs:24,sm:16,className:d+"-survey-container",children:[(0,e.jsx)("div",{className:d+"-survey-container-title",children:"\u6570\u636E\u8BE6\u60C5"}),(0,e.jsx)("div",{className:d+"-survey-container-content",children:_e()}),(0,e.jsxs)("div",{className:d+"-survey-container-footer",children:[en(),(0,e.jsxs)("div",{className:"nav",children:[(0,e.jsxs)("span",{children:[f+1,"/",x]}),(0,e.jsxs)("div",{children:[(0,e.jsx)(E.Z,{type:"text",shape:"circle",icon:(0,e.jsx)(Ce.Z,{}),disabled:f===0,onClick:function(){return Y("up")}}),(0,e.jsx)(E.Z,{type:"text",shape:"circle",icon:(0,e.jsx)(ye.Z,{}),disabled:f===x-1,onClick:function(){return Y("down")}})]})]})]})]}),!o&&(0,e.jsxs)(v.Z,{span:8,className:d+"-metaInfo-container",children:[(0,e.jsx)("div",{className:d+"-metaInfo-container-title",children:"\u57FA\u672C\u4FE1\u606F"}),(0,e.jsx)("div",{className:d+"-metaInfo-container-content",children:J()}),(0,e.jsx)("div",{className:d+"-metaInfo-container-footer"})]})]})})})}),Ee=(0,C.Pi)(function(){var a=(0,l.useContext)(h.xi),t=a.dataStore,i=t.selected;return(0,e.jsxs)("div",{className:"toolbar-item",children:[(0,e.jsxs)("a",{onClick:function(){i&&i.length>0?t.currentIndex=i[0]:U.default.error("\u8BF7\u70B9\u51FB\u8981\u7F16\u8F91\u7684\u884C")},children:[(0,e.jsx)(xe(),{size:14,style:{cursor:"pointer"}}),"\u7F16\u8F91\u6570\u636E"]}),t.currentIndex!==-1&&(0,e.jsx)(De,{})]})}),Se=n(25769),pe=n.n(Se),Ze=(0,C.Pi)(function(){var a=(0,l.useContext)(h.xi),t=a.dataStore;return(0,e.jsx)("div",{className:"toolbar-item",children:(0,e.jsx)("a",{title:"Download result",onClick:function(){t.downloadSurveyAttachment()},children:(0,e.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,e.jsx)(pe(),{size:18,style:{cursor:"pointer"}}),"\u5BFC\u51FA\u9644\u4EF6"]})})})}),dn=n(9715),Fe=n(93766),vn=n(77883),Ie=n(85482),Ne=n(14603),Ae=n.n(Ne),Re=n(83434),Pe=n.n(Re),Be=n(53758),Te=n.n(Be),be=n(41198),ze=n.n(be),Oe=n(34994),Me=n.n(Oe),Le=(0,C.Pi)(function(){var a=(0,l.useContext)(h.xi),t=a.dataStore,i=t.pagination,r=i.total,s=i.current,o=i.pageSize,y=(0,l.useRef)(o),c=Math.ceil(r/o);o<=0&&(c=1);var d=(s-1)*o+1,f=s*o;(f<=0||f>r)&&(f=r);var x=function(m){typeof m=="number"?t.loadData({current:s,pageSize:m,total:r}):m==="\u663E\u793A\u6240\u6709"?t.loadData({current:s,pageSize:-1,total:r}):z.Z.confirm({icon:null,content:(0,e.jsx)(Fe.Z.Item,{label:"\u81EA\u5B9A\u4E49\u9875\u7801",children:(0,e.jsx)(Ie.Z,{style:{width:200},defaultValue:o,onChange:function(D){y.current=D}})}),okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88",onOk:function(){t.loadData({current:s,pageSize:y.current,total:r})}})};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:"toolbar-item",style:{borderLeft:"1px solid #d3cfcf"},children:(0,e.jsx)("a",{className:s===1?"disabled":"",title:"First page",onClick:function(){s>1&&t.loadData({current:1,pageSize:o,total:r})},children:(0,e.jsx)(Ae(),{size:18,style:{cursor:"pointer"}})})}),(0,e.jsx)("div",{className:"toolbar-item",children:(0,e.jsx)("a",{className:s===1?"disabled":"",onClick:function(){s>1&&t.loadData({current:s-1,pageSize:o,total:r})},title:"Previous page",children:(0,e.jsx)(ze(),{size:18,style:{cursor:"pointer"}})})}),(0,e.jsx)("div",{className:"toolbar-item",children:(0,e.jsx)("a",{title:"Page set",children:(0,e.jsx)(H.Z,{trigger:["click"],placement:"topCenter",overlay:(0,e.jsx)(R.Z,{style:{minWidth:80,padding:0},children:[20,50,100,500,1e3,"\u663E\u793A\u6240\u6709","\u81EA\u5B9A\u4E49\u9875\u7801"].map(function(u){return(0,e.jsx)(R.Z.Item,{style:{padding:"0 1em"},onClick:function(){return x(u)},children:u},u)})}),children:(0,e.jsxs)("span",{style:{display:"flex",width:65,justifyContent:"center",alignItems:"center"},children:[r===0?"0 \u884C":"".concat(d,"-").concat(f),(0,e.jsx)(Me(),{size:18,style:{cursor:"pointer"}})]})})})}),r>0&&(0,e.jsx)("div",{className:"toolbar-item",children:(0,e.jsx)("a",{onClick:function(){t.loadData()},title:"Refresh total",children:(0,e.jsxs)("span",{style:{lineHeight:"16px"},children:["of ",r]})})}),(0,e.jsx)("div",{className:"toolbar-item",children:(0,e.jsx)("a",{className:s===c?"disabled":"",onClick:function(){s<c&&t.loadData({current:s+1,pageSize:o,total:r})},title:"Next page",children:(0,e.jsx)(Te(),{size:18,style:{cursor:"pointer"}})})}),(0,e.jsx)("div",{className:"toolbar-item",style:{borderRight:"1px solid #d3cfcf"},children:(0,e.jsx)("a",{className:s===c?"disabled":"",onClick:function(){s<c&&t.loadData({current:o,pageSize:o,total:r})},title:"Last page",children:(0,e.jsx)(Pe(),{size:18,style:{cursor:"pointer"}})})})]})}),Ve=(0,C.Pi)(function(){var a,t=(0,l.useContext)(h.xi),i=t.dataStore,r=((a=i.selected)===null||a===void 0?void 0:a.length)||0;return(0,e.jsx)("div",{className:"toolbar-item",children:(0,e.jsxs)("a",{children:["\u5DF2\u9009\u4E2D ",r," \u6761"]})})}),fn=n(38979),$e=n(59466),Ue=function(){return(0,e.jsx)("div",{className:"toolbar-item tips",children:(0,e.jsxs)($e.Z,{dots:!1,dotPosition:"left",autoplay:!0,children:[(0,e.jsx)("div",{className:"tip",children:"\u{1F609} \u53CC\u51FB\u5355\u5143\u683C\u7F16\u8F91\u95EE\u5377"}),(0,e.jsx)("div",{className:"tip",children:"\u{1F920} \u53F3\u952E\u5355\u5143\u683C\u4E5F\u6709\u5F88\u591A\u529F\u80FD"}),(0,e.jsx)("div",{className:"tip",children:"\u{1F60B} \u53F3\u952E\u5355\u5143\u683C\u53EF\u4EE5\u51BB\u7ED3\u7A97\u683C"}),(0,e.jsx)("div",{className:"tip",children:"\u{1F917} \u652F\u6301\u81EA\u5B9A\u4E49\u5206\u9875"}),(0,e.jsx)("div",{className:"tip",children:"\u{1F913} \u53F3\u952E\u5355\u5143\u683C\u53EF\u4EE5\u8FC7\u6EE4\u884C"})]})})},He=n(77613);function M(a){return Math.round(a*100)/100}function Qe(a){if(a<1024)return"".concat(M(a),"b");if(a<=1024*1024)return"".concat(M(a/1024),"Kb");if(a<=1024*1024*1024)return"".concat(M(a/1024/1024),"Mb")}var We=(0,He.P)(function(){var a=(0,Q.a)(),t=a.progress;return typeof t!="number"?(0,e.jsx)(e.Fragment,{}):(0,e.jsx)("div",{className:"toolbar-item progress-bar",children:(0,e.jsx)("div",{"aria-valuemin":0,className:"bp3-progress-bar bp3-intent-primary",role:"progressbar",children:(0,e.jsx)("div",{className:"bp3-progress-meter",children:Qe(t)})})})}),Ge=function(){return(0,e.jsxs)("div",{className:"toolbar-container",children:[(0,e.jsx)(re,{}),(0,e.jsx)(ne,{}),(0,e.jsx)(Ee,{}),(0,e.jsx)(oe,{}),(0,e.jsx)(ve,{}),(0,e.jsx)(Ze,{})]})},Ke=function(){return(0,e.jsxs)("div",{className:"statusBar-container",children:[(0,e.jsx)("div",{children:(0,e.jsx)(Ve,{})}),(0,e.jsx)("div",{children:(0,e.jsx)(Le,{})}),(0,e.jsxs)("div",{className:"right-content",children:[(0,e.jsx)(We,{}),(0,e.jsx)(Ue,{})]})]})},Ye=n(72706),W=function(){var t=(0,A.IE)(),i=(0,l.useMemo)(function(){return new Ye.Cu(t)},[t]);return(0,e.jsx)(h.fQ,{value:{dataStore:i,prefixCls:"survey-data"},children:(0,e.jsxs)("div",{className:"survey-data",children:[(0,e.jsx)(Ge,{}),(0,e.jsx)(w,{}),(0,e.jsx)(Ke,{})]})})},Je=W},11628:function(X,T,n){"use strict";n.d(T,{xI:function(){return b},Ge:function(){return O},IE:function(){return Z}});var l=n(67294),b=(0,l.createContext)({}),h=b.Provider;function Z(){var C=(0,l.useContext)(b);return C.store}function O(){var C=Z();return C.flowStore}}}]);
