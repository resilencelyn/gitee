(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[6420],{81319:function(vt,q,n){"use strict";n.r(q),n.d(q,{Overview:function(){return xe},default:function(){return it}});var _=n(93224),F=n(11849),E=n(2824),s=n(67294),Ce=n(51615),Se=n(69968),ee=n(8935),Ie=[{key:"taskCenter",i:"taskCenter",tabs:[{key:"1",title:"\u5F85\u529E\u4E8B\u9879"},{key:"2",title:"\u5DF2\u529E\u4E8B\u9879"},{key:"3",title:"\u6284\u9001\u4E8B\u9879"},{key:"4",title:"\u6211\u53D1\u8D77\u7684"},{key:"5",title:"\u5168\u90E8\u6570\u636E"}],name:"taskCenter","data-grid":{x:0,y:0,w:12,h:2,i:"taskCenter"},widgetProps:{}},{key:"quickSetting",i:"quickSetting",name:"quickSetting",title:"\u7CFB\u7EDF\u8BBE\u7F6E","data-grid":{x:0,y:2,w:6,h:1,i:"quickSetting"}}],Ze=n(91512),ke=n(68654),Ne=n(54549),te=n(11628),P=n(68489),Q=n(2299),Fe=n(69610),Te=n(27361),Ee=n.n(Te),e=n(85893),Ae=function r(){var t=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(0,Fe.Z)(this,r),this._registry=void 0,this.registerComponent=function(o,l){t._registry[o]=l},this.getComponent=function(o){return Ee()(t._registry,"".concat(o),function(l){return(0,e.jsxs)("div",{children:[o,"\u5BF9\u5E94\u7EC4\u4EF6\u672A\u6CE8\u518C"]})})},this._registry=a},pe=new Ae,V=pe,ft=s.createContext({}),Y=n(21063),ne=n(18111),ht=n(71194),ae=n(50146),mt=n(49111),se=n(19650),gt=n(59250),De=n(13013),xt=n(57663),O=n(71577),jt=n(30887),ie=n(54689),yt=n(34792),w=n(48086),Ct=n(18106),re=n(67164),G=n(11075),le=n(15873),J=n(73218),ce=n(64072),Re=n(44545),Pe=n(58491),Oe=n(57254),we=n(98244),Be=n(7354),St=n(87593),oe=n(37636),It=n(22385),ze=n(31097),Zt=n(94233),X=n(51890),Ue=n(94184),ue=n.n(Ue),be=n(89366),Me={save:"blue",agree:"green",refuse:"red",reject:"red",revoke:"red",transfer:"red",todo:"orange"},b=function(t){return(0,e.jsx)(ze.Z,{placement:"bottom",title:(0,e.jsxs)("div",{style:{textAlign:"center",fontSize:12},children:[t.name,(0,e.jsx)("br",{}),t.email]}),children:t.avatar?(0,e.jsx)(X.C,{src:"/api/public/preview/".concat(t.avatar),size:22}):(0,e.jsx)(X.C,{icon:(0,e.jsx)(be.Z,{}),size:22})})},We=function(t){var a=function(){if(t.approvalType==="save"){var l;return(0,e.jsxs)(e.Fragment,{children:[t.auditUser&&(0,e.jsx)(b,(0,F.Z)({},t.auditUser)),(l=t.auditUser)===null||l===void 0?void 0:l.name," \u53D1\u8D77\u65B0\u7684"]})}else if(t.approvalType==="agree"){var c;return(0,e.jsxs)(e.Fragment,{children:[t.auditUser&&(0,e.jsx)(b,(0,F.Z)({},t.auditUser)),(c=t.auditUser)===null||c===void 0?void 0:c.name," \u5BA1\u6279\u901A\u8FC7"]})}else if(t.approvalType==="todo"){var u,i;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(X.C.Group,{maxCount:3,children:(u=t.waitAuditUserList)===null||u===void 0?void 0:u.filter(function(S){return!!S}).map(function(S){return(0,s.createElement)(b,(0,F.Z)((0,F.Z)({},S),{},{key:S.userId}))})}),(i=t.waitAuditUserList)===null||i===void 0?void 0:i.length,"\u6210\u5458\u5904\u7406\u4E2D..."]})}else if(t.approvalType==="refuse"){var C;return(0,e.jsxs)(e.Fragment,{children:[t.auditUser&&(0,e.jsx)(b,(0,F.Z)({},t.auditUser)),(C=t.auditUser)===null||C===void 0?void 0:C.name," \u5BA1\u6279\u62D2\u7EDD"]})}else if(t.approvalType==="rollback"){var x;return(0,e.jsxs)(e.Fragment,{children:[t.auditUser&&(0,e.jsx)(b,(0,F.Z)({},t.auditUser)),(x=t.auditUser)===null||x===void 0?void 0:x.name," \u56DE\u9000\u81F3 ",t.newActivityName]})}else if(t.approvalType==="revert"){var d;return(0,e.jsxs)(e.Fragment,{children:[t.auditUser&&(0,e.jsx)(b,(0,F.Z)({},t.auditUser)),(d=t.auditUser)===null||d===void 0?void 0:d.name," \u64A4\u9500\u5904\u7406"]})}};return(0,e.jsxs)(oe.Z.Item,{color:Me[t.approvalType]||"gray",children:[(0,e.jsx)("div",{className:"audit-time",children:t.createAt}),(0,e.jsxs)("div",{className:"record-item",children:[(0,e.jsx)("div",{className:"item-header",children:t.activityName}),(0,e.jsxs)("div",{className:"item-content",children:[(0,e.jsxs)("div",{className:"content-row",children:[(0,e.jsx)("span",{className:ue()("action",t.approvalType),children:a()}),(0,e.jsx)("span",{})]}),t.comment&&(0,e.jsx)("div",{className:"content-row",children:(0,e.jsx)("span",{className:"comment",children:t.comment})})]})]})]},t.id)},He=function(t){var a=t.processInstanceId,o=(0,s.useState)(),l=(0,E.Z)(o,2),c=l[0],u=l[1];return(0,s.useEffect)(function(){P.hi.getAuditRecord(a).then(function(i){u(i)})},[a]),(0,s.useEffect)(function(){var i=document.getElementsByClassName("ant-tabs-content-holder");i.length>0&&(i[0].scrollTop=i[0].scrollHeight)},[c]),(0,e.jsx)(oe.Z,{className:"audit-timeline",children:c==null?void 0:c.map(function(i){return(0,s.createElement)(We,(0,F.Z)((0,F.Z)({},i),{},{key:i.id||i.activityId}))})})},kt=n(47673),de=n(4107),Le=de.Z.TextArea;function Ke(r){var t=(0,s.useState)(),a=(0,E.Z)(t,2),o=a[0],l=a[1];return(0,e.jsxs)(ae.Z,{visible:!0,title:"\u786E\u8BA4",onOk:function(){return r.onOk(o)},onCancel:r.onCancel,okButtonProps:r.buttonProps,children:[(0,e.jsx)("div",{style:{fontWeight:"bold",marginBottom:10},children:"\u5904\u7406\u53CD\u9988"}),(0,e.jsx)(Le,{placeholder:"\u5728\u6B64\u5904\u8F93\u5165\u5904\u7406\u53CD\u9988\uFF0C\u53EF\u4E0D\u586B\u76F4\u63A5\u63D0\u4EA4",value:o,onChange:function(u){return l(u.target.value)}})]})}var ve=re.Z.TabPane,U="task-edit-modal",Qe=(0,Q.Pi)(function(r){var t=r.currentRecord,a=r.currIndex,o=r.total,l=r.onClose,c=r.onNav,u=r.taskType,i=(0,s.useState)(345),C=(0,E.Z)(i,2),x=C[0],d=C[1],S=(0,s.useRef)(null),k=(0,s.useState)(),m=(0,E.Z)(k,2),j=m[0],R=m[1],v=(0,s.useRef)(null),h=(0,s.useState)([]),I=(0,E.Z)(h,2),B=I[0],M=I[1],g=(0,s.useState)(),N=(0,E.Z)(g,2),y=N[0],A=N[1];(0,s.useEffect)(function(){P.hi.loadFlowSchema({activityId:t.activityId,projectId:t.projectId}).then(function(T){return R(T)})},[t]);var rt=(0,s.useState)(!1),je=(0,E.Z)(rt,2),W=je[0],p=je[1];(0,s.useEffect)(function(){var T,D=t.answer,f=t.attachment;(T=v.current)===null||T===void 0||T.setValues(D,f)},[t]);var lt=function(){return j?(0,e.jsx)(Be.O,{ref:v,schema:j,headerVisible:!1,footerVisible:!1,paginationVisible:!1,initialValues:t.answer,fieldPermission:t.fieldPermission}):(0,e.jsx)(e.Fragment,{})},ye=function(D){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;c(D==="up"?a-1:a+1,f)},ct=function(){return(0,e.jsx)("div",{style:{position:"absolute",height:"100%",width:"100%",overflow:"hidden"},children:(0,e.jsxs)(re.Z,{defaultActiveKey:"1",children:[(0,e.jsx)(ve,{tab:"\u65E5\u5FD7",children:(0,e.jsx)(He,{processInstanceId:t.processInstanceId})},"1"),(0,e.jsx)(ve,{tab:"\u7559\u8A00",children:"Content of Tab Pane 2"},"2")]})})},ot=function(){return(0,e.jsx)(ie.Z,{onClick:function(f){var Z,H=f.key;(Z=v.current)===null||Z===void 0||Z.submit().then(function(z){z?A({visible:!0,buttonProps:{type:"ghost",icon:(0,e.jsx)(G.Z,{})},callback:function(dt){p(!0),P.hi.approvalTask({answer:z.values,attachment:z.attachments,answerId:t.answerId,taskId:t.id,type:"rollback",activityId:t.activityId,comment:dt,projectId:t.projectId,processInstanceId:t.processInstanceId,newActivityId:H}).then(function(){w.default.success("\u5DF2\u56DE\u9000"),p(!1),A(void 0),c(a,!0)})}}):p(!1)})},children:B==null?void 0:B.map(function(D,f){return(0,e.jsx)(ie.Z.Item,{children:(0,e.jsx)("a",{children:f!==B.length-1?D.activityName:"\u53D1\u8D77\u4EBA"})},D.activityId)})})},ut=function(){return(0,e.jsxs)(se.Z,{children:[u===1&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(O.Z,{type:"primary",loading:W,icon:(0,e.jsx)(le.Z,{}),onClick:function(){var f;(f=v.current)===null||f===void 0||f.submit().then(function(Z){Z?A({visible:!0,buttonProps:{type:"primary",icon:(0,e.jsx)(le.Z,{})},callback:function(z){p(!0),P.hi.approvalTask({answer:Z.values,attachment:Z.attachments,answerId:t.answerId,taskId:t.id,type:"agree",activityId:t.activityId,comment:z,projectId:t.projectId,processInstanceId:t.processInstanceId}).then(function(){w.default.success("\u5BA1\u6838\u901A\u8FC7"),p(!1),A(void 0),c(a,!0)})}}):p(!1)})},children:"\u901A\u8FC7"}),(0,e.jsx)(O.Z,{type:"primary",danger:!0,icon:(0,e.jsx)(J.Z,{}),loading:W,onClick:function(){var f;(f=v.current)===null||f===void 0||f.submit().then(function(Z){Z?A({visible:!0,buttonProps:{type:"primary",danger:!0,icon:(0,e.jsx)(J.Z,{})},callback:function(z){p(!0),P.hi.approvalTask({answer:Z.values,attachment:Z.attachments,answerId:t.answerId,taskId:t.id,type:"refuse",activityId:t.activityId,comment:z,projectId:t.projectId,processInstanceId:t.processInstanceId}).then(function(){w.default.success("\u5DF2\u62D2\u7EDD"),p(!1),A(void 0),c(a,!0)})}}):p(!1)})},children:"\u62D2\u7EDD"}),(0,e.jsx)(De.Z,{overlay:ot,placement:"topCenter",trigger:["click"],children:(0,e.jsx)(O.Z,{onClick:function(){P.hi.getRevertNodes(t.processInstanceId).then(function(f){f&&M(f)})},icon:(0,e.jsx)(G.Z,{}),loading:W,children:"\u56DE\u9000"})})]}),u===2&&t.status===1&&t.latest&&t.approvalType!=="revert"&&(0,e.jsx)(O.Z,{onClick:function(){var f;(f=v.current)===null||f===void 0||f.submit().then(function(Z){Z?A({visible:!0,buttonProps:{type:"primary",danger:!0,icon:(0,e.jsx)(J.Z,{})},callback:function(z){p(!0),P.hi.approvalTask({answer:Z.values,attachment:Z.attachments,answerId:t.answerId,taskId:t.id,type:"revert",activityId:t.activityId,newActivityId:t.activityId,comment:z,projectId:t.projectId,processInstanceId:t.processInstanceId}).then(function(){w.default.success("\u5DF2\u64A4\u56DE"),p(!1),A(void 0),c(a,!0)})}}):p(!1)})},icon:(0,e.jsx)(G.Z,{}),loading:W,children:"\u64A4\u56DE"}),u===4&&t.status===6&&(0,e.jsx)(O.Z,{onClick:function(){var f;(f=v.current)===null||f===void 0||f.submit().then(function(Z){Z?A({visible:!0,buttonProps:{type:"primary",icon:(0,e.jsx)(ce.Z,{})},callback:function(z){p(!0),P.hi.approvalTask({answer:Z.values,attachment:Z.attachments,answerId:t.answerId,taskId:t.id,type:"save",activityId:t.activityId,comment:z,projectId:t.projectId,processInstanceId:t.processInstanceId}).then(function(){w.default.success("\u5DF2\u64A4\u56DE"),p(!1),A(void 0),c(a,!0)})}}):p(!1)})},icon:(0,e.jsx)(ce.Z,{}),loading:W,children:"\u518D\u6B21\u63D0\u4EA4"}),(0,e.jsx)(O.Z,{onClick:function(){},icon:(0,e.jsx)(Re.Z,{}),loading:W})]})};return(0,e.jsx)("div",{ref:S,className:"edit-data ",children:(0,e.jsxs)(ae.Z,{visible:!0,maskClosable:!1,title:!1,width:900,onCancel:function(){return l()},className:"task-edit-modal",footer:!1,children:[(0,e.jsxs)("div",{style:{display:"flex"},children:[(0,e.jsxs)("div",{className:U+"-survey-container",style:{flex:1},children:[(0,e.jsx)("div",{className:U+"-survey-container-title",children:"\u6211\u7684\u5BA1\u6279"}),(0,e.jsx)("div",{className:U+"-survey-container-content",children:lt()}),(0,e.jsxs)("div",{className:U+"-survey-container-footer",children:[(0,e.jsxs)("div",{className:"nav",children:[(0,e.jsxs)("span",{children:[a+1,"/",o]}),(0,e.jsxs)("div",{children:[(0,e.jsx)(O.Z,{type:"text",shape:"circle",icon:(0,e.jsx)(Pe.Z,{}),disabled:a===0,onClick:function(){return ye("up")}}),(0,e.jsx)(O.Z,{type:"text",shape:"circle",icon:(0,e.jsx)(Oe.Z,{}),disabled:a===o-1,onClick:function(){return ye("down")}})]})]}),ut()]})]}),(0,e.jsxs)("div",{className:U+"-metaInfo-container",style:{width:x},children:[(0,e.jsx)("div",{className:U+"-metaInfo-container-title"}),(0,e.jsx)("div",{className:U+"-metaInfo-container-content",children:ct()}),(0,e.jsx)("div",{className:U+"-metaInfo-container-resizer",style:{transform:x===0?"rotateY(180deg) translate3d(100%,-50%,0)":"translate3d(0,-50%,0)"},onClick:function(){d(x===0?350:0)},children:(0,e.jsx)(we.Z,{})})]})]}),(y==null?void 0:y.visible)&&(0,e.jsx)(Ke,{onOk:function(D){return y.callback(D)},onCancel:function(){return A(void 0)},buttonProps:y.buttonProps})]})})}),Ve=(0,Q.Pi)(function(r){var t=r.projectId,a=r.taskType,o=(0,s.useContext)($),l=(0,P.iZ)(t),c=(0,P.Ge)(t),u=(0,s.useRef)(),i=c.tasks[a]||{list:[],total:0,current:1,pageSize:50},C=(0,s.useState)(),x=(0,E.Z)(C,2),d=x[0],S=x[1],k=(0,s.useState)(),m=(0,E.Z)(k,2),j=m[0],R=m[1];(0,s.useEffect)(function(){var g=i.list.length;if(d===void 0){R(void 0);return}if(g===0){S(void 0);return}if(d>=g){S(0);return}d!==void 0&&i.current&&i.total&&R({currIndex:d,total:i.total,currentRecord:i.list[d]})},[d,i]);var v=function(N,y){c.loadFlowTasks({type:a,projectId:t,current:N,pageSize:y})};(0,s.useEffect)(function(){(a||d===void 0)&&v()},[a,d]);var h=l.schema,I=(0,s.useMemo)(function(){var g=(0,ne.ZZ)(h)||[];return g.splice(0,0,{name:"approvalStage",title:"\u5F53\u524D\u6D41\u7A0B\u72B6\u6001",width:180}),g.push({name:"createUser",title:"\u7533\u8BF7\u4EBA"}),g.push({name:"createAt",title:"\u7533\u8BF7\u65F6\u95F4",width:180}),g.push({name:"updateAt",title:"\u66F4\u65B0\u65F6\u95F4",width:180}),g},[h]),B=(0,s.useMemo)(function(){var g=(0,ne.IR)(i.list,I);return g.forEach(function(N){var y;N.createUser=(y=N.createUser)===null||y===void 0?void 0:y.name}),g},[i,I]),M=function(N,y){j&&(y?c.removeTask(j.currentRecord.id,a):S(N))};return(0,e.jsxs)("div",{children:[(0,e.jsx)(Y._$,{ref:u,width:o.width-10,height:o.height-95,data:B,schema:I,selectionMode:"row",allowSorting:!0,onDoubleClick:function(N){var y;if(((y=N.data)===null||y===void 0?void 0:y._i)!==void 0){var A;S((A=N.data)===null||A===void 0?void 0:A._i)}}}),(0,e.jsxs)("div",{className:"statusBar-container",children:[(0,e.jsx)("div",{children:(0,e.jsx)("div",{style:{fontSize:12,color:"##767e89",userSelect:"none"},children:"\u53CC\u51FB\u884C\u5BA1\u6279"})}),(0,e.jsxs)("div",{children:[(0,e.jsx)(Y.tl,{current:i.current,pageSize:i.pageSize,total:i.total,onChange:function(N){v(N.current,N.pageSize)}}),(0,e.jsx)(Y.hY,{onClick:function(){return v(i.current,i.pageSize)}})]}),(0,e.jsx)("div",{})]}),j&&(0,e.jsx)(Qe,(0,F.Z)((0,F.Z)({},j),{},{taskType:a,onClose:function(){S(void 0)},onNav:M}))]})}),Ye=(0,Q.Pi)(function(r){var t=(0,s.useContext)(te.xI),a=(t==null?void 0:t.id)||r.projectId,o=(0,P.iZ)(a),l=tt();return(0,s.useEffect)(function(){o.loadProject()},[o,a]),(0,e.jsx)("div",{style:{padding:"2px 5px"},className:"task-widget",children:(0,e.jsx)(Ve,{projectId:a,taskType:parseInt(l.activeKey||"0")})})});V.registerComponent("taskCenter",Ye);var Nt=n(13062),fe=n(71230),Ft=n(77576),he=n(12028),Tt=n(89032),L=n(15746),Et=n(20136),Ge=n(55241),me=n(3182),Je=n(94043),K=n.n(Je),Xe=n(23538),ge=n(92592),$e=de.Z.Search;function qe(r){return"".concat(window.location.origin,"/s/").concat(r)}var _e=function(){var t,a,o,l=(0,te.IE)(),c=l.loading,u=qe(l.id),i=(0,s.useState)(""),C=(0,E.Z)(i,2),x=C[0],d=C[1];(0,s.useEffect)(function(){function k(){return m.apply(this,arguments)}function m(){return m=(0,me.Z)(K().mark(function j(){return K().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:ge.toDataURL(u,{errorCorrectionLevel:"H",type:"image/jpeg",quality:.3,margin:1,color:{dark:"#010599FF",light:"#FFBF60FF"}}).then(function(h){d(h)}).catch(function(h){console.error(h)});case 1:case"end":return v.stop()}},j)})),m.apply(this,arguments)}k()},[u]);var S=(0,s.useCallback)(function(){var k=(0,me.Z)(K().mark(function m(j){return K().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:ge.toDataURL(u,{errorCorrectionLevel:"H",margin:1,color:{dark:"#010599FF",light:"#FFBF60FF"},width:j}).then(function(h){d(h);var I=document.createElement("a");I.href=h,I.setAttribute("download","".concat(l.name,"_").concat(j,".png")),document.body.appendChild(I),I.click(),document.body.removeChild(I)});case 1:case"end":return v.stop()}},m)}));return function(m){return k.apply(this,arguments)}}(),[u,l]);return(0,e.jsx)(fe.Z,{gutter:[20,20],style:{padding:10},children:(0,e.jsx)(L.Z,{sm:24,xs:24,children:(0,e.jsxs)(fe.Z,{gutter:[10,10],children:[(0,e.jsxs)(L.Z,{span:24,className:"setting-item",children:[(0,e.jsx)($e,{value:u,style:{width:360},enterButton:"\u6253\u5F00",className:"open-target",onSearch:function(){window.open("/s/".concat(l.id))}}),(0,e.jsx)(Ge.Z,{content:(0,e.jsxs)("div",{children:[(0,e.jsx)("img",{src:x,height:150,width:150}),(0,e.jsx)("div",{style:{textAlign:"center"},children:(0,e.jsxs)(se.Z,{children:[(0,e.jsx)(O.Z,{size:"small",type:"link",onClick:function(){return S(256)},children:"\u5C0F\u53F7"}),(0,e.jsx)(O.Z,{size:"small",type:"link",onClick:function(){return S(512)},children:"\u4E2D\u53F7"}),(0,e.jsx)(O.Z,{size:"small",type:"link",onClick:function(){return S(1024)},children:"\u5927\u53F7"})]})})]}),title:"".concat(l.name,"(\u4E8C\u7EF4\u7801)"),trigger:["click"],children:(0,e.jsx)(Xe.Z,{style:{fontSize:30}})})]}),(0,e.jsxs)(L.Z,{className:"setting-item",span:24,children:[(0,e.jsx)("div",{className:"title",children:"\u95EE\u5377\u5F00\u542F/\u505C\u6B62"}),(0,e.jsx)("div",{children:(0,e.jsx)(he.Z,{defaultChecked:((t=l.project)===null||t===void 0?void 0:t.status)===1,onChange:function(m){l.saveOrUpdateProject({status:m?1:0}).then(function(j){j.code===200?m?w.default.info("\u95EE\u5377\u5DF2\u5F00\u542F"):w.default.warn("\u95EE\u5377\u5DF2\u505C\u6B62"):w.default.error(j.message)})}})})]}),(0,e.jsxs)(L.Z,{className:"setting-item",span:24,children:[(0,e.jsx)("div",{className:"title",children:"\u95EE\u5377\u586B\u5199\u65F6\u81EA\u52A8\u4FDD\u5B58"}),(0,e.jsx)("div",{children:(0,e.jsx)(he.Z,{defaultChecked:(a=l.project)===null||a===void 0||(o=a.setting)===null||o===void 0?void 0:o.answerSetting.autoSave,onChange:function(m){l.updateSetting({answerSetting:{autoSave:m}}).then(function(j){j.code===200?m?w.default.info("\u6682\u5B58\u5DF2\u5F00\u542F"):w.default.warn("\u6682\u5B58\u5DF2\u505C\u6B62"):w.default.error(j.message)})}})})]})]})})})};V.registerComponent("quickSetting",_e);var et=function(t){var a=t.tabs,o=t.defaultActive,l=(0,s.useState)(o||a[0].key),c=(0,E.Z)(l,2),u=c[0],i=c[1],C=function(d){i(d),t.onChange(d)};return(0,e.jsx)("div",{className:"tabs-nav-list",children:a.map(function(x){return(0,e.jsx)("div",{onClick:function(){return C(x.key)},className:ue()("tabs-tab",{active:u===x.key}),children:x.title},x.key)})})},$=s.createContext({});function tt(){return(0,s.useContext)($)}var nt=s.forwardRef(function(r,t){var a=r.style,o=r.className,l=r.key,c=r.children,u=r.name,i=r.title,C=r.tabs,x=r.widgetProps,d=r.toggleFullScreen,S=(0,_.Z)(r,["style","className","key","children","name","title","tabs","widgetProps","toggleFullScreen"]),k=(0,s.useState)(C&&C[0].key),m=(0,E.Z)(k,2),j=m[0],R=m[1],v=(0,s.useState)(!1),h=(0,E.Z)(v,2),I=h[0],B=h[1],M=function(){return C?(0,e.jsx)(et,{tabs:C,onChange:function(y){return R(y)}}):(0,e.jsx)("span",{className:"",children:i})};return(0,e.jsxs)("div",(0,F.Z)((0,F.Z)({style:(0,F.Z)({},a),className:["widget",o].join(" ")},S),{},{ref:t,children:[(0,e.jsxs)("div",{className:"header",children:[(0,e.jsxs)("span",{className:"title",children:[M(),(0,e.jsx)("div",{className:"drag-handle"})]}),(0,e.jsxs)("div",{className:"widget-controls",children:[I&&(0,e.jsx)(Ze.Z,{className:"control-item",onClick:function(){B(!1),d()}}),!I&&(0,e.jsx)(ke.Z,{className:"control-item",onClick:function(){B(!0),d()}}),(0,e.jsx)(Ne.Z,{className:"control-item"})]})]}),(0,e.jsx)(ee.SizeMe,{monitorHeight:!0,children:function(N){var y=N.size;return(0,e.jsx)($.Provider,{value:{height:y.height||0,width:y.width||0,activeKey:j},children:(0,e.jsx)("div",{style:{height:"100%"},children:s.createElement(V.getComponent(u),x)})})}}),c]}),l)}),at=nt,st=n(34925),xe=function(t){var a=(0,Ce.UO)(),o=a.id,l=(0,s.useState)(Ie),c=(0,E.Z)(l,2),u=c[0],i=c[1],C=(0,s.useRef)(0),x=(0,s.useState)(),d=(0,E.Z)(x,2),S=d[0],k=d[1];if(o==="new")return(0,e.jsx)(st.default,(0,F.Z)({},t));var m=function(R){if(S)i(S.cacheData),k(void 0);else{var v=JSON.parse(JSON.stringify(u.find(function(h){return h.key===R})));k({key:R,cacheData:u}),v["data-grid"]={x:0,y:0,w:12,h:(C.current-100)/150,i:R,static:!0},i([v])}};return(0,e.jsx)("div",{className:"survey-overview",children:(0,e.jsx)(ee.SizeMe,{monitorHeight:!0,children:function(R){var v=R.size;return C.current=v.height||0,(0,e.jsx)(Se.Responsive,{autoSize:!1,className:"layout",onDrag:function(I){},draggableHandle:".drag-handle",breakpoints:{lg:1200,md:996,sm:768,xs:480,xxs:0},cols:{lg:12,md:12,sm:12,xs:4,xxs:2},width:v.width||0,layouts:{lg:u.map(function(h){return h["data-grid"]}),md:u.map(function(h){return h["data-grid"]})},useCSSTransforms:!1,onLayoutChange:function(I){console.log(I)},children:u.map(function(h){var I=h.key,B=(0,_.Z)(h,["key"]);return(0,e.jsx)(at,(0,F.Z)((0,F.Z)({},B),{},{toggleFullScreen:function(){return m(I)}}),I)})})}})})},it=xe}}]);
