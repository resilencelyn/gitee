(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[6420],{81319:function(vt,q,n){"use strict";n.r(q),n.d(q,{Overview:function(){return xe},default:function(){return it}});var _=n(93224),F=n(11849),p=n(2824),r=n(67294),Ce=n(51615),Se=n(69968),ee=n(8935),Ie=[{key:"taskCenter",i:"taskCenter",tabs:[{key:"1",title:"\u5F85\u529E\u4E8B\u9879"},{key:"2",title:"\u5DF2\u529E\u4E8B\u9879"},{key:"3",title:"\u6284\u9001\u4E8B\u9879"},{key:"4",title:"\u6211\u53D1\u8D77\u7684"},{key:"5",title:"\u5168\u90E8\u6570\u636E"}],name:"taskCenter","data-grid":{x:0,y:0,w:12,h:2,i:"taskCenter"},widgetProps:{}},{key:"quickSetting",i:"quickSetting",name:"quickSetting",title:"\u7CFB\u7EDF\u8BBE\u7F6E","data-grid":{x:0,y:2,w:6,h:1,i:"quickSetting"}}],Ze=n(91512),ke=n(68654),Ne=n(54549),te=n(11628),P=n(68489),V=n(2299),Fe=n(69610),Te=n(27361),Ee=n.n(Te),e=n(85893),pe=function l(){var t=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(0,Fe.Z)(this,l),this._registry=void 0,this.registerComponent=function(o,c){t._registry[o]=c},this.getComponent=function(o){return Ee()(t._registry,"".concat(o),function(c){return(0,e.jsxs)("div",{children:[o,"\u5BF9\u5E94\u7EC4\u4EF6\u672A\u6CE8\u518C"]})})},this._registry=a},Ae=new pe,Q=Ae,ft=r.createContext({}),Y=n(21063),ne=n(18111),ht=n(71194),ae=n(50146),mt=n(49111),se=n(19650),gt=n(59250),De=n(13013),xt=n(57663),w=n(71577),jt=n(30887),ie=n(54689),yt=n(34792),B=n(48086),Ct=n(18106),re=n(67164),G=n(11075),le=n(15873),J=n(73218),oe=n(64072),Re=n(44545),Pe=n(58491),Oe=n(57254),we=n(98244),Be=n(7354),St=n(87593),ce=n(37636),It=n(22385),ze=n(31097),Zt=n(94233),$=n(51890),Ue=n(94184),ue=n.n(Ue),be=n(89366),Me={save:"blue",agree:"green",refuse:"red",reject:"red",revoke:"red",transfer:"red",todo:"orange"},b=function(t){return(0,e.jsx)(ze.Z,{placement:"bottom",title:(0,e.jsxs)("div",{style:{textAlign:"center",fontSize:12},children:[t.name,(0,e.jsx)("br",{}),t.email]}),children:t.avatar?(0,e.jsx)($.C,{src:"/api/public/preview/".concat(t.avatar),size:22}):(0,e.jsx)($.C,{icon:(0,e.jsx)(be.Z,{}),size:22})})},We=function(t){var a=function(){if(t.approvalType==="save"){var c;return(0,e.jsxs)(e.Fragment,{children:[t.auditUser&&(0,e.jsx)(b,(0,F.Z)({},t.auditUser)),(c=t.auditUser)===null||c===void 0?void 0:c.name," \u53D1\u8D77\u65B0\u7684"]})}else if(t.approvalType==="agree"){var i;return(0,e.jsxs)(e.Fragment,{children:[t.auditUser&&(0,e.jsx)(b,(0,F.Z)({},t.auditUser)),(i=t.auditUser)===null||i===void 0?void 0:i.name," \u5BA1\u6279\u901A\u8FC7"]})}else if(t.approvalType==="todo"){var f,s;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)($.C.Group,{maxCount:3,children:(f=t.waitAuditUserList)===null||f===void 0?void 0:f.filter(function(I){return!!I}).map(function(I){return(0,r.createElement)(b,(0,F.Z)((0,F.Z)({},I),{},{key:I.userId}))})}),(s=t.waitAuditUserList)===null||s===void 0?void 0:s.length,"\u6210\u5458\u5904\u7406\u4E2D..."]})}else if(t.approvalType==="refuse"){var S;return(0,e.jsxs)(e.Fragment,{children:[t.auditUser&&(0,e.jsx)(b,(0,F.Z)({},t.auditUser)),(S=t.auditUser)===null||S===void 0?void 0:S.name," \u5BA1\u6279\u62D2\u7EDD"]})}else if(t.approvalType==="rollback"){var m;return(0,e.jsxs)(e.Fragment,{children:[t.auditUser&&(0,e.jsx)(b,(0,F.Z)({},t.auditUser)),(m=t.auditUser)===null||m===void 0?void 0:m.name," \u56DE\u9000\u81F3 ",t.newActivityName]})}else if(t.approvalType==="revert"){var u;return(0,e.jsxs)(e.Fragment,{children:[t.auditUser&&(0,e.jsx)(b,(0,F.Z)({},t.auditUser)),(u=t.auditUser)===null||u===void 0?void 0:u.name," \u64A4\u9500\u5904\u7406"]})}};return(0,e.jsxs)(ce.Z.Item,{color:Me[t.approvalType]||"gray",children:[(0,e.jsx)("div",{className:"audit-time",children:t.createAt}),(0,e.jsxs)("div",{className:"record-item",children:[(0,e.jsx)("div",{className:"item-header",children:t.activityName}),(0,e.jsxs)("div",{className:"item-content",children:[(0,e.jsxs)("div",{className:"content-row",children:[(0,e.jsx)("span",{className:ue()("action",t.approvalType),children:a()}),(0,e.jsx)("span",{})]}),t.comment&&(0,e.jsx)("div",{className:"content-row",children:(0,e.jsx)("span",{className:"comment",children:t.comment})})]})]})]},t.id)},He=function(t){var a=t.processInstanceId,o=(0,r.useState)(),c=(0,p.Z)(o,2),i=c[0],f=c[1];return(0,r.useEffect)(function(){P.hi.getAuditRecord(a).then(function(s){f(s)})},[a]),(0,r.useEffect)(function(){var s=document.getElementsByClassName("ant-tabs-content-holder");s.length>0&&(s[0].scrollTop=s[0].scrollHeight)},[i]),(0,e.jsx)(ce.Z,{className:"audit-timeline",children:i==null?void 0:i.map(function(s){return(0,r.createElement)(We,(0,F.Z)((0,F.Z)({},s),{},{key:s.id||s.activityId}))})})},kt=n(47673),de=n(4107),Ke=de.Z.TextArea;function Le(l){var t=(0,r.useState)(),a=(0,p.Z)(t,2),o=a[0],c=a[1];return(0,e.jsxs)(ae.Z,{visible:!0,title:"\u786E\u8BA4",onOk:function(){return l.onOk(o)},onCancel:l.onCancel,okButtonProps:l.buttonProps,children:[(0,e.jsx)("div",{style:{fontWeight:"bold",marginBottom:10},children:"\u5904\u7406\u53CD\u9988"}),(0,e.jsx)(Ke,{placeholder:"\u5728\u6B64\u5904\u8F93\u5165\u5904\u7406\u53CD\u9988\uFF0C\u53EF\u4E0D\u586B\u76F4\u63A5\u63D0\u4EA4",value:o,onChange:function(f){return c(f.target.value)}})]})}var ve=re.Z.TabPane,U="task-edit-modal",Ve=(0,V.Pi)(function(l){var t=l.currentRecord,a=l.currIndex,o=l.total,c=l.onClose,i=l.onNav,f=l.taskType,s=(0,r.useState)(345),S=(0,p.Z)(s,2),m=S[0],u=S[1],I=(0,r.useRef)(null),O=(0,r.useState)(),Z=(0,p.Z)(O,2),h=Z[0],g=Z[1],C=(0,r.useRef)(null),v=(0,r.useState)([]),j=(0,p.Z)(v,2),T=j[0],M=j[1],x=(0,r.useState)(),N=(0,p.Z)(x,2),y=N[0],A=N[1];(0,r.useEffect)(function(){P.hi.loadFlowSchema({activityId:t.activityId,projectId:t.projectId}).then(function(E){return g(E)})},[t]);var rt=(0,r.useState)(!1),je=(0,p.Z)(rt,2),W=je[0],D=je[1];(0,r.useEffect)(function(){var E,R=t.answer,d=t.attachment;(E=C.current)===null||E===void 0||E.setValues(R,d)},[t]);var lt=function(){return h?(0,e.jsx)(Be.O,{ref:C,schema:h,headerVisible:!1,footerVisible:!1,paginationVisible:!1,initialValues:t.answer,fieldPermission:t.fieldPermission}):(0,e.jsx)(e.Fragment,{})},ye=function(R){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;i(R==="up"?a-1:a+1,d)},ot=function(){return(0,e.jsx)("div",{style:{position:"absolute",height:"100%",width:"100%",overflow:"hidden"},children:(0,e.jsxs)(re.Z,{defaultActiveKey:"1",children:[(0,e.jsx)(ve,{tab:"\u65E5\u5FD7",children:(0,e.jsx)(He,{processInstanceId:t.processInstanceId})},"1"),(0,e.jsx)(ve,{tab:"\u7559\u8A00",children:"Content of Tab Pane 2"},"2")]})})},ct=function(){return(0,e.jsx)(ie.Z,{onClick:function(d){var k,H=d.key;(k=C.current)===null||k===void 0||k.submit().then(function(z){z?A({visible:!0,buttonProps:{type:"ghost",icon:(0,e.jsx)(G.Z,{})},callback:function(dt){D(!0),P.hi.approvalTask({answer:z.values,attachment:z.attachments,answerId:t.answerId,taskId:t.id,type:"rollback",activityId:t.activityId,comment:dt,projectId:t.projectId,processInstanceId:t.processInstanceId,newActivityId:H}).then(function(){B.default.success("\u5DF2\u56DE\u9000"),D(!1),A(void 0),i(a,!0)})}}):D(!1)})},children:T==null?void 0:T.map(function(R,d){return(0,e.jsx)(ie.Z.Item,{children:(0,e.jsx)("a",{children:d!==T.length-1?R.activityName:"\u53D1\u8D77\u4EBA"})},R.activityId)})})},ut=function(){return(0,e.jsxs)(se.Z,{children:[f===1&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(w.Z,{type:"primary",loading:W,icon:(0,e.jsx)(le.Z,{}),onClick:function(){var d;(d=C.current)===null||d===void 0||d.submit().then(function(k){k?A({visible:!0,buttonProps:{type:"primary",icon:(0,e.jsx)(le.Z,{})},callback:function(z){D(!0),P.hi.approvalTask({answer:k.values,attachment:k.attachments,answerId:t.answerId,taskId:t.id,type:"agree",activityId:t.activityId,comment:z,projectId:t.projectId,processInstanceId:t.processInstanceId}).then(function(){B.default.success("\u5BA1\u6838\u901A\u8FC7"),D(!1),A(void 0),i(a,!0)})}}):D(!1)})},children:"\u901A\u8FC7"}),(0,e.jsx)(w.Z,{type:"primary",danger:!0,icon:(0,e.jsx)(J.Z,{}),loading:W,onClick:function(){var d;(d=C.current)===null||d===void 0||d.submit().then(function(k){k?A({visible:!0,buttonProps:{type:"primary",danger:!0,icon:(0,e.jsx)(J.Z,{})},callback:function(z){D(!0),P.hi.approvalTask({answer:k.values,attachment:k.attachments,answerId:t.answerId,taskId:t.id,type:"refuse",activityId:t.activityId,comment:z,projectId:t.projectId,processInstanceId:t.processInstanceId}).then(function(){B.default.success("\u5DF2\u62D2\u7EDD"),D(!1),A(void 0),i(a,!0)})}}):D(!1)})},children:"\u62D2\u7EDD"}),(0,e.jsx)(De.Z,{overlay:ct,placement:"topCenter",trigger:["click"],children:(0,e.jsx)(w.Z,{onClick:function(){P.hi.getRevertNodes(t.processInstanceId).then(function(d){d&&M(d)})},icon:(0,e.jsx)(G.Z,{}),loading:W,children:"\u56DE\u9000"})})]}),f===2&&t.status===1&&t.latest&&t.approvalType!=="revert"&&(0,e.jsx)(w.Z,{onClick:function(){var d;(d=C.current)===null||d===void 0||d.submit().then(function(k){k?A({visible:!0,buttonProps:{type:"primary",danger:!0,icon:(0,e.jsx)(J.Z,{})},callback:function(z){D(!0),P.hi.approvalTask({answer:k.values,attachment:k.attachments,answerId:t.answerId,taskId:t.id,type:"revert",activityId:t.activityId,newActivityId:t.activityId,comment:z,projectId:t.projectId,processInstanceId:t.processInstanceId}).then(function(){B.default.success("\u5DF2\u64A4\u56DE"),D(!1),A(void 0),i(a,!0)})}}):D(!1)})},icon:(0,e.jsx)(G.Z,{}),loading:W,children:"\u64A4\u56DE"}),f===4&&t.status===6&&(0,e.jsx)(w.Z,{onClick:function(){var d;(d=C.current)===null||d===void 0||d.submit().then(function(k){k?A({visible:!0,buttonProps:{type:"primary",icon:(0,e.jsx)(oe.Z,{})},callback:function(z){D(!0),P.hi.approvalTask({answer:k.values,attachment:k.attachments,answerId:t.answerId,taskId:t.id,type:"save",activityId:t.activityId,comment:z,projectId:t.projectId,processInstanceId:t.processInstanceId}).then(function(){B.default.success("\u5DF2\u64A4\u56DE"),D(!1),A(void 0),i(a,!0)})}}):D(!1)})},icon:(0,e.jsx)(oe.Z,{}),loading:W,children:"\u518D\u6B21\u63D0\u4EA4"}),(0,e.jsx)(w.Z,{onClick:function(){},icon:(0,e.jsx)(Re.Z,{}),loading:W})]})};return(0,e.jsx)("div",{ref:I,className:"edit-data ",children:(0,e.jsxs)(ae.Z,{visible:!0,maskClosable:!1,title:!1,width:900,onCancel:function(){return c()},className:"task-edit-modal",footer:!1,children:[(0,e.jsxs)("div",{style:{display:"flex"},children:[(0,e.jsxs)("div",{className:U+"-survey-container",style:{flex:1},children:[(0,e.jsx)("div",{className:U+"-survey-container-title",children:"\u6211\u7684\u5BA1\u6279"}),(0,e.jsx)("div",{className:U+"-survey-container-content",children:lt()}),(0,e.jsxs)("div",{className:U+"-survey-container-footer",children:[(0,e.jsxs)("div",{className:"nav",children:[(0,e.jsxs)("span",{children:[a+1,"/",o]}),(0,e.jsxs)("div",{children:[(0,e.jsx)(w.Z,{type:"text",shape:"circle",icon:(0,e.jsx)(Pe.Z,{}),disabled:a===0,onClick:function(){return ye("up")}}),(0,e.jsx)(w.Z,{type:"text",shape:"circle",icon:(0,e.jsx)(Oe.Z,{}),disabled:a===o-1,onClick:function(){return ye("down")}})]})]}),ut()]})]}),(0,e.jsxs)("div",{className:U+"-metaInfo-container",style:{width:m},children:[(0,e.jsx)("div",{className:U+"-metaInfo-container-title"}),(0,e.jsx)("div",{className:U+"-metaInfo-container-content",children:ot()}),(0,e.jsx)("div",{className:U+"-metaInfo-container-resizer",style:{transform:m===0?"rotateY(180deg) translate3d(100%,-50%,0)":"translate3d(0,-50%,0)"},onClick:function(){u(m===0?350:0)},children:(0,e.jsx)(we.Z,{})})]})]}),(y==null?void 0:y.visible)&&(0,e.jsx)(Le,{onOk:function(R){return y.callback(R)},onCancel:function(){return A(void 0)},buttonProps:y.buttonProps})]})})}),Qe=(0,V.Pi)(function(l){var t=l.projectId,a=l.taskType,o=(0,r.useContext)(X),c=(0,P.iZ)(t),i=(0,P.Ge)(t),f=(0,r.useRef)(),s=i.tasks[a]||{list:[],total:0,current:1,pageSize:50},S=(0,r.useState)(),m=(0,p.Z)(S,2),u=m[0],I=m[1],O=(0,r.useState)(),Z=(0,p.Z)(O,2),h=Z[0],g=Z[1];(0,r.useEffect)(function(){var x=s.list.length;if(u===void 0){g(void 0);return}if(x===0){I(void 0);return}if(u>=x){I(0);return}u!==void 0&&s.current&&s.total&&g({currIndex:u,total:s.total,currentRecord:s.list[u]})},[u,s]);var C=function(N,y){i.loadFlowTasks({type:a,projectId:t,current:N,pageSize:y})};(0,r.useEffect)(function(){(a||u===void 0)&&C()},[a,u]);var v=c.schema,j=(0,r.useMemo)(function(){var x=(0,ne.ZZ)(v)||[];return x.splice(0,0,{name:"approvalStage",title:"\u5F53\u524D\u6D41\u7A0B\u72B6\u6001",width:180}),x.push({name:"createUser",title:"\u7533\u8BF7\u4EBA"}),x.push({name:"createAt",title:"\u7533\u8BF7\u65F6\u95F4",width:180}),x.push({name:"updateAt",title:"\u66F4\u65B0\u65F6\u95F4",width:180}),x},[v]),T=(0,r.useMemo)(function(){var x=(0,ne.IR)(s.list,j);return x.forEach(function(N){var y;N.createUser=(y=N.createUser)===null||y===void 0?void 0:y.name}),x},[s,j]),M=function(N,y){h&&(y?i.removeTask(h.currentRecord.id,a):I(N))};return(0,e.jsxs)("div",{children:[(0,e.jsx)(Y._$,{ref:f,width:o.width-10,height:o.height-95,data:T,schema:j,selectionMode:"row",allowSorting:!0,onDoubleClick:function(N){var y;if(((y=N.data)===null||y===void 0?void 0:y._i)!==void 0){var A;I((A=N.data)===null||A===void 0?void 0:A._i)}}}),(0,e.jsxs)("div",{className:"statusBar-container",children:[(0,e.jsx)("div",{children:(0,e.jsx)("div",{style:{fontSize:12,color:"##767e89",userSelect:"none"},children:"\u53CC\u51FB\u884C\u5BA1\u6279"})}),(0,e.jsxs)("div",{children:[(0,e.jsx)(Y.tl,{current:s.current,pageSize:s.pageSize,total:s.total,onChange:function(N){C(N.current,N.pageSize)}}),(0,e.jsx)(Y.hY,{onClick:function(){return C(s.current,s.pageSize)}})]}),(0,e.jsx)("div",{})]}),h&&(0,e.jsx)(Ve,(0,F.Z)((0,F.Z)({},h),{},{taskType:a,onClose:function(){I(void 0)},onNav:M}))]})}),Ye=(0,V.Pi)(function(l){var t=(0,r.useContext)(te.xI),a=(t==null?void 0:t.id)||l.projectId,o=(0,P.iZ)(a),c=tt();return(0,r.useEffect)(function(){o.loadProject()},[o,a]),(0,e.jsx)("div",{style:{padding:"2px 5px"},className:"task-widget",children:(0,e.jsx)(Qe,{projectId:a,taskType:parseInt(c.activeKey||"0")})})});Q.registerComponent("taskCenter",Ye);var Nt=n(13062),fe=n(71230),Ft=n(77576),he=n(12028),Tt=n(89032),K=n(15746),Et=n(20136),Ge=n(55241),me=n(3182),Je=n(94043),L=n.n(Je),$e=n(23538),ge=n(92592),Xe=de.Z.Search;function qe(l){return"".concat(window.location.origin,"/s/").concat(l)}var _e=function(){var t,a,o,c,i=(0,te.IE)(),f=i.loading,s=qe(i.id),S=(0,r.useState)(""),m=(0,p.Z)(S,2),u=m[0],I=m[1];(0,r.useEffect)(function(){function Z(){return h.apply(this,arguments)}function h(){return h=(0,me.Z)(L().mark(function g(){return L().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:ge.toDataURL(s,{errorCorrectionLevel:"H",type:"image/jpeg",quality:.3,margin:1,color:{dark:"#010599FF",light:"#FFBF60FF"}}).then(function(j){I(j)}).catch(function(j){console.error(j)});case 1:case"end":return v.stop()}},g)})),h.apply(this,arguments)}Z()},[s]);var O=(0,r.useCallback)(function(){var Z=(0,me.Z)(L().mark(function h(g){return L().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:ge.toDataURL(s,{errorCorrectionLevel:"H",margin:1,color:{dark:"#010599FF",light:"#FFBF60FF"},width:g}).then(function(j){I(j);var T=document.createElement("a");T.href=j,T.setAttribute("download","".concat(i.name,"_").concat(g,".png")),document.body.appendChild(T),T.click(),document.body.removeChild(T)});case 1:case"end":return v.stop()}},h)}));return function(h){return Z.apply(this,arguments)}}(),[s,i]);return(0,e.jsx)(fe.Z,{gutter:[20,20],style:{padding:10},children:(0,e.jsx)(K.Z,{sm:24,xs:24,children:(0,e.jsxs)(fe.Z,{gutter:[10,10],children:[(0,e.jsxs)(K.Z,{span:24,className:"setting-item",children:[(0,e.jsx)(Xe,{value:s,style:{width:360},enterButton:"\u6253\u5F00",className:"open-target",onSearch:function(){window.open("/s/".concat(i.id))}}),(0,e.jsx)(Ge.Z,{content:(0,e.jsxs)("div",{children:[(0,e.jsx)("img",{src:u,height:150,width:150}),(0,e.jsx)("div",{style:{textAlign:"center"},children:(0,e.jsxs)(se.Z,{children:[(0,e.jsx)(w.Z,{size:"small",type:"link",onClick:function(){return O(256)},children:"\u5C0F\u53F7"}),(0,e.jsx)(w.Z,{size:"small",type:"link",onClick:function(){return O(512)},children:"\u4E2D\u53F7"}),(0,e.jsx)(w.Z,{size:"small",type:"link",onClick:function(){return O(1024)},children:"\u5927\u53F7"})]})})]}),title:"".concat(i.name,"(\u4E8C\u7EF4\u7801)"),trigger:["click"],children:(0,e.jsx)($e.Z,{style:{fontSize:30}})})]}),(0,e.jsxs)(K.Z,{className:"setting-item",span:24,children:[(0,e.jsx)("div",{className:"title",children:"\u95EE\u5377\u5F00\u542F/\u505C\u6B62"}),(0,e.jsx)("div",{children:(0,e.jsx)(he.Z,{defaultChecked:((t=i.project)===null||t===void 0||(a=t.setting)===null||a===void 0?void 0:a.status)===1,onChange:function(h){P.hi.updateSetting({id:i.id,settingKey:"status",settingValue:h?1:0}).then(function(g){g.code===200?h?B.default.info("\u95EE\u5377\u5DF2\u5F00\u542F"):B.default.warn("\u95EE\u5377\u5DF2\u505C\u6B62"):B.default.error(g.message)})}})})]}),(0,e.jsxs)(K.Z,{className:"setting-item",span:24,children:[(0,e.jsx)("div",{className:"title",children:"\u95EE\u5377\u586B\u5199\u65F6\u81EA\u52A8\u4FDD\u5B58"}),(0,e.jsx)("div",{children:(0,e.jsx)(he.Z,{defaultChecked:(o=i.project)===null||o===void 0||(c=o.setting)===null||c===void 0?void 0:c.answerSetting.autoSave,onChange:function(h){P.hi.updateSetting({id:i.id,settingKey:"answerSetting.autoSave",settingValue:h}).then(function(g){g.code===200?h?B.default.info("\u6682\u5B58\u5DF2\u5F00\u542F"):B.default.warn("\u6682\u5B58\u5DF2\u505C\u6B62"):B.default.error(g.message)})}})})]})]})})})};Q.registerComponent("quickSetting",_e);var et=function(t){var a=t.tabs,o=t.defaultActive,c=(0,r.useState)(o||a[0].key),i=(0,p.Z)(c,2),f=i[0],s=i[1],S=function(u){s(u),t.onChange(u)};return(0,e.jsx)("div",{className:"tabs-nav-list",children:a.map(function(m){return(0,e.jsx)("div",{onClick:function(){return S(m.key)},className:ue()("tabs-tab",{active:f===m.key}),children:m.title},m.key)})})},X=r.createContext({});function tt(){return(0,r.useContext)(X)}var nt=r.forwardRef(function(l,t){var a=l.style,o=l.className,c=l.key,i=l.children,f=l.name,s=l.title,S=l.tabs,m=l.widgetProps,u=l.toggleFullScreen,I=(0,_.Z)(l,["style","className","key","children","name","title","tabs","widgetProps","toggleFullScreen"]),O=(0,r.useState)(S&&S[0].key),Z=(0,p.Z)(O,2),h=Z[0],g=Z[1],C=(0,r.useState)(!1),v=(0,p.Z)(C,2),j=v[0],T=v[1],M=function(){return S?(0,e.jsx)(et,{tabs:S,onChange:function(y){return g(y)}}):(0,e.jsx)("span",{className:"",children:s})};return(0,e.jsxs)("div",(0,F.Z)((0,F.Z)({style:(0,F.Z)({},a),className:["widget",o].join(" ")},I),{},{ref:t,children:[(0,e.jsxs)("div",{className:"header",children:[(0,e.jsxs)("span",{className:"title",children:[M(),(0,e.jsx)("div",{className:"drag-handle"})]}),(0,e.jsxs)("div",{className:"widget-controls",children:[j&&(0,e.jsx)(Ze.Z,{className:"control-item",onClick:function(){T(!1),u()}}),!j&&(0,e.jsx)(ke.Z,{className:"control-item",onClick:function(){T(!0),u()}}),(0,e.jsx)(Ne.Z,{className:"control-item"})]})]}),(0,e.jsx)(ee.SizeMe,{monitorHeight:!0,children:function(N){var y=N.size;return(0,e.jsx)(X.Provider,{value:{height:y.height||0,width:y.width||0,activeKey:h},children:(0,e.jsx)("div",{style:{height:"100%"},children:r.createElement(Q.getComponent(f),m)})})}}),i]}),c)}),at=nt,st=n(35914),xe=function(t){var a=(0,Ce.UO)(),o=a.id,c=(0,r.useState)(Ie),i=(0,p.Z)(c,2),f=i[0],s=i[1],S=(0,r.useRef)(0),m=(0,r.useState)(),u=(0,p.Z)(m,2),I=u[0],O=u[1];if(o==="new")return(0,e.jsx)(st.default,(0,F.Z)({},t));var Z=function(g){if(I)s(I.cacheData),O(void 0);else{var C=JSON.parse(JSON.stringify(f.find(function(v){return v.key===g})));O({key:g,cacheData:f}),C["data-grid"]={x:0,y:0,w:12,h:(S.current-100)/150,i:g,static:!0},s([C])}};return(0,e.jsx)("div",{className:"survey-overview",children:(0,e.jsx)(ee.SizeMe,{monitorHeight:!0,children:function(g){var C=g.size;return S.current=C.height||0,(0,e.jsx)(Se.Responsive,{autoSize:!1,className:"layout",onDrag:function(j){},draggableHandle:".drag-handle",breakpoints:{lg:1200,md:996,sm:768,xs:480,xxs:0},cols:{lg:12,md:12,sm:12,xs:4,xxs:2},width:C.width||0,layouts:{lg:f.map(function(v){return v["data-grid"]}),md:f.map(function(v){return v["data-grid"]})},useCSSTransforms:!1,onLayoutChange:function(j){console.log(j)},children:f.map(function(v){var j=v.key,T=(0,_.Z)(v,["key"]);return(0,e.jsx)(at,(0,F.Z)((0,F.Z)({},T),{},{toggleFullScreen:function(){return Z(j)}}),j)})})}})})},it=xe}}]);
