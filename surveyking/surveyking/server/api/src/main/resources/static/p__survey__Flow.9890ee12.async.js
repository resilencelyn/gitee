(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[6132],{55686:function(je,Q,c){"use strict";var S=c(11849),ne=c(94233),R=c(51890),ee=c(93224),T=c(89366),W=c(85893),pe=function(me){var O=me.user,k=(0,ee.Z)(me,["user"]);return O.avatar?(0,W.jsx)(R.C,(0,S.Z)({src:"/api/public/preview/".concat(O.avatar),size:k.size||"small"},k)):(0,W.jsx)(R.C,(0,S.Z)({icon:(0,W.jsx)(T.Z,{}),size:k.size||"small"},k))};Q.Z=pe},90586:function(je,Q,c){"use strict";c.d(Q,{P:function(){return se}});var S=c(11849),ne=c(93224),R=c(2299),ee=c(67294),T=c(30381),W=c.n(T),pe=c(85893),se=function(O){var k=O.children,b=O.syncDisplay,Ce=O.isMoment,xe=(0,ne.Z)(O,["children","syncDisplay","isMoment"]),p=(0,ee.useMemo)(function(){return(0,R.$j)(function(y){var M=y.value,L=y.onChange,F=M;return Ce&&M&&(F=W()(M)),ee.cloneElement(k,{value:F,onChange:function(oe){L(oe)}})},(0,R.jM)(function(y,M){return{value:y.value,onChange:function(F){W().isMoment(F)?M.onInput(F.valueOf()):M.onInput(F)}}}))},[]);return(0,pe.jsx)(R.gN,(0,S.Z)((0,S.Z)({},xe),{},{component:[p,O],reactions:[function(y){if(b)if(typeof b=="string"){var M=y.query(y.path.parent().concat(b)).get("value");M?y.display="visible":y.display="none"}else typeof b=="object"&&Object.keys(b).forEach(function(L){var F=y.query(y.path.parent().concat(L)).get("value");b[L].includes(F)?y.display="visible":y.display="none"})}]}))};Q.Z=se},98113:function(je,Q,c){"use strict";c.r(Q),c.d(Q,{Flow:function(){return Rt},default:function(){return Ci}});var S=c(11849),ne=c(49111),R=c(19650),ee=c(57663),T=c(71577),W=c(3182),pe=c(71194),se=c(50146),me=c(34792),O=c(48086),k=c(86582),b=c(2824),Ce=c(94043),xe=c.n(Ce),p=c(67294),y=c(59782),M=c.n(y),L=c(86492),F={pluginName:"control",__lf:null,__controlItems:[{key:"zoom-out",iconClass:"lf-control-zoomOut",title:"\u7F29\u5C0F\u6D41\u7A0B\u56FE",text:"\u7F29\u5C0F",onClick:function(){F.__lf.zoom(!1)}},{key:"zoom-in",iconClass:"lf-control-zoomIn",title:"\u653E\u5927\u6D41\u7A0B\u56FE",text:"\u653E\u5927",onClick:function(){F.__lf.zoom(!0)}},{key:"reset",iconClass:"lf-control-fit",title:"\u6062\u590D\u6D41\u7A0B\u539F\u6709\u5C3A\u5BF8",text:"\u9002\u5E94",onClick:function(){F.__lf.resetZoom()}},{key:"undo",iconClass:"lf-control-undo",title:"\u56DE\u5230\u4E0A\u4E00\u6B65",text:"\u4E0A\u4E00\u6B65",onClick:function(){F.__lf.undo()}},{key:"redo",iconClass:"lf-control-redo",title:"\u79FB\u5230\u4E0B\u4E00\u6B65",text:"\u4E0B\u4E00\u6B65",onClick:function(){F.__lf.redo()}}],addItem:function(n){F.__controlItems.push(n)},removeItem:function(n){var t=F.__controlItems.findIndex(function(a){return a.key===n});return F.__controlItems.splice(t,1)[0]},install:function(){},render:function(n,t){F.__lf=n,F.__domContainer=t,F.__tool=this.__getControlTool(),t.appendChild(F.__tool)},destroy:function(){try{var n;(n=F.__domContainer)===null||n===void 0||n.removeChild(F.__tool)}catch(t){console.warn("unexpect destory error",t)}},__getControlTool:function(){var n="lf-control-item",t="lf-control-item disabled",a=document.createElement("div"),r=[];return a.className="lf-control",F.__controlItems.forEach(function(s){var o=document.createElement("div"),u=document.createElement("i"),l=document.createElement("span");switch(o.className=t,s.onClick&&(o.onclick=s.onClick.bind(null,F.__lf)),s.onMouseEnter&&(o.onmouseenter=s.onMouseEnter.bind(null,F.__lf)),s.onMouseLeave&&(o.onmouseleave=s.onMouseLeave.bind(null,F.__lf)),u.className=s.iconClass,l.className="lf-control-text",l.title=s.title,l.innerText=s.text,o.append(u,l),s.text){case"\u4E0A\u4E00\u6B65":F.__lf.on("history:change",function(d){var v=d.data.undoAble;o.className=v?n:t});break;case"\u4E0B\u4E00\u6B65":F.__lf.on("history:change",function(d){var v=d.data.redoAble;o.className=v?n:t});break;default:o.className=n;break}r.push(o)}),a.append.apply(a,r),a}},Vt=null;function oe(i,n){for(var t=0;t<n;t++)i+="  ";return i}function Fe(i,n,t,a){var r="";if(i instanceof Array)for(var s=0,o=i.length;s<o;s++)r+=oe(t,a)+Fe(i[s],n,t,a+1);else if(typeof i=="object"){var u=!1;r+=oe(t,a)+"<"+n;for(var l in i)l.charAt(0)=="-"?r+=" "+l.substr(1)+'="'+i[l].toString().replace("<","&lt;")+'"':u=!0;if(r+=u?">":" />",u){for(var d in i)d=="#text"?r+=i[d]:d=="#cdata"?r+="<![CDATA["+i[d]+"]]>":d.charAt(0)!="-"&&(r+=Fe(i[d],d,t,a+1));r+=oe(t,a)+"</"+n+">"}}else r+=oe(t,a)+"<"+n+">"+i.toString()+"</"+n+">";return r}function Wt(i){var n="";for(var t in i)n+=Fe(i[t],t,`	
`,0);return n}var U=function(){};U.ObjTree=function(){return this},U.ObjTree.VERSION="0.23",U.ObjTree.prototype.xmlDecl=`<?xml version="1.0" encoding="UTF-8" ?>
`,U.ObjTree.prototype.attr_prefix="-",U.ObjTree.prototype.parseXML=function(i){var n;if(window.DOMParser){var t=new DOMParser,a=t.parseFromString(i,"application/xml");if(!a)return;n=a.documentElement}else window.ActiveXObject&&(t=new ActiveXObject("Microsoft.XMLDOM"),t.async=!1,t.loadXML(i),n=t.documentElement);if(!!n)return this.parseDOM(n)},U.ObjTree.prototype.parseHTTP=function(i,n,t){var a={};for(var r in n)a[r]=n[r];if(a.method||(typeof a.postBody=="undefined"&&typeof a.postbody=="undefined"&&typeof a.parameters=="undefined"?a.method="get":a.method="post"),t){a.asynchronous=!0;var s=this,o=t,u=a.onComplete;a.onComplete=function(v){var h;v&&v.responseXML&&v.responseXML.documentElement&&(h=s.parseDOM(v.responseXML.documentElement)),o(h,v),u&&u(v)}}else a.asynchronous=!1;var l;if(typeof HTTP!="undefined"&&HTTP.Request){a.uri=i;var d=new HTTP.Request(a);d&&(l=d.transport)}else if(typeof Ajax!="undefined"&&Ajax.Request){var d=new Ajax.Request(i,a);d&&(l=d.transport)}if(t)return l;if(l&&l.responseXML&&l.responseXML.documentElement)return this.parseDOM(l.responseXML.documentElement)},U.ObjTree.prototype.parseDOM=function(i){if(!!i){if(this.__force_array={},this.force_array)for(var n=0;n<this.force_array.length;n++)this.__force_array[this.force_array[n]]=1;var t=this.parseElement(i);if(this.__force_array[i.nodeName]&&(t=[t]),i.nodeType!=11){var a={};a[i.nodeName]=t,t=a}return t}},U.ObjTree.prototype.parseElement=function(i){if(i.nodeType!=7){if(i.nodeType==3||i.nodeType==4){var n=i.nodeValue.match(/[^\x00-\x20]/);return n==null?void 0:i.nodeValue}var t,a={};if(i.attributes&&i.attributes.length){t={};for(var r=0;r<i.attributes.length;r++){var s=i.attributes[r].nodeName;if(typeof s=="string"){var o=i.attributes[r].nodeValue;!o||(s=this.attr_prefix+s,typeof a[s]=="undefined"&&(a[s]=0),a[s]++,this.addNode(t,s,a[s],o))}}}if(i.childNodes&&i.childNodes.length){var u=!0;t&&(u=!1);for(var r=0;r<i.childNodes.length&&u;r++){var l=i.childNodes[r].nodeType;l==3||l==4||(u=!1)}if(u){t||(t="");for(var r=0;r<i.childNodes.length;r++)t+=i.childNodes[r].nodeValue}else{t||(t={});for(var r=0;r<i.childNodes.length;r++){var s=i.childNodes[r].nodeName;if(typeof s=="string"){var o=this.parseElement(i.childNodes[r]);!o||(typeof a[s]=="undefined"&&(a[s]=0),a[s]++,this.addNode(t,s,a[s],o))}}}}return t}},U.ObjTree.prototype.addNode=function(i,n,t,a){this.__force_array[n]?(t==1&&(i[n]=[]),i[n][i[n].length]=a):t==1?i[n]=a:t==2?i[n]=[i[n],a]:i[n][i[n].length]=a},U.ObjTree.prototype.writeXML=function(i){var n=this.hash_to_xml(null,i);return this.xmlDecl+n},U.ObjTree.prototype.hash_to_xml=function(i,n){var t=[],a=[];for(var r in n)if(!!n.hasOwnProperty(r)){var s=n[r];r.charAt(0)!=this.attr_prefix?typeof s=="undefined"||s==null?t[t.length]="<"+r+" />":typeof s=="object"&&s.constructor==Array?t[t.length]=this.array_to_xml(r,s):typeof s=="object"?t[t.length]=this.hash_to_xml(r,s):t[t.length]=this.scalar_to_xml(r,s):a[a.length]=" "+r.substring(1)+'="'+this.xml_escape(s)+'"'}var o=a.join(""),u=t.join("");return typeof i=="undefined"||i==null||(t.length>0?u.match(/\n/)?u="<"+i+o+`>
`+u+"</"+i+`>
`:u="<"+i+o+">"+u+"</"+i+`>
`:u="<"+i+o+` />
`),u},U.ObjTree.prototype.array_to_xml=function(i,n){for(var t=[],a=0;a<n.length;a++){var r=n[a];typeof r=="undefined"||r==null?t[t.length]="<"+i+" />":typeof r=="object"&&r.constructor==Array?t[t.length]=this.array_to_xml(i,r):typeof r=="object"?t[t.length]=this.hash_to_xml(i,r):t[t.length]=this.scalar_to_xml(i,r)}return t.join("")},U.ObjTree.prototype.scalar_to_xml=function(i,n){return i=="#text"?this.xml_escape(n):"<"+i+">"+this.xml_escape(n)+"</"+i+`>
`},U.ObjTree.prototype.xml_escape=function(i){return i.replace(/&/g,"&").replace(/</g,"<").replace(/>/g,">").replace(/"/g,'"')};var zt=U,Xe={width:40,height:40},Ke={width:40,height:40},$e={width:40,height:40},Ye={width:100,height:80},Je={width:100,height:80},Gt={rect:{radius:5,stroke:"rgb(24, 125, 255)"},circle:{r:18,stroke:"rgb(24, 125, 255)"},polygon:{stroke:"rgb(24, 125, 255)"},polyline:{stroke:"rgb(24, 125, 255)",hoverStroke:"rgb(24, 125, 255)",selectedStroke:"rgb(24, 125, 255)"},edgeText:{background:{fill:"white",height:14,stroke:"transparent",radius:3}}},$;(function(i){i.START="startEvent",i.END="endEvent",i.GATEWAY="exclusiveGateway",i.USER="userTask",i.SYSTEM="serviceTask",i.FLOW="sequenceFlow"})($||($={}));var Qe=["startEvent","endEvent","exclusiveGateway","userTask","serviceTask","sequenceFlow","completionCondition","multiInstanceLoopCharacteristics","conditionExpression","#text"],qe=["-name","-id","incoming","outgoing","-sourceRef","-targetRef"];function Be(i){var n={};return Object.entries(i).forEach(function(t){var a=(0,b.Z)(t,2),r=a[0],s=a[1];s!=null&&(typeof s!="object"?r.indexOf("-")===0||Qe.includes(r)?n[r]=s:n["-".concat(r)]=s:n[r]=Be(s))}),n}function we(i){var n={};return Object.entries(i).forEach(function(t){var a=(0,b.Z)(t,2),r=a[0],s=a[1];typeof s=="string"?r.indexOf("-")===0?n[r.substr(1)]=s:n[r]=s:typeof s=="object"?n[r]=we(s):n[r]=s}),n}function Ht(i,n){var t=new Map;n.nodes.forEach(function(r){var s,o={"-id":r.id};if((s=r.text)!==null&&s!==void 0&&s.value&&(o["-name"]=r.text.value),r.properties){var u=Be(r.properties);Object.assign(o,u)}t.set(r.id,o),i[r.type]?Array.isArray(i[r.type])?i[r.type].push(o):i[r.type]=[i[r.type],o]:i[r.type]=o});var a=n.edges.map(function(r){var s,o={"-id":r.id,"-sourceRef":r.sourceNodeId,"-targetRef":r.targetNodeId};if((s=r.text)!==null&&s!==void 0&&s.value){var u;o["-name"]=(u=r.text)===null||u===void 0?void 0:u.value}if(r.properties){var l=Be(r.properties);Object.assign(o,l)}return o});i[$.FLOW]=a}function Xt(i,n){i["bpmndi:BPMNEdge"]=n.edges.map(function(t){var a,r=t.id,s=t.pointsList.map(function(u){var l=u.x,d=u.y;return{"-x":l,"-y":d}}),o={"-id":"".concat(r,"_di"),"-bpmnElement":r,"di:waypoint":s};return(a=t.text)!==null&&a!==void 0&&a.value&&(o["bpmndi:BPMNLabel"]={"dc:Bounds":{"-x":t.text.x-t.text.value.length*10/2,"-y":t.text.y-7,"-width":t.text.value.length*10,"-height":14}}),o}),i["bpmndi:BPMNShape"]=n.nodes.map(function(t){var a,r=t.id,s=100,o=80,u=t.x,l=t.y,d=q.shapeConfigMap.get(t.type);d&&(s=d.width,o=d.height),u-=s/2,l-=o/2;var v={"-id":"".concat(r,"_di"),"-bpmnElement":r,"dc:Bounds":{"-x":u,"-y":l,"-width":s,"-height":o}};return(a=t.text)!==null&&a!==void 0&&a.value&&(v["bpmndi:BPMNLabel"]={"dc:Bounds":{"-x":t.text.x-t.text.value.length*10/2,"-y":t.text.y-7,"-width":t.text.value.length*10,"-height":14}}),v})}function Kt(i){var n=[],t=[],a=i.definitions;if(a){var r=a.process;Object.keys(r).forEach(function(s){if(Qe.includes(s)){var o=r[s];if(s===$.FLOW){var u=a["bpmndi:BPMNDiagram"]["bpmndi:BPMNPlane"]["bpmndi:BPMNEdge"];t=Yt(o,u)}else{var l=a["bpmndi:BPMNDiagram"]["bpmndi:BPMNPlane"]["bpmndi:BPMNShape"];n=n.concat($t(o,l,s))}}})}return{nodes:n,edges:t}}function $t(i,n,t){var a=[];if(Array.isArray(i))i.forEach(function(o){var u;Array.isArray(n)?u=n.find(function(d){return d["-bpmnElement"]===o["-id"]}):u=n;var l=_e(u,t,o);a.push(l)});else{var r;Array.isArray(n)?r=n.find(function(o){return o["-bpmnElement"]===i["-id"]}):r=n;var s=_e(r,t,i);a.push(s)}return a}function _e(i,n,t){var a=Number(i["dc:Bounds"]["-x"]),r=Number(i["dc:Bounds"]["-y"]),s=t["-name"],o=q.shapeConfigMap.get(n);o&&(a+=o.width/2,r+=o.height/2);var u;Object.entries(t).forEach(function(h){var m=(0,b.Z)(h,2),B=m[0],P=m[1];qe.indexOf(B)===-1&&(u||(u={}),u[B]=P)}),u&&(u=we(u));var l;if(s&&(l={x:a,y:r,value:s},i["bpmndi:BPMNLabel"]&&i["bpmndi:BPMNLabel"]["dc:Bounds"])){var d=i["bpmndi:BPMNLabel"]["dc:Bounds"];l.x=Number(d["-x"])+Number(d["-width"])/2,l.y=Number(d["-y"])+Number(d["-height"])/2}var v={id:i["-bpmnElement"],type:n,x:a,y:r,properties:u};return l&&(v.text=l),v}function Yt(i,n){var t=[];if(Array.isArray(i))i.forEach(function(r){var s;Array.isArray(n)?s=n.find(function(o){return o["-bpmnElement"]===r["-id"]}):s=n,t.push(et(s,r))});else{var a;Array.isArray(n)?a=n.find(function(r){return r["-bpmnElement"]===i["-id"]}):a=n,t.push(et(a,i))}return t}function et(i,n){var t,a=n["-name"];if(a){var r=i["bpmndi:BPMNLabel"]["dc:Bounds"],s=0;a.split(`
`).forEach(function(l){s<l.length&&(s=l.length)}),t={value:a,x:Number(r["-x"])+s*10/2,y:Number(r["-y"])+7}}var o;Object.entries(n).forEach(function(l){var d=(0,b.Z)(l,2),v=d[0],h=d[1];qe.indexOf(v)===-1&&(o||(o={}),o[v]=h)}),o&&(o=we(o));var u={id:n["-id"],type:$.FLOW,pointsList:i["di:waypoint"].map(function(l){return{x:Number(l["-x"]),y:Number(l["-y"])}}),sourceNodeId:n["-sourceRef"],targetNodeId:n["-targetRef"],properties:o};return t&&(u.text=t),u}var q={pluginName:"bpmn-adapter",install:function(n){n.adapterIn=this.adapterIn,n.adapterOut=this.adapterOut},shapeConfigMap:new Map,setCustomShape:function(n,t){this.shapeConfigMap.set(n,t)},adapterOut:function(n,t){var a={"-id":"".concat(t),"-isExecutable":"true"};Ht(a,n);var r={"-id":"BPMNPlane_1","-bpmnElement":a["-id"]};Xt(r,n);var s={definitions:{"-id":"Definitions_".concat(t),"-xmlns":"http://www.omg.org/spec/BPMN/20100524/MODEL","-xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","-xmlns:bpmn":"http://www.omg.org/spec/BPMN/20100524/MODEL","-xmlns:bpmndi":"http://www.omg.org/spec/BPMN/20100524/DI","-xmlns:dc":"http://www.omg.org/spec/DD/20100524/DC","-xmlns:di":"http://www.omg.org/spec/DD/20100524/DI","-xmlns:flowable":"http://flowable.org/bpmn","-xmlns:s":"http://surveyking.cn/bpmn","-targetNamespace":"http://bpmn.io/schema/bpmn","-exporter":"bpmn-js (https://demo.bpmn.io)","-exporterVersion":"7.3.0",process:a,"bpmndi:BPMNDiagram":{"-id":"BPMNDiagram_1","bpmndi:BPMNPlane":r}}};return s},adapterIn:function(n){if(n)return Kt(n)}};q.shapeConfigMap.set($.START,{width:Xe.width,height:Xe.height}),q.shapeConfigMap.set($.END,{width:Ke.width,height:Ke.height}),q.shapeConfigMap.set($.GATEWAY,{width:$e.width,height:$e.height}),q.shapeConfigMap.set($.SYSTEM,{width:Ye.width,height:Ye.height}),q.shapeConfigMap.set($.USER,{width:Je.width,height:Je.height});var Jt={pluginName:"bpmn-xml-adapter",install:function(n){n.adapterIn=this.adapterXmlIn,n.adapterOut=this.adapterXmlOut},adapterXmlIn:function(n){var t=new zt.ObjTree().parseXML(n);return q.adapterIn(t)},adapterXmlOut:function(n){var t=q.adapterOut(n,this.options.extraConf.id);return Wt(t)}},Fi=null,V=c(69610),ie=c(54941),De=c(63543),Ae=c(94663),z=c(43028),G=c(5869),tt=function(i){(0,z.Z)(t,i);var n=(0,G.Z)(t);function t(a,r){return(0,V.Z)(this,t),a.id||(a.id="starter"),a.text||(a.text=""),a.text&&typeof a.text=="string"&&(a.text={value:a.text,x:a.x,y:a.y+40}),n.call(this,a,r)}return(0,ie.Z)(t,[{key:"setAttributes",value:function(){this.r=18}},{key:"getConnectedTargetRules",value:function(){var r=(0,De.Z)((0,Ae.Z)(t.prototype),"getConnectedTargetRules",this).call(this),s={message:"\u8D77\u59CB\u8282\u70B9\u4E0D\u80FD\u4F5C\u4E3A\u8FB9\u7684\u7EC8\u70B9",validate:function(){return!1}};return r.push(s),r}}]),t}(y.CircleNodeModel);tt.extendKey="StartEventModel";var nt=function(i){(0,z.Z)(t,i);var n=(0,G.Z)(t);function t(){return(0,V.Z)(this,t),n.apply(this,arguments)}return(0,ie.Z)(t,[{key:"getShape",value:function(){var r=this.props.model,s=r.x,o=r.y,u=this.props.model.getNodeStyle(),l=u.stroke;return(0,y.h)("svg",{x:s-64/2+10,y:o-64/2+10,width:64,height:64,viewBox:"0 0 32 32"},(0,y.h)("path",{fill:l,d:"M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10-4.477 10-10 10zm0-2a8 8 0 1 0 0-16 8 8 0 0 0 0 16zM10.622 8.415l4.879 3.252a.4.4 0 0 1 0 .666l-4.88 3.252a.4.4 0 0 1-.621-.332V8.747a.4.4 0 0 1 .622-.332z"}))}}]),t}(y.CircleNode);nt.extendKey="StartEventNode";var Qt={type:"startEvent",view:nt,model:tt},qt=Qt,_t=c(77596),en=(0,_t.kP)("_0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",10);function de(){return en()}var it=function(i){(0,z.Z)(t,i);var n=(0,G.Z)(t);function t(a,r){return(0,V.Z)(this,t),a.id||(a.id="Event_".concat(de())),a.text||(a.text=""),a.text&&typeof a.text=="string"&&(a.text={value:a.text,x:a.x,y:a.y+40}),n.call(this,a,r)}return(0,ie.Z)(t,[{key:"setAttributes",value:function(){this.r=18}},{key:"getConnectedSourceRules",value:function(){var r=(0,De.Z)((0,Ae.Z)(t.prototype),"getConnectedSourceRules",this).call(this),s={message:"\u7ED3\u675F\u8282\u70B9\u4E0D\u80FD\u4F5C\u4E3A\u8FB9\u7684\u8D77\u70B9",validate:function(){return!1}};return r.push(s),r}}]),t}(y.CircleNodeModel);it.extendKey="EndEventModel";var rt=function(i){(0,z.Z)(t,i);var n=(0,G.Z)(t);function t(){return(0,V.Z)(this,t),n.apply(this,arguments)}return(0,ie.Z)(t,[{key:"getAnchorStyle",value:function(){return{visibility:"hidden"}}},{key:"getShape",value:function(){var r=this.props.model,s=r.getNodeStyle(),o=r.x,u=r.y,l=r.r,d=r.width,v=r.height,h=(0,De.Z)((0,Ae.Z)(t.prototype),"getShape",this).call(this),m=this.props.model.getNodeStyle(),B=m.fill,P=m.stroke,D=m.strokeWidth,j=(0,y.h)("svg",{x:o-64/2+10,y:u-64/2+10,width:64,height:64,viewBox:"0 0 32 32"},(0,y.h)("path",{fill:P,d:"M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10-4.477 10-10 10zm0-2a8 8 0 1 0 0-16 8 8 0 0 0 0 16zM9 9h6v6H9V9z"}));return j}}]),t}(y.CircleNode);rt.extendKey="EndEventView";var tn={type:"endEvent",view:rt,model:it},nn=tn,at=function(i){(0,z.Z)(t,i);var n=(0,G.Z)(t);function t(a,r){var s;return(0,V.Z)(this,t),a.id||(a.id="Gateway_".concat(de())),a.text||(a.text=""),a.text&&typeof a.text=="string"&&(a.text={value:a.text,x:a.x,y:a.y+40}),s=n.call(this,a,r),s.points=[[25,0],[50,25],[25,50],[0,25]],s}return t}(y.PolygonNodeModel);at.extendKey="ExclusiveGatewayModel";var st=function(i){(0,z.Z)(t,i);var n=(0,G.Z)(t);function t(){return(0,V.Z)(this,t),n.apply(this,arguments)}return(0,ie.Z)(t,[{key:"getShape",value:function(){var r=this.props.model,s=r.x,o=r.y,u=r.width,l=r.height,d=r.points,v=r.getNodeStyle();return(0,y.h)("g",{transform:"matrix(1 0 0 1 ".concat(s-u/2," ").concat(o-l/2,")")},(0,y.h)("polygon",(0,S.Z)((0,S.Z)({},v),{},{x:s,y:o,points:d})),(0,y.h)("path",(0,S.Z)({d:"m 16,15 7.42857142857143,9.714285714285715 -7.42857142857143,9.714285714285715 3.428571428571429,0 5.714285714285715,-7.464228571428572 5.714285714285715,7.464228571428572 3.428571428571429,0 -7.42857142857143,-9.714285714285715 7.42857142857143,-9.714285714285715 -3.428571428571429,0 -5.714285714285715,7.464228571428572 -5.714285714285715,-7.464228571428572 -3.428571428571429,0 z"},v)))}}]),t}(y.PolygonNode);st.extendKey="ExclusiveGatewayNode";var rn={type:"exclusiveGateway",view:st,model:at},an=rn,ot=function(i){(0,z.Z)(t,i);var n=(0,G.Z)(t);function t(a,r){return(0,V.Z)(this,t),a.id||(a.id="Activity_".concat(de())),n.call(this,a,r)}return t}(y.RectNodeModel);ot.extendKey="UserTaskModel";var ut=function(i){(0,z.Z)(t,i);var n=(0,G.Z)(t);function t(){return(0,V.Z)(this,t),n.apply(this,arguments)}return(0,ie.Z)(t,[{key:"getLabelShape",value:function(){var r=this.props.model,s=r.x,o=r.y,u=r.width,l=r.height,d=r.getNodeStyle();return(0,y.h)("svg",{x:s-u/2+5,y:o-l/2+5,width:25,height:25,viewBox:"0 0 1274 1024"},(0,y.h)("path",{fill:d.stroke,d:"M655.807326 287.35973m-223.989415 0a218.879 218.879 0 1 0 447.978829 0 218.879 218.879 0 1 0-447.978829 0ZM1039.955839 895.482975c-0.490184-212.177424-172.287821-384.030443-384.148513-384.030443-211.862739 0-383.660376 171.85302-384.15056 384.030443L1039.955839 895.482975z"}))}},{key:"getShape",value:function(){var r=this.props.model,s=r.x,o=r.y,u=r.width,l=r.height,d=r.radius,v=r.getNodeStyle();return(0,y.h)("g",{},[(0,y.h)("rect",(0,S.Z)((0,S.Z)({},v),{},{x:s-u/2,y:o-l/2,rx:d,ry:d,width:u,height:l})),this.getLabelShape()])}}]),t}(y.RectNode);ut.extendKey="UserTaskNode";var sn={type:"userTask",view:ut,model:ot},on=sn,lt=function(i){(0,z.Z)(t,i);var n=(0,G.Z)(t);function t(a,r){return(0,V.Z)(this,t),a.id||(a.id="Activity_".concat(de())),n.call(this,a,r)}return t}(y.RectNodeModel);lt.extendKey="ServiceTaskModel";var ct=function(i){(0,z.Z)(t,i);var n=(0,G.Z)(t);function t(){return(0,V.Z)(this,t),n.apply(this,arguments)}return(0,ie.Z)(t,[{key:"getLabelShape",value:function(){var r=this.props.model,s=r.x,o=r.y,u=r.width,l=r.height,d=r.getNodeStyle();return(0,y.h)("svg",{x:s-u/2+5,y:o-l/2+5,width:30,height:30,viewBox:"0 0 1274 1024"},(0,y.h)("path",{fill:d.stroke,d:"M882.527918 434.149934c-2.234901-5.303796-7.311523-8.853645-13.059434-9.138124l-61.390185-3.009544c-6.635117-20.973684-15.521508-41.175795-26.513864-60.282968l42.051745-47.743374c4.308119-4.889357 4.955872-12.004405 1.602498-17.59268-46.384423-77.30362-103.969956-101.422947-106.400309-102.410438-5.332449-2.170432-11.432377-1.090844-15.693424 2.77009L654.674467 240.664222c-17.004279-8.654101-35.092239-15.756869-53.995775-21.210068l-3.26537-66.490344c-0.280386-5.747911-3.833305-10.824533-9.134031-13.059434-1.683339-0.709151-30.193673-12.391215-76.866668-12.051477-46.672996-0.339738-75.18333 11.342326-76.866668 12.051477-5.300726 2.234901-8.853645 7.311523-9.134031 13.059434l-3.26537 66.490344c-18.903535 5.453199-36.991496 12.555967-53.995775 21.210068l-48.450479-43.922349c-4.261047-3.860934-10.360975-4.940522-15.693424-2.77009-2.430352 0.98749-60.015885 25.106818-106.400309 102.410438-3.353374 5.588275-2.705622 12.703323 1.602498 17.59268l42.051745 47.743374c-10.992355 19.107173-19.878746 39.309284-26.513864 60.282968l-61.390185 3.009544c-5.747911 0.284479-10.824533 3.834328-13.059434 9.138124-1.01512 2.415003-24.687262 60.190871-2.822278 147.651828 1.583055 6.324032 7.072069 10.893094 13.57518 11.308557 5.892197 0.37146 11.751648 0.523933 17.419741 0.667196 14.498202 0.372483 28.193109 0.723477 40.908712 4.63353 4.212952 1.294482 6.435573 8.270361 9.349949 18.763342 1.287319 4.640694 2.617617 9.43693 4.484128 14.010085 1.794879 4.393054 3.75758 8.570189 5.66093 12.607132 1.302669 2.765997 2.529613 5.380544 3.689019 8.018627 2.986007 6.803963 2.682086 9.773598 2.578732 10.349719-3.061732 3.672646-6.391571 7.238868-9.91379 11.015891-1.810229 1.943258-3.680832 3.949962-5.523807 5.980201l-22.560832 24.8909c-3.865028 4.261047-4.940522 10.365068-2.774183 15.693424 0.991584 2.426259 25.102724 60.011792 102.414531 106.400309 5.588275 3.353374 12.703323 2.701528 17.591657-1.603521l23.476691-20.682042c2.346441-2.061962 4.64888-4.336772 6.875594-6.534833 9.05319-8.93858 14.018272-12.95608 17.73185-11.576663 3.305279 1.222851 6.907317 3.166109 10.720156 5.228071 3.325745 1.794879 6.764054 3.650133 10.465352 5.288446 6.016017 2.662643 12.120039 4.688789 18.019399 6.65149 6.827499 2.266623 13.279445 4.409426 18.819624 7.275707 1.518586 0.782829 1.926886 0.994654 2.358721 7.830339 0.726547 11.496845 1.25048 23.276123 1.753947 34.672684 0.264013 5.900384 0.528026 11.803837 0.815575 17.700127 0.284479 5.743818 3.833305 10.82044 9.138124 13.05534 1.654686 0.698918 29.371958 12.063757 74.869175 12.063757 0.328481 0 3.65832 0 3.986801 0 45.497217 0 73.214489-11.364839 74.869175-12.063757 5.304819-2.234901 8.853645-7.311523 9.138124-13.05534 0.287549-5.89629 0.551562-11.799744 0.815575-17.700127 0.503467-11.396561 1.027399-23.175839 1.753947-34.672684 0.431835-6.835685 0.840134-7.04751 2.358721-7.830339 5.54018-2.866281 11.992125-5.009084 18.819624-7.275707 5.89936-1.962701 12.003382-3.988848 18.019399-6.65149 3.701299-1.638313 7.139607-3.493567 10.465352-5.288446 3.812839-2.061962 7.414877-4.00522 10.720156-5.228071 3.713578-1.379417 8.67866 2.638083 17.73185 11.576663 2.226714 2.198062 4.529153 4.472871 6.875594 6.534833l23.476691 20.682042c4.888334 4.305049 12.003382 4.956895 17.591657 1.603521 77.311807-46.388517 101.422947-103.97405 102.414531-106.400309 2.166339-5.328355 1.090844-11.432377-2.774183-15.693424l-22.560832-24.8909c-1.842974-2.030239-3.713578-4.036943-5.523807-5.980201-3.52222-3.777023-6.852058-7.343245-9.91379-11.015891-0.103354-0.576121-0.407276-3.545756 2.578732-10.349719 1.159406-2.638083 2.38635-5.252631 3.689019-8.018627 1.90335-4.036943 3.866051-8.214079 5.66093-12.607132 1.866511-4.573155 3.196809-9.369392 4.484128-14.010085 2.914376-10.492982 5.136997-17.46886 9.349949-18.763342 12.715603-3.910053 26.41051-4.261047 40.908712-4.63353 5.668093-0.143263 11.527544-0.295735 17.419741-0.667196 6.503111-0.415462 11.992125-4.984524 13.57518-11.308557C907.21518 494.340805 883.543038 436.564937 882.527918 434.149934zM643.49894 643.761929c-35.280528 35.280528-82.191954 54.711066-132.086317 54.711066s-96.806813-19.430538-132.086317-54.711066c-35.280528-35.279504-54.711066-82.191954-54.711066-132.086317 0-49.894364 19.430538-96.80272 54.711066-132.082224 35.283598-35.284621 82.191954-54.711066 132.086317-54.711066s96.80579 19.426445 132.086317 54.711066c35.279504 35.279504 54.711066 82.187861 54.711066 132.082224C698.210006 561.569976 678.782537 608.482425 643.49894 643.761929z"}))}},{key:"getShape",value:function(){var r=this.props.model,s=r.x,o=r.y,u=r.width,l=r.height,d=r.radius,v=r.getNodeStyle();return(0,y.h)("g",{},[(0,y.h)("rect",(0,S.Z)({x:s-u/2,y:o-l/2,rx:d,ry:d,width:u,height:l},v)),this.getLabelShape()])}}]),t}(y.RectNode);ct.extendKey="ServiceTaskNode";var un={type:"serviceTask",view:ct,model:lt},ln=un,dt=function(i){(0,z.Z)(t,i);var n=(0,G.Z)(t);function t(a,r){return(0,V.Z)(this,t),a.id||(a.id="Flow_".concat(de())),n.call(this,a,r)}return t}(y.PolylineEdgeModel);dt.extendKey="SequenceFlowModel";var vt=function(i){(0,z.Z)(t,i);var n=(0,G.Z)(t);function t(){return(0,V.Z)(this,t),n.apply(this,arguments)}return t}(y.PolylineEdge);vt.extendKey="SequenceFlowEdge";var cn={type:"sequenceFlow",view:vt,model:dt},dn=cn,ht=function i(n){var t=n.lf;(0,V.Z)(this,i),t.setTheme(Gt),t.register(qt),t.register(nn),t.register(an),t.register(on),t.register(ln),t.options.customBpmnEdge||(t.register(dn),t.setDefaultEdgeType("sequenceFlow"))};ht.pluginName="BpmnElement";var Bi=c(57338),ft=c(25084),pt=c(29656),wi=c(29589),e=c(85893),vn={mode:"application/xml",lineWrapping:!0,lineNumbers:!0},hn=function(n){var t=n.visible,a=n.xml,r=n.onClose,s=(0,p.useState)(),o=(0,b.Z)(s,2),u=o[0],l=o[1];return(0,e.jsx)(ft.Z,{visible:t,onClose:function(){return r(u.getValue())},width:850,className:"flow-drawer",children:(0,e.jsx)(pt.Rt,{autoCursor:!1,value:a,options:vn,editorDidMount:function(v){return l(v)},onChange:function(){}})})},C=c(2299),mt={};function ue(i,n){mt[i]=n}function be(i){return mt[i]}var Di=c(18106),Y=c(67164),Ai=c(43358),I=c(97268),fn=c(32059),bi=c(13254),xt=c(14277),Si=c(88983),Se=c(47933),le=c(11628),Ne=c(76826),gt=c(96486),pn=["FillBlank","MultipleBlank","Textarea","Signature","Radio","Checkbox","Select","Cascader","MatrixAuto","MatrixRadio","MatrixCheckbox","MatrixFillBlank","MatrixScore","Upload","Score","Remark","SplitLine","User","Dept"],mn=["Pagination","Remark","SplitLine"],xn={Pagination:"\u5206\u9875",Remark:"\u5907\u6CE8",SplitLine:"\u5206\u5272\u7EBF"};function Et(i){var n=[];return i&&((pn.includes(i.type)||mn.includes(i.type))&&n.push({id:i.id,title:xn[i.type]||(0,Ne.WO)(i.title),type:i.type}),i.children&&i.children.map(function(t){var a=Et(t);a&&n.push.apply(n,(0,k.Z)(a))})),n}var gn=function(n){var t=n.value,a=n.onChange;return(0,e.jsxs)("tr",{children:[(0,e.jsx)("td",{children:n.title}),(0,e.jsx)("td",{onClick:function(){return a(2)},children:(0,e.jsx)(Se.ZP,{value:2,checked:t===2})}),(0,e.jsx)("td",{onClick:function(){return a(1)},children:(0,e.jsx)(Se.ZP,{value:1,checked:t===1})}),(0,e.jsx)("td",{onClick:function(){return a(0)},children:(0,e.jsx)(Se.ZP,{value:0,checked:t===0})})]},n.id)},Ze=function(n){var t=n.onChange,a=n.value,r=a===void 0?{}:a,s=(0,le.IE)(),o=s.schema,u=(0,p.useMemo)(function(){return Et(o)},[o]);(0,p.useEffect)(function(){if((0,gt.isEmpty)(r)&&u.length>0){var d={};u.forEach(function(v){return d[v.id]=2}),t&&t(d)}},[o,r,u,t]);var l=function(v){t&&t(u.reduce(function(h,m){return h[m.id]=v,h},{}))};return o?(0,e.jsx)("div",{children:(0,e.jsxs)("table",{className:"field-permission-table",children:[(0,e.jsx)("thead",{children:(0,e.jsxs)("tr",{children:[(0,e.jsx)("th",{style:{width:"64%"},children:"\u5B57\u6BB5\u540D"}),(0,e.jsx)("th",{style:{width:"12%"},children:"\u53EF\u7F16\u8F91"}),(0,e.jsx)("th",{style:{width:"12%"},children:"\u4EC5\u53EF\u89C1"}),(0,e.jsx)("th",{style:{width:"12%"},children:"\u9690\u85CF"})]})}),(0,e.jsx)("tbody",{children:u.map(function(d){return(0,p.createElement)(gn,(0,S.Z)((0,S.Z)({},d),{},{value:r[d.id],onChange:function(h){t&&t((0,S.Z)((0,S.Z)({},r),{},(0,fn.Z)({},d.id,h)))},key:d.id}))})}),(0,e.jsx)("tfoot",{children:(0,e.jsxs)("tr",{children:[(0,e.jsx)("td",{}),(0,e.jsx)("td",{children:(0,e.jsx)(T.Z,{size:"small",type:"link",onClick:function(){return l(2)},children:"\u5168\u9009"})}),(0,e.jsx)("td",{children:(0,e.jsx)(T.Z,{size:"small",type:"link",onClick:function(){return l(1)},children:"\u5168\u9009"})}),(0,e.jsx)("td",{children:(0,e.jsx)(T.Z,{size:"small",type:"link",onClick:function(){return l(0)},children:"\u5168\u9009"})})]})})]})}):(0,e.jsx)("div",{children:(0,e.jsx)(xt.Z,{image:xt.Z.PRESENTED_IMAGE_SIMPLE,description:"\u95EE\u5377\u4E3A\u7A7A"})})},Ni=c(20136),yt=c(55241),Zi=c(94233),Me=c(51890),re=c(68489),jt=c(49101),Mi=c(22385),Te=c(31097),En=c(43061),Pe=function(n){var t=n.title,a=n.onClose,r=(0,p.useState)(!1),s=(0,b.Z)(r,2),o=s[0],u=s[1];return(0,e.jsx)(Te.Z,{title:t,children:(0,e.jsxs)("div",{style:{position:"relative"},onMouseOver:function(){return u(!0)},onMouseLeave:function(){return u(!1)},children:[n.children,(0,e.jsx)(En.Z,{onClick:function(){a&&a()},style:{color:"#f5222d",cursor:"pointer",visibility:o?"visible":"hidden",position:"absolute",right:0,top:0,transform:"translate(25%, -25%)",transformOrigin:"100% 0%"}})]})})},Ti=c(71153),Oe=c(60331),Pi=c(13062),ce=c(71230),Oi=c(48736),Ct=c(27049),Ii=c(89032),J=c(15746),Li=c(62999),Ft=c(51753),yn=c(60780),jn=c.n(yn),Cn=I.Z.Option,Fn=(0,C.Pi)(function(i){var n=i.onChange,t=i.orgTreeData,a=i.positions,r=(0,p.useState)(),s=(0,b.Z)(r,2),o=s[0],u=s[1],l=(0,p.useState)(),d=(0,b.Z)(l,2),v=d[0],h=d[1];return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(ce.Z,{gutter:10,children:[(0,e.jsx)(J.Z,{span:16,children:(0,e.jsx)(Ft.Z,{onChange:function(B){return u(B)},style:{width:"100%"},dropdownStyle:{maxHeight:400,overflow:"auto"},treeData:[{title:"\u53D1\u8D77\u4EBA\u5F53\u524D\u90E8\u95E8",value:"${currentDeptId}",key:"${currentDeptId}"},{title:"\u53D1\u8D77\u4EBA\u4E0A\u7EA7\u90E8\u95E8",value:"${parentDeptId}",key:"${parentDeptId}"}].concat((0,k.Z)(t)),placeholder:"\u8BF7\u9009\u62E9\u673A\u6784",treeDefaultExpandAll:!0,allowClear:!0,value:o})}),(0,e.jsx)(J.Z,{span:8,children:(0,e.jsx)(I.Z,{style:{width:"100%"},placeholder:"\u8BF7\u9009\u62E9\u5C97\u4F4D",allowClear:!0,value:v,onChange:function(B){return h(B)},children:a.map(function(m){return(0,e.jsx)(Cn,{value:m.id,children:m.name},m.id)})})})]}),(0,e.jsx)(ce.Z,{style:{marginTop:10},children:(0,e.jsx)(J.Z,{children:(0,e.jsx)(T.Z,{icon:(0,e.jsx)(jt.Z,{}),onClick:function(){(o||v)&&n("P:".concat(o||"",":").concat(v||""))},children:"\u6DFB\u52A0"})})})]})}),Ie=Y.Z.TabPane,Bt=I.Z.Option,Bn=(0,C.Pi)(function(i){var n=i.value,t=n===void 0?[]:n,a=i.onChange,r=(0,re.m2)(),s=(0,re.LF)(t),o=r.depts,u=r.users,l=r.roles,d=r.positions,v=(0,p.useState)(),h=(0,b.Z)(v,2),m=h[0],B=h[1];(0,p.useEffect)(function(){m&&r.loadUsers({deptId:m,pageSize:1024})},[m,r]);var P=(0,p.useMemo)(function(){return jn()(o.map(function(f){return{value:f.id,title:f.name,key:f.id,parentId:f.parentId}}),{parentProperty:"parentId",customID:"value"})},[o]),D=function(E){var g=(0,k.Z)(t);E.forEach(function(x){g.includes(x)||g.push(x)}),a(g)},j=function(){for(var E=arguments.length,g=new Array(E),x=0;x<E;x++)g[x]=arguments[x];a((0,k.Z)(t.filter(function(w){return!g.includes(w)})))};return(0,e.jsx)("div",{style:{width:400},children:(0,e.jsxs)(Y.Z,{defaultActiveKey:"1",children:[(0,e.jsx)(Ie,{tab:"\u6210\u5458",children:(0,e.jsxs)("div",{style:{height:400,overflowY:"auto",overflowX:"hidden"},children:[(0,e.jsxs)(ce.Z,{gutter:20,children:[(0,e.jsx)(J.Z,{span:16,children:(0,e.jsx)(Ft.Z,{onChange:function(E){return B(E)},style:{width:"100%"},dropdownStyle:{maxHeight:400,overflow:"auto"},treeData:P,placeholder:"\u8BF7\u9009\u62E9\u673A\u6784",treeDefaultExpandAll:!0,allowClear:!0})}),(0,e.jsx)(J.Z,{span:8,children:(0,e.jsx)(I.Z,{style:{width:"100%"},placeholder:"\u8BF7\u9009\u62E9\u6210\u5458",allowClear:!0,showSearch:!0,mode:"multiple",onChange:function(E){return D(E)},maxTagCount:0,value:t.filter(function(f){return f.startsWith("U:")}),dropdownRender:function(E){return(0,e.jsxs)("div",{children:[E,(0,e.jsx)(Ct.Z,{style:{margin:"4px 0"}}),(0,e.jsx)("div",{style:{display:"flex",flexWrap:"nowrap",padding:8},children:(0,e.jsx)(T.Z,{size:"small",type:"link",onClick:function(){return D(u.map(function(x){return"U:".concat(x.id)}))},children:"\u5168\u9009"})})]})},children:u.map(function(f){return(0,e.jsx)(Bt,{value:"U:".concat(f.id),children:f.name},f.id)})})})]}),(0,e.jsx)(R.Z,{style:{marginTop:20},wrap:!0,children:t.filter(function(f){return f.startsWith("U:")}).map(function(f){return(0,e.jsx)(Oe.Z,{closable:!0,color:"blue",onClose:function(){return j(f)},children:s.user[f.split(":")[1]]},f)})})]})},"fieldPermission"),(0,e.jsx)(Ie,{tab:"\u89D2\u8272",children:(0,e.jsxs)("div",{style:{height:400,overflowY:"auto",overflowX:"hidden"},children:[(0,e.jsx)(I.Z,{style:{width:"100%"},placeholder:"\u8BF7\u9009\u62E9\u89D2\u8272",allowClear:!0,showSearch:!0,mode:"multiple",value:t.filter(function(f){return f.startsWith("R:")}),onChange:function(E){return D(E)},maxTagCount:0,children:l.map(function(f){return(0,e.jsx)(Bt,{value:"R:".concat(f.id),children:f.name},f.id)})}),(0,e.jsx)(R.Z,{style:{marginTop:20},wrap:!0,children:t.filter(function(f){return f.startsWith("R:")}).map(function(f){return(0,e.jsx)(Oe.Z,{closable:!0,color:"blue",onClose:function(){return j(f)},children:s.role[f.split(":")[1]]},f)})})]})},"basicSetting"),(0,e.jsx)(Ie,{tab:"\u673A\u6784\u5C97\u4F4D",children:(0,e.jsxs)("div",{style:{height:400,overflowY:"auto",overflowX:"hidden"},children:[(0,e.jsx)(Fn,{positions:d,orgTreeData:P,onChange:function(E){return D([E])}}),(0,e.jsx)(R.Z,{style:{marginTop:20},wrap:!0,children:t.filter(function(f){return f.startsWith("P:")}).map(function(f){var E=f.split(":"),g=(0,b.Z)(E,3),x=g[1],w=g[2];return(0,e.jsxs)(Oe.Z,{closable:!0,color:"blue",onClose:function(){return j(f)},children:[s.org[x],"-",s.position[w]]},x+":"+w)})})]})},"advanceSetting")]})})}),wn=c(55686),ve=(0,re.Gr)(function(i){var n=i.value,t=n===void 0?[]:n,a=i.onChange,r=(0,re.LF)(t),s=(0,re.m2)(),o=s.users,u=function(){for(var d=arguments.length,v=new Array(d),h=0;h<d;h++)v[h]=arguments[h];a((0,k.Z)(t.filter(function(m){return!v.includes(m)})))};return(0,e.jsx)("div",{style:{lineHeight:"36px",paddingTop:10},children:(0,e.jsxs)(R.Z,{wrap:!0,children:[(0,e.jsx)(yt.Z,{content:(0,e.jsx)(Bn,{onChange:a,value:t}),trigger:"click",placement:"leftTop",children:(0,e.jsx)(Me.C,{className:"add-user",icon:(0,e.jsx)(jt.Z,{}),size:24})}),t.map(function(l){var d=l.split(":"),v=(0,b.Z)(d,3),h=v[0],m=v[1],B=v[2];if(h=="U"){var P=o.find(function(D){return D.id===m});return(0,e.jsx)(Pe,{title:r.user[m],onClose:function(){return u(l)},children:(0,e.jsx)(wn.Z,{user:{avatar:P==null?void 0:P.avatar},style:{backgroundColor:"#87d068"},size:24})},m)}else return h==="R"?(0,e.jsx)(Pe,{title:r.role[m],onClose:function(){return u(l)},children:(0,e.jsx)(Me.C,{style:{backgroundColor:"#40a9ff"},size:24,children:"R"})},m):h==="P"?(0,e.jsx)(Pe,{title:"".concat(r.org[m],"-").concat(r.position[B]),onClose:function(){return u(l)},children:(0,e.jsx)(Me.C,{style:{backgroundColor:"#f56a00"},size:24,children:"P"})},"".concat(m,"-").concat(B)):(0,e.jsx)(e.Fragment,{})})]})})},{name:"identity"}),Ri=null,ki=c(47673),ge=c(4107),Ui=c(77576),wt=c(12028),Dn=c(2603),An=c(11075),bn=c(13105),Sn=c(3157),Nn=c(65602),Zn=c(89792),Mn=c(15360),ae=(0,re.Gr)(function(i){var n=i.value,t=i.onChange,a=i.initialValue;return(0,e.jsx)(wt.Z,{checkedChildren:"\u5F00\u542F",unCheckedChildren:"\u5173\u95ED",defaultChecked:!!a,checked:n,onChange:function(s){return t(s)}})}),Tn=(0,re.Gr)(function(i){var n=i.value,t=i.onChange;return(0,e.jsx)(ge.Z,{value:n,onChange:t})}),Le=(0,C.Pi)(function(i){var n=i.settings;return(0,e.jsxs)(C.Wo,{name:"setting",children:[n.includes("passwordRequired")&&(0,e.jsxs)("div",{className:"basic-setting",children:[(0,e.jsx)(Dn.Z,{className:"setting-icon"}),(0,e.jsxs)("div",{className:"setting-area",children:[(0,e.jsxs)("div",{className:"setting-title",children:[(0,e.jsx)("span",{children:"\u586B\u5199\u5BC6\u7801"}),(0,e.jsx)(ae,{name:"passwordRequired",initialValue:!0})]}),(0,e.jsx)("div",{className:"setting-hint",children:"\u51ED\u5BC6\u7801\u624D\u80FD\u586B\u5199\u8868\u5355"}),(0,e.jsx)("div",{className:"setting-content",children:(0,e.jsx)(Tn,{name:"password",syncDisplay:"passwordRequired"})})]})]}),n.includes("allowWithdrawStarter")&&(0,e.jsxs)("div",{className:"basic-setting",children:[(0,e.jsx)(An.Z,{className:"setting-icon"}),(0,e.jsxs)("div",{className:"setting-area",children:[(0,e.jsxs)("div",{className:"setting-title",children:[(0,e.jsx)("span",{children:"\u5141\u8BB8\u64A4\u56DE"}),(0,e.jsx)(ae,{name:"allowWithdraw",initialValue:!0})]}),(0,e.jsx)("div",{className:"setting-hint",children:"\u5141\u8BB8\u7533\u8BF7\u4EBA\u5BF9\u672A\u8FDB\u5165\u6D41\u7A0B\uFF08\u7B2C\u4E00\u4E2A\u6D41\u7A0B\u8282\u70B9\u4E3A\u5F85\u5904\u7406\u72B6\u6001\uFF09\u7684\u7533\u8BF7\u8FDB\u884C\u64A4\u56DE"})]})]}),n.includes("flowLogVisible")&&(0,e.jsxs)("div",{className:"basic-setting",children:[(0,e.jsx)(bn.Z,{className:"setting-icon"}),(0,e.jsxs)("div",{className:"setting-area",children:[(0,e.jsxs)("div",{className:"setting-title",children:[(0,e.jsx)("span",{children:"\u6D41\u7A0B\u65E5\u5FD7"}),(0,e.jsx)(ae,{name:"flowLogVisible",initialValue:!0})]}),(0,e.jsx)("div",{className:"setting-hint",children:"\u5141\u8BB8\u67E5\u770B\u6D41\u7A0B\u65E5\u5FD7"})]})]}),n.includes("allowAssignee")&&(0,e.jsxs)("div",{className:"basic-setting",children:[(0,e.jsx)(Sn.Z,{className:"setting-icon"}),(0,e.jsxs)("div",{className:"setting-area",children:[(0,e.jsxs)("div",{className:"setting-title",children:[(0,e.jsx)("span",{children:"\u4EE3\u529E\u8F6C\u4EA4"}),(0,e.jsx)(ae,{name:"allowAssignee",initialValue:!0})]}),(0,e.jsx)("div",{className:"setting-hint",children:"\u8282\u70B9\u8D1F\u8D23\u4EBA\u53EF\u5C06\u5F85\u529E\u4E8B\u9879\u8F6C\u4EA4\u7ED9\u5176\u4ED6\u6210\u5458\u5904\u7406"}),(0,e.jsx)("div",{className:"setting-content",children:(0,e.jsx)(ve,{name:"assignee",syncDisplay:"allowAssignee"})})]})]}),n.includes("allowWithdrawUser")&&(0,e.jsxs)("div",{className:"basic-setting",children:[(0,e.jsx)(Nn.Z,{className:"setting-icon"}),(0,e.jsxs)("div",{className:"setting-area",children:[(0,e.jsxs)("div",{className:"setting-title",children:[(0,e.jsx)("span",{children:"\u6D41\u7A0B\u64A4\u56DE"}),(0,e.jsx)(ae,{name:"allowWithdraw",initialValue:!0})]}),(0,e.jsx)("div",{className:"setting-hint",children:"\u8282\u70B9\u8D1F\u8D23\u4EBA\u53EF\u5BF9\u5DF2\u5904\u7406\u8FC7\u7684\u5F85\u529E\u6570\u636E\u8FDB\u884C\u64A4\u56DE"})]})]}),n.includes("allowGoBack")&&(0,e.jsxs)("div",{className:"basic-setting",children:[(0,e.jsx)(Zn.Z,{className:"setting-icon"}),(0,e.jsxs)("div",{className:"setting-area",children:[(0,e.jsxs)("div",{className:"setting-title",children:[(0,e.jsx)("span",{children:"\u6D41\u7A0B\u56DE\u9000"}),(0,e.jsx)(ae,{name:"allowGoBack",initialValue:!0})]}),(0,e.jsx)("div",{className:"setting-hint",children:"\u8282\u70B9\u8D1F\u8D23\u4EBA\u53EF\u5C06\u6D41\u7A0B\u56DE\u9000\u5230\u4E4B\u524D\u7684\u8282\u70B9\uFF0C\u4EC5\u5BA1\u6279\u8282\u70B9\u53EF\u7528"})]})]}),n.includes("allowFinishFlow")&&(0,e.jsxs)("div",{className:"basic-setting",children:[(0,e.jsx)(Mn.Z,{className:"setting-icon"}),(0,e.jsxs)("div",{className:"setting-area",children:[(0,e.jsxs)("div",{className:"setting-title",children:[(0,e.jsx)("span",{children:"\u6D41\u7A0B\u62D2\u7EDD"}),(0,e.jsx)(ae,{name:"allowFinishFlow",initialValue:!0})]}),(0,e.jsx)("div",{className:"setting-hint",children:"\u8282\u70B9\u8D1F\u8D23\u4EBA\u53EF\u4EE5\u62D2\u7EDD\u8BE5\u6D41\u7A0B\uFF08\u62D2\u7EDD\u540E\u6D41\u7A0B\u76F4\u63A5\u7ED3\u675F\uFF0C\u6807\u8BB0\u4E3A\u5DF2\u62D2\u7EDD\uFF09"})]})]})]})}),Pn=c(54977),On=function(n){var t=n.value,a=n.onChange,r=(0,p.useState)(!1),s=(0,b.Z)(r,2),o=s[0],u=s[1],l=(0,p.useRef)(null),d=function(h){a&&a(h)};return(0,p.useEffect)(function(){if(o){var v;(v=l.current)===null||v===void 0||v.focus()}},[o]),o?(0,e.jsx)(ge.Z,{ref:l,value:t,onChange:function(h){return d(h.target.value)},onKeyUp:function(h){h.key==="Enter"&&u(!1)},onBlur:function(h){d(h.target.value),u(!1)}}):(0,e.jsxs)("div",{style:{cursor:"pointer"},className:"title",onClick:function(){return u(!0)},children:[(0,e.jsx)("span",{children:t||"\u70B9\u51FB\u8BBE\u7F6E\u540D\u79F0"}),(0,e.jsx)(Pn.Z,{style:{marginLeft:10}})]})},K=c(90586),Dt=I.Z.Option,Re=Y.Z.TabPane,In=(0,C.Pi)(function(){var i=(0,le.IE)(),n=(0,p.useContext)(te),t=n.active,a=n.flow,r=(0,C.cI)(),s=r.query("".concat(i.id,".identity")).get("value"),o=(0,p.useState)(s?"assign":"all"),u=(0,b.Z)(o,2),l=u[0],d=u[1];return(0,p.useEffect)(function(){var v=l==="all"?"none":"visible",h=r.query("".concat(i.id,".identity")).take();h&&h.setDisplay(v)},[l]),(0,p.useEffect)(function(){a==null||a.setProperties(t.id,{candidateStarterUsers:s?s.filter(function(v){return v.startsWith("U:")}).join(","):void 0,candidateStarterGroups:s?s.map(function(v){return!v.startsWith("U:")}).join(","):void 0})},[s]),(0,e.jsxs)(C.Wo,{name:i.id,children:[(0,e.jsx)(C.gN,{name:"id",value:i.id}),(0,e.jsx)(C.gN,{name:"flowType",value:"process"}),(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{style:{lineHeight:"40px",fontWeight:"bold"},children:"\u7533\u8BF7\u4EBA"}),(0,e.jsx)("div",{children:(0,e.jsxs)(I.Z,{style:{width:200},onChange:function(h){return d(h)},value:l,children:[(0,e.jsx)(Dt,{value:"all",children:"\u6240\u6709\u4EBA\u53EF\u586B"}),(0,e.jsx)(Dt,{value:"assign",children:"\u6307\u5B9A\u6210\u5458\u53EF\u586B"})]})}),l==="assign"&&(0,e.jsx)(ve,{}),(0,e.jsxs)(Y.Z,{defaultActiveKey:"1",children:[(0,e.jsx)(Re,{tab:"\u5B57\u6BB5\u8BBE\u7F6E",children:(0,e.jsx)(K.Z,{name:"fieldPermission",children:(0,e.jsx)(Ze,{})})},"fieldPermission"),(0,e.jsx)(Re,{tab:"\u57FA\u7840\u8BBE\u7F6E",children:(0,e.jsx)(Le,{settings:["passwordRequired","flowLogVisible","allowWithdrawStarter"]})},"basicSetting"),(0,e.jsx)(Re,{tab:"\u9AD8\u7EA7\u8BBE\u7F6E",children:"\u9AD8\u7EA7\u8BBE\u7F6E"},"advanceSetting")]})]})]})});ue("Process",In);var Ln=(0,C.Pi)(function(){var i,n=(0,p.useContext)(te),t=n.flow,a=n.active,r=function(o){t==null||t.updateText(a.id,o)};return(0,e.jsxs)(C.Wo,{name:a.id,children:[(0,e.jsx)(C.gN,{name:"id",value:a.id}),(0,e.jsxs)("div",{children:[(0,e.jsx)(ce.Z,{gutter:[10,10],children:(0,e.jsxs)(J.Z,{span:12,children:[(0,e.jsx)("div",{style:{lineHeight:"40px",fontWeight:"bold"},children:"\u670D\u52A1\u540D\u79F0"}),(0,e.jsx)("div",{children:(0,e.jsx)(ge.Z,{placeholder:"\u8BBE\u7F6E\u540D\u79F0",onChange:function(o){return r(o.target.value)},defaultValue:(i=a.text)===null||i===void 0?void 0:i.value})})]})}),(0,e.jsx)("div",{style:{lineHeight:"40px",fontWeight:"bold"},children:"\u6761\u4EF6\u516C\u5F0F"})]})]})});ue("StartEvent",Ln);var At=c(1870),bt=I.Z.Option,ke=Y.Z.TabPane,Rn=(0,C.Pi)(function(){var i=(0,p.useContext)(te),n=i.flow,t=i.active,a=(0,C.cI)(),r=a.query("".concat(t.id,".setting.isSequential")).get("value"),s=a.query("".concat(t.id,".identity")).get("value"),o=a.query("".concat(t.id,".setting.approveType")).get("value");return(0,p.useEffect)(function(){if((s==null?void 0:s.length)===1&&s[0].startsWith("U:")){n==null||n.setProperties(t.id,{"flowable:assignee":s[0].replace("U:",""),"flowable:candidateUsers":null,"flowable:candidateGroups":null,multiInstanceLoopCharacteristics:null});return}if(s&&r===1&&o===1){s.every(function(u){return u.startsWith("U:")})?n==null||n.setProperties(t.id,{"flowable:assignee":null,"flowable:candidateUsers":s==null?void 0:s.filter(function(u){return u.startsWith("U:")}).map(function(u){return u.replace("U:","")}).join(","),"flowable:candidateGroups":null,multiInstanceLoopCharacteristics:null}):n==null||n.setProperties(t.id,{"flowable:assignee":null,"flowable:candidateUsers":"${t.getUsers('".concat(t.id,"', starterUserId)}"),"flowable:candidateGroups":null,multiInstanceLoopCharacteristics:null});return}n==null||n.setProperties(t.id,{"flowable:assignee":"${t.getAssignee(user)}","flowable:candidateGroups":"${t.getCandidateGroups(user)}",multiInstanceLoopCharacteristics:{isSequential:r===1?"false":"true","flowable:collection":"${t.getUser(execution)}","flowable:elementVariable":"user",completionCondition:"${t.isComplete(execution) }"}})},[r,s,o]),(0,e.jsxs)(C.Wo,{name:t.id,children:[(0,e.jsx)(C.gN,{name:"id",value:t.id}),(0,e.jsx)(C.gN,{name:"flowType",value:"userTask"}),(0,e.jsxs)("div",{children:[(0,e.jsxs)(ce.Z,{gutter:[10,10],children:[(0,e.jsxs)(J.Z,{span:12,children:[(0,e.jsx)("div",{style:{lineHeight:"40px",fontWeight:"bold"},children:"\u8D1F\u8D23\u4EBA"}),(0,e.jsx)("div",{children:(0,e.jsx)(C.Wo,{name:"setting",children:(0,e.jsx)(K.Z,{name:"isSequential",initialValue:1,children:(0,e.jsxs)(I.Z,{style:{width:"100%"},children:[(0,e.jsx)(I.Z.Option,{value:1,children:"\u5E38\u89C4\u5BA1\u6279"}),(0,e.jsx)(I.Z.Option,{value:2,children:"\u9010\u7EA7\u5BA1\u6279"})]})})})})]}),r===1&&(0,e.jsxs)(J.Z,{span:12,children:[(0,e.jsxs)("div",{style:{lineHeight:"40px",fontWeight:"bold"},children:["\u5BA1\u6279\u7C7B\u578B",(0,e.jsx)(Te.Z,{title:"\u8D1F\u8D23\u4EBA\u4E3A\u591A\u4EBA\u65F6\u7684\u5BA1\u6279\u65B9\u5F0F",children:(0,e.jsx)(At.Z,{style:{marginLeft:5,color:"rgba(43,52,65,.4)",cursor:"pointer"}})})]}),(0,e.jsx)("div",{children:(0,e.jsx)(C.Wo,{name:"setting",children:(0,e.jsx)(K.Z,{name:"approveType",initialValue:1,syncDisplay:{isSequential:[1]},children:(0,e.jsxs)(I.Z,{style:{width:"100%"},children:[(0,e.jsx)(bt,{value:1,children:"\u6216\u7B7E(\u4E00\u540D\u8D1F\u8D23\u4EBA\u901A\u8FC7\u6216\u8005\u62D2\u7EDD\u5373\u53EF)"}),(0,e.jsx)(bt,{value:2,children:"\u4F1A\u7B7E(\u9700\u6240\u6709\u8D1F\u8D23\u4EBA\u901A\u8FC7)"})]})})})})]}),(0,e.jsx)(J.Z,{span:24,children:(0,e.jsx)(ve,{})})]}),(0,e.jsxs)(Y.Z,{defaultActiveKey:"1",children:[(0,e.jsx)(ke,{tab:"\u5B57\u6BB5\u8BBE\u7F6E",children:(0,e.jsx)(K.Z,{name:"fieldPermission",children:(0,e.jsx)(Ze,{})})},"fieldPermission"),(0,e.jsx)(ke,{tab:"\u57FA\u7840\u8BBE\u7F6E",children:(0,e.jsx)(Le,{settings:["allowAssignee","allowFinishFlow","allowGoBack","allowWithdrawStarter","flowLogVisible"]})},"basicSetting"),(0,e.jsx)(ke,{tab:"\u9AD8\u7EA7\u8BBE\u7F6E",children:"\u9AD8\u7EA7\u8BBE\u7F6E"},"advanceSetting")]})]})]})});ue("userTask",Rn);var kn=function(){return(0,e.jsx)("div",{})};ue("EndEvent",kn);var Vi=c(402),St=c(97272),Un=c(94184),Ee=c.n(Un),Wi=c(63138),zi=c(88386),Vn=(0,p.forwardRef)(function(i,n){var t=i.value,a=i.readOnly,r=i.placeholder,s=(0,p.useState)(),o=(0,b.Z)(s,2),u=o[0],l=o[1];(0,p.useEffect)(function(){u&&u.focus()},[u]),(0,p.useImperativeHandle)(n,function(){return{getValue:function(){return u.getValue()},focus:function(){u.focus()},getDoc:function(){return u.getDoc()}}});var d=(0,p.useMemo)(function(){return{mode:"text/x-spreadsheet",line:!0,lineWrapping:!0,readOnly:a,placeholder:r}},[a]),v=function(j,f,E,g,x){var w=j.getDoc(),A=document.createElement("span");A.innerText=g.title||g.path,A.className="formula-tag ".concat(x||"formula-tag-value"),w.markText(f,E,{replacedWith:A})},h=function D(j,f,E){var g=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[];(g||[]).forEach(function(x){for(var w="#{".concat(x.path,"}"),A=new RegExp(w,"g");A.exec(f)!==null;){var N={line:E,ch:A.lastIndex-w.length},Z={line:E,ch:A.lastIndex};v(j,N,Z,x)}for(w="#{_".concat(x.path,"}"),A=new RegExp(w,"g");A.exec(f)!==null;){var _={line:E,ch:A.lastIndex-w.length},fe={line:E,ch:A.lastIndex};v(j,_,fe,x,"formula-tag-text")}x.children&&x.children.length>0&&D(j,f,E,x.children)})},m=function(j,f){var E=f.split(`
`);E.forEach(function(g,x){return h(j,g,x,i.variable)})},B=function(j,f){l(j),t!=null&&t!==""&&m(j,f)},P=function(j,f,E){(E!=null||E!=="")&&m(j,E),i.onChange&&i.onChange(E)};return(0,e.jsx)("div",{className:Ee()("formula-editor-content",{readOnly:a}),children:(0,e.jsx)(pt.Rt,{autoCursor:!1,value:t,options:d,editorDidMount:B,onChange:P})})}),he=Vn,Gi=c(7359),Nt=c(27279),Wn=Nt.Z.Panel,zn=St.Z.Link;function Zt(i,n,t){if(i.popover){var a,r;return(0,e.jsx)(yt.Z,{content:(0,e.jsxs)("div",{className:"fn-popover-content",children:[(0,e.jsxs)("div",{className:"fn-popover-content-header",children:["\u516C\u5F0F\u7B80\u4ECB",(0,e.jsx)(zn,{href:i.popover.docHref,target:"_blank",children:"\u6587\u6863"})]}),(a=i.popover)===null||a===void 0?void 0:a.content]}),title:(r=i.popover)===null||r===void 0?void 0:r.title,placement:"right",className:"fn-popover",children:(0,e.jsxs)("div",{className:"function-item",onClick:function(){return t&&t(i.name)},children:[(0,e.jsx)("div",{className:"function-item__name",children:i.name}),(0,e.jsx)("div",{className:"function-item__desc",children:i.description})]})},n)}return(0,e.jsxs)("div",{className:"function-item",onClick:function(){return t&&t(i.name)},children:[(0,e.jsx)("div",{className:"function-item__name",children:i.name}),(0,e.jsx)("div",{className:"function-item__desc",children:i.description})]},n)}var Gn=function(n){var t=n.dataSource,a=t===void 0?[]:t,r=n.check,s="function-store";return(0,e.jsx)(Nt.Z,{className:s,bordered:!1,defaultActiveKey:[0],expandIconPosition:"right",ghost:!0,children:a.map(function(o,u){return(0,e.jsx)(Wn,{className:"".concat(s,"-group"),header:o.name,children:o.functions.map(function(l,d){return Zt(l,d,r)})},u)})})},Hn=Gn,Xn=function(i){return(0,e.jsx)("svg",(0,S.Z)((0,S.Z)({width:"1em",height:"1.2em",viewBox:"0 0 24 24"},i),{},{children:(0,e.jsx)("path",{d:"M12.42 5.29c-1.1-.1-2.07.71-2.17 1.82L10 10h2.82v2h-3l-.44 5.07A4.001 4.001 0 0 1 2 18.83l1.5-1.5c.33 1.05 1.46 1.64 2.5 1.3c.78-.24 1.33-.93 1.4-1.74L7.82 12h-3v-2H8l.27-3.07a4.01 4.01 0 0 1 4.33-3.65c1.26.11 2.4.81 3.06 1.89l-1.5 1.5c-.25-.77-.93-1.31-1.74-1.38M22 13.65l-1.41-1.41l-2.83 2.83l-2.83-2.83l-1.43 1.41l2.85 2.85l-2.85 2.81l1.43 1.41l2.83-2.83l2.83 2.83L22 19.31l-2.83-2.81L22 13.65z",fill:"currentColor"})}))},Kn=function(i){return(0,e.jsx)("svg",(0,S.Z)((0,S.Z)({width:"1em",height:"1em",viewBox:"0 0 16 16"},i),{},{children:(0,e.jsx)("g",{fill:"currentColor",children:(0,e.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 5h2V4H1.5l-.5.5v8l.5.5H4v-1H2V5zm12.5-1H12v1h2v7h-2v1h2.5l.5-.5v-8l-.5-.5zm-2.74 2.57L12 7v2.51l-.3.45l-4.5 2h-.46l-2.5-1.5l-.24-.43v-2.5l.3-.46l4.5-2h.46l2.5 1.5zM5 9.71l1.5.9V9.28L5 8.38v1.33zm.58-2.15l1.45.87l3.39-1.5l-1.45-.87l-3.39 1.5zm1.95 3.17l3.5-1.56v-1.4l-3.5 1.55v1.41z"})})}))},Hi=c(32157),$n=c(32138),Yn=c(57254),Jn=function(n){var t=n.id,a=n.type,r=n.title,s=n.pick,o=(0,p.useCallback)(function(){s&&s()},[]),u=(0,p.useMemo)(function(){return a==="SplitLine"},[]);return(0,e.jsx)("div",{className:Ee()("field-variable",{disabled:u}),onClick:o,children:r})},Qn=Jn;function Mt(i,n){return{title:(0,e.jsx)(Qn,{type:i.type,id:i.id,title:i.title,pick:function(){return n&&n(i)}}),key:i.id,children:(i.children||[]).map(function(t){return Mt(t,n)})}}var qn=function(n){var t=n.dataSource,a=n.pick,r=(0,p.useMemo)(function(){return t.map(function(s){return Mt(s,a)})},[]);return(0,e.jsx)($n.Z,{blockNode:!0,showLine:{showLeafIcon:!1},switcherIcon:(0,e.jsx)(Yn.Z,{}),className:"hide-file-icon",treeData:r,selectable:!1})},_n=qn,ei=c(76570),Xi=c(54421),Tt=c(38272),ti=function(n){var t=n.check,a=n.dataSource;return(0,e.jsx)(Tt.ZP,{bordered:!1,dataSource:a,className:"function-store-group",renderItem:function(s){return(0,e.jsx)(Tt.ZP.Item,{children:Zt(s,s.name,t)})}})},ni=ti,Pt=Y.Z.TabPane,ii=function(n){var t=n.variables,a=t===void 0?[]:t,r=n.insertFun,s=n.insertVariable,o=n.functionVisible,u=o===void 0?!0:o,l="formula-editor-toolbar",d=(0,p.useState)([]),v=(0,b.Z)(d,2),h=v[0],m=v[1],B=(0,p.useCallback)(function(D){return(0,e.jsxs)("span",{children:[D.icon?(0,e.jsx)("span",{role:"img",className:"anticon",children:D.icon}):null,D.name]})},[]),P=function(j){var f;if(!j){m([]);return}var E=new Set;m(((f=n.functions)===null||f===void 0?void 0:f.reduce(function(g,x){return g.push.apply(g,(0,k.Z)(x.functions.filter(function(w){return w.name.includes(j.toUpperCase())}))),g},[]).filter(function(g){return E.has(g.name)?!1:(E.add(g.name),!0)}))||[])};return(0,e.jsx)("div",{className:l,children:(0,e.jsxs)(Y.Z,{defaultActiveKey:u?"fx":"field",centered:u,children:[u&&(0,e.jsxs)(Pt,{tab:(0,e.jsx)(B,{name:"\u51FD\u6570",icon:(0,e.jsx)(Xn,{})}),children:[(0,e.jsx)(ge.Z,{placeholder:"\u641C\u7D22\u516C\u5F0F",prefix:(0,e.jsx)(ei.Z,{}),allowClear:!0,onChange:function(j){return P(j.target.value)}}),h.length>0&&(0,e.jsx)(ni,{dataSource:h,check:r}),h.length===0&&(0,e.jsx)(Hn,{dataSource:n.functions,check:r})]},"fx"),(0,e.jsx)(Pt,{tab:(0,e.jsx)(B,{name:"\u5B57\u6BB5",icon:(0,e.jsx)(Kn,{})}),children:(0,e.jsx)("div",{children:(0,e.jsx)(_n,{dataSource:a,pick:s})})},"field")]})})};function Ue(i){for(var n=arguments.length,t=new Array(n>1?n-1:0),a=1;a<n;a++)t[a-1]=arguments[a];return(0,e.jsxs)("div",{className:"fn-popover-title",children:[i,"(",t.map(function(r,s){return(0,e.jsxs)("span",{className:"fn-popover-arg",children:[r," ",s===t.length-1?"":","]},s)}),")"]})}var Ot="https://support.microsoft.com/zh-cn/office/",Ve=[{name:"\u903B\u8F91",functions:[{name:"IF",description:"\u6839\u636E\u5224\u65AD\u6761\u4EF6\uFF0C\u8FD4\u56DE\u6B63\u786E\u6216\u9519\u8BEF\u7684\u503C"},{name:"AND",description:"\u8FD4\u56DE\u903B\u8F91\u503C\uFF1A\u5982\u679C\u6240\u6709\u53C2\u6570\u503C\u5747\u4E3A\u903B\u8F91\u201Ctrue\u201D\uFF0C\u5219\u8FD4\u56DE\u903B\u8F91\u201Ctrue\u201D\uFF0C\u53CD\u4E4B\u8FD4\u56DE\u903B\u8F91\u201Cfalse",popover:{title:Ue("AND","logical1","logical2","..."),content:(0,e.jsxs)("div",{className:"fn-popover-content",children:["\u4EFB\u4F55\u4E00\u4E2A\u53C2\u6570\u7684\u903B\u8F91\u503C\u4E3Afalse\uFF0C\u5373\u8FD4\u56DE false\uFF1B",(0,e.jsx)("br",{})," \u53EA\u6709\u5F53\u6240\u6709\u53C2\u6570\u7684\u903B\u8F91\u503C\u4E3Atrue\uFF0C\u624D\u8FD4\u56DE true\u3002",(0,e.jsx)("br",{}),"logical:\u903B\u8F91\u503C\uFF0C\u4F8B\u5982\uFF0C2>1\u7684\u903B\u8F91\u503C\u4E3A true"]})}},{name:"OR",description:"\u4EFB\u4F55\u4E00\u4E2A\u53C2\u6570\u903B\u8F91\u503C\u4E3Atrue\uFF0C\u5373\u8FD4\u56DEtrue\uFF1B\u53EA\u6709\u5F53\u6240\u6709\u903B\u8F91\u53C2\u6570\u503C\u4E3Afalse\uFF0C\u624D\u8FD4\u56DEfalse"},{name:"XOR",description:"\u8FD4\u56DE\u6240\u6709\u53C2\u6570\u7684\u5F02\u6216\u503C"},{name:"NOT",description:"\u5BF9\u53C2\u6570\u903B\u8F91\u503C\u6C42\u53CD"}]},{name:"\u6587\u5B57",functions:[{name:"SUBSTITUTE",description:"\u5728\u6587\u672C\u5B57\u7B26\u4E32\u4E2D\u7528 new_text \u66FF\u6362 old_text",popover:{title:Ue("SUBSTITUTE","old_text","new_text","[instance_num]"),content:(0,e.jsxs)("div",{className:"fn-popover-content",children:["\u5728\u6587\u672C\u5B57\u7B26\u4E32\u4E2D\u7528 new_text \u66FF\u6362 old_text\u3002",(0,e.jsx)("br",{}),"\u5982\u679C\u9700\u8981\u5728\u67D0\u4E00\u6587\u672C\u5B57\u7B26\u4E32\u4E2D\u66FF\u6362\u6307\u5B9A\u7684\u6587\u672C\uFF0C\u8BF7\u4F7F\u7528\u51FD\u6570 SUBSTITUTE\uFF1B",(0,e.jsx)("br",{}),"\u5982\u679C\u9700\u8981\u5728\u67D0\u4E00\u6587\u672C\u5B57\u7B26\u4E32\u4E2D\u66FF\u6362\u7279\u5B9A\u4F4D\u7F6E\u5904\u7684\u4EFB\u610F\u6587\u672C\uFF0C\u8BF7\u4F7F\u7528\u51FD\u6570 REPLACE\u3002"]}),docHref:"".concat(Ot,"substitute-\u51FD\u6570-6434944e-a904-4336-a9b0-1e58df3bc332")}},{name:"CONCATENATE",description:"\u5C06\u591A\u4E2A\u6587\u5B57\u5408\u5E76"},{name:"LEFT",description:"\u4ECE\u5DE6\u8FB9\u622A\u53D6\u6307\u5B9A\u957F\u5EA6\u7684\u6587\u5B57"},{name:"RIGHT",description:"\u4ECE\u53F3\u8FB9\u8FB9\u622A\u53D6\u6307\u5B9A\u957F\u5EA6\u7684\u6587\u5B57"},{name:"MID",description:"\u622A\u53D6\u6307\u5B9A\u4F4D\u7F6E\u7684\u6587\u5B57"},{name:"REPLACE",description:"\u66FF\u6362\u6587\u672C\u4E2D\u7684\u6307\u5B9A\u6587\u5B57",popover:{title:Ue("REPLACE","old_text","start_num","num_chars","new_text"),content:(0,e.jsxs)("div",{className:"fn-popover-content",children:["\u6839\u636E\u6307\u5B9A\u7684\u5B57\u7B26\u6570\uFF0CREPLACE \u5C06\u90E8\u5206\u6587\u672C\u5B57\u7B26\u4E32\u66FF\u6362\u4E3A\u4E0D\u540C\u7684\u6587\u672C\u5B57\u7B26\u4E32\u3002",(0,e.jsx)("br",{}),"REPLACEB \u4F7F\u7528\u5176\u4ED6\u6587\u672C\u5B57\u7B26\u4E32\u5E76\u6839\u636E\u6240\u6307\u5B9A\u7684\u5B57\u8282\u6570\u66FF\u6362\u67D0\u6587\u672C\u5B57\u7B26\u4E32\u4E2D\u7684\u90E8\u5206\u6587\u672C\u3002"]}),docHref:"".concat(Ot,"replace-replaceb-\u51FD\u6570-8d799074-2425-4a8a-84bc-82472868878a")}},{name:"TRIM",description:"\u79FB\u9664\u6587\u5B57\u5934\u5C3E\u7684\u7A7A\u683C"},{name:"LEN",description:"\u540E\u53BB\u6587\u5B57\u7684\u957F\u5EA6"},{name:"LOWER",description:"\u8F6C\u6210\u5C0F\u5199\u6587\u5B57"},{name:"UPPER",description:"\u8F6C\u6210\u5927\u5199\u6587\u5B57"}]},{name:"\u6570\u5B57",functions:[{name:"AVERAGE",description:"\u8BA1\u7B97\u6240\u6709\u53C2\u4E0E\u8FD0\u7B97\u5B57\u6BB5\u7684\u5E73\u5747\u503C"},{name:"COUNT",description:"\u8FD4\u56DE\u6240\u6709\u53C2\u4E0E\u8FD0\u7B97\u5B57\u6BB5\u4E2D\u503C\u6570\u5B57\u7684\u6570\u91CF"},{name:"COUNTA",description:"\u8FD4\u56DE\u6240\u6709\u53C2\u4E0E\u8FD0\u7B97\u5B57\u6BB5\u4E2D\u503C\u4E0D\u4E3A\u7A7A\u7684\u6570\u91CF"},{name:"COUNTIF",description:"COUNTIF(\u8868\u683C[\u91D1\u989D], 100)\uFF0C\u53EF\u5F97\u5230\u8868\u683C\u4E2D\u91D1\u989D\u4E3A100\u7684\u6570\u636E\u6761\u6570"},{name:"MAX",description:"\u8FD4\u56DE\u6240\u6709\u53C2\u4E0E\u5B57\u6BB5\u4E2D\u7684\u6700\u5927\u503C"},{name:"MIN",description:"\u8FD4\u56DE\u6240\u6709\u53C2\u4E0E\u5B57\u6BB5\u4E2D\u7684\u6700\u5C0F\u503C"},{name:"ROUND",description:"\u5C06\u6570\u5B57\u56DB\u820D\u4E94\u5165\u5230\u6307\u5B9A\u7684\u4F4D\u6570"},{name:"INT",description:"\u5C06\u6570\u5B57\u5411\u4E0B\u53D6\u6574"},{name:"MOD",description:"\u8FD4\u56DE\u4E24\u6570\u76F8\u9664\u7684\u4F59\u6570"},{name:"PRODUCT",description:"\u8FD4\u56DE\u6240\u6709\u53C2\u4E0E\u5B57\u6BB5\u4E2D\u6570\u503C\u7684\u4E58\u79EF"},{name:"SUM",description:"\u8FD4\u56DE\u6240\u6709\u53C2\u4E0E\u5B57\u6BB5\u4E2D\u6570\u503C\u7684\u603B\u548C"},{name:"SUMPRODUCT",description:"\u8FD4\u56DE\u6240\u6709\u53C2\u4E0E\u5B57\u6BB5\u4E2D\u6570\u503C\u7684\u603B\u548C"},{name:"SUMIF",description:"\u7EDF\u8BA1\u8868\u683C\u4E2D\u7B26\u5408\u6761\u4EF6\u7684\u6570\u503C\uFF0C\u5E76\u6C42\u548C"},{name:"ROUNDUP",description:"\u5C06\u6570\u5B57\u4FDD\u7559\u6307\u5B9A\u7684\u4F4D\u6570\uFF0C\u6700\u540E\u4E00\u4F4D\u5411\u4E0A\u53D6"},{name:"ROUNDDOWN",description:"\u5C06\u6570\u5B57\u4FDD\u7559\u6307\u5B9A\u7684\u4F4D\u6570\uFF0C\u6700\u540E\u4E00\u4F4D\u5411\u4E0B\u53D6"},{name:"POWER",description:"\u8BA1\u7B97\u6570\u5B57num\u7684n\u6B21\u65B9\uFF0Cn\u53EF\u4EE5\u4E3A\u5206\u6570\u6216\u8005\u6574\u6570"},{name:"LN",description:"\u8BA1\u7B97\u6307\u5B9A\u6570\u5B57\u7684\u81EA\u7136\u5BF9\u6570"},{name:"SQRT",description:"\u8BA1\u7B97\u6307\u5B9A\u6570\u5B57\u7684\u5E73\u65B9\u6839"}]},{name:"\u65F6\u95F4",functions:[{name:"YEAR",description:"\u8FD4\u56DE\u65E5\u671F\u4E2D\u7684\u5E74\u4EFD"},{name:"MONTH",description:"\u8FD4\u56DE\u65E5\u671F\u4E2D\u7684\u6708\u4EFD"},{name:"DAY",description:"\u8FD4\u56DE\u65E5\u671F\u5728\u4E00\u4E2A\u6708\u4E2D\u7684\u7B2C\u51E0\u5929\u7684\u6570\u503C"},{name:"HOUR",description:"\u8FD4\u56DE\u65E5\u671F\u4E2D\u7684\u5C0F\u65F6\uFF0C\u65E5\u671F\u5B57\u6BB5\u5FC5\u987B\u7CBE\u786E\u5230\u65F6\u95F4\u624D\u53EF\u4EE5\u8BA1\u7B97\u51FA\u6765"},{name:"MINUTE",description:"\u8FD4\u56DE\u65E5\u671F\u4E2D\u7684\u5206\u949F\uFF0C\u65E5\u671F\u5B57\u6BB5\u5FC5\u987B\u7CBE\u786E\u5230\u65F6\u95F4\u624D\u53EF\u4EE5\u8BA1\u7B97\u51FA\u6765"},{name:"SECOND",description:"\u8FD4\u56DE\u65E5\u671F\u4E2D\u7684\u79D2\uFF0C\u65E5\u671F\u5B57\u6BB5\u5FC5\u987B\u7CBE\u786E\u5230\u65F6\u95F4\u624D\u53EF\u4EE5\u8BA1\u7B97\u51FA\u6765"},{name:"DATE",description:"\u5C06\u6570\u5B57\u62FC\u63A5\u6210\u4E3A\u5E74\u4EFD\uFF0C\u6570\u5B57\u5B57\u6BB5\u987A\u5E8F\u4E3A\uFF1A\u5E74\uFF0F\u6708\uFF0F\u65E5\uFF0F\u65F6\uFF0F\u5206\uFF0F\u79D2"},{name:"CURDATE",description:"\u8FD4\u56DE\u5F53\u524D\u65E5\u671F"},{name:"NOW",description:"\u8FD4\u56DE\u5F53\u524D\u65F6\u95F4\uFF0C\u7CBE\u786E\u5230\u65F6/\u5206/\u79D2"},{name:"DAYS",description:"\u8FD4\u56DE\u65E5\u671F\u5B57\u6BB51\u4E0E\u65E5\u671F\u5B57\u6BB52\u7684\u5DEE\u503C\uFF0C\u5355\u4F4D\u4E3A\u5929"},{name:"DATEDELTA",description:"\u5C06\u6307\u5B9A\u65E5\u671F\u52A0/\u51CF\u6307\u5B9A\u5929\u6570\uFF0C\u5E76\u8FD4\u56DE\u76EE\u6807\u65E5\u671F"}]}];function ri(i){if(i){var n=Ve.map(function(a){return a.functions}).reduce(function(a,r){return a.concat(r)},[]),t=i.map(function(a){return n.find(function(r){return r.name===a})});return[{name:"\u5E38\u7528",functions:t}].concat(Ve)}return Ve}function ai(i){return!!(i==="SplitLine"||i==="Pagination"||i==="Remark"||i==="Signature"||i==="Upload"||i&&i.startsWith("Matrix"))}function si(i){return!!["Dept","FillBlank","User","Score","Textarea"].includes(i)}var Ki=function i(n){var t;(t=n.children)===null||t===void 0||t.forEach(function(a){a.parent=n,i(a)})},We=function i(n,t,a){var r;if(!n)return[];var s=!1;return((r=n.children)===null||r===void 0?void 0:r.filter(function(o){return o===t&&!a?(s=!0,!1):!ai(o.type)&&!s}).map(function(o){var u,l=o.id,d=o.title,v=o.type,h=o.type===void 0?"".concat((u=o.parent)===null||u===void 0?void 0:u.id,".").concat(l):l;return si(o.type)?{id:l,path:h,title:(0,Ne.WO)(d),type:v}:{id:l,path:h,title:(0,Ne.WO)(d),type:v,children:i(o,t,a)}}))||[]},oi=St.Z.Link,ui=function(n){var t=n.title,a=n.subTitle,r=n.helpLink,s=n.onOk,o=n.value,u=n.className,l=n.onCancel,d=n.fieldAll,v=n.visible,h=v===void 0?!0:v,m=n.schema,B=n.current,P=n.functions,D=n.functionVisible,j=(0,p.useRef)(null),f="formula-editor",E=(0,p.useRef)(""),g=(0,p.useCallback)(function(A){if(j.current!=null){var N=j.current.getDoc(),Z=N.getCursor();N.replaceRange("".concat(A,"()"),Z),Z.ch+=A.length+1,N.setCursor(Z),j.current.focus()}},[j.current]),x=(0,p.useCallback)(function(A){if(j.current!=null){var N=j.current.getDoc(),Z=N.getCursor();N.replaceRange("#{".concat(E.current).concat(A.path,"}"),Z,Z),j.current.focus()}},[j.current]),w=(0,p.useMemo)(function(){return We(m,B,d)},[m,B,d]);return(0,e.jsx)(se.Z,{onCancel:l,visible:h,maskClosable:!1,getContainer:n.getContainer,title:t,width:1e3,footer:!1,onOk:function(N){N.stopPropagation(),s(j.current.getValue())},keyboard:!1,children:(0,e.jsxs)("div",{className:Ee()(f,u),children:[(0,e.jsx)(ii,{functionVisible:D,functions:P||ri(n.commonUseFunctionNames),variables:w,insertFun:g,insertVariable:x}),(0,e.jsxs)("div",{className:"".concat(f,"-main"),children:[(0,e.jsxs)("div",{className:"".concat(f,"-main__code"),children:[(0,e.jsxs)("h1",{children:[(0,e.jsxs)("span",{className:"equle",children:[a,"="]}),(0,e.jsxs)("span",{style:{float:"right"},children:[(0,e.jsx)(Te.Z,{title:"\u903B\u8F91\u8868\u793A\u4F7F\u7528\u5177\u4F53\u503C\u53C2\u4E0E\u903B\u8F91\u8BA1\u7B97\uFF0C\u5982\u5355\u9009\u9898\u9009\u4E2D\u4E3A true;\u6587\u672C\u8868\u793A\u4F7F\u7528\u6807\u9898\u53C2\u4E0E\u6587\u672C\u8BA1\u7B97\uFF0C\u5982\u5355\u9009\u9898\u9009\u4E2D\u9009\u9879\u7684\u6587\u672C\u3002",children:(0,e.jsx)(At.Z,{style:{fontSize:16,marginRight:10}})}),(0,e.jsx)(wt.Z,{checkedChildren:"\u903B\u8F91",defaultChecked:!0,unCheckedChildren:"\u6587\u672C",onChange:function(N){N?E.current="":E.current="_"}})]})]}),(0,e.jsx)("div",{style:{fontSize:14,color:"#b0b0b9"},children:"\u5728\u5DE6\u4FA7\u9009\u62E9\u51FD\u6570\u6216\u5B57\u6BB5\u53D8\u91CF\uFF0C\u4E14\u5728\u82F1\u6587\u8F93\u5165\u6CD5\u4E0B\u7F16\u8F91"})]}),(0,e.jsx)("div",{className:"".concat(f,"-main__panel"),children:(0,e.jsx)(he,{ref:j,variable:w,value:o})}),(0,e.jsxs)("div",{className:"".concat(f,"-main__footer"),children:[(0,e.jsxs)(R.Z,{children:[(0,e.jsx)("span",{children:r}),(0,e.jsx)(oi,{href:"https://support.microsoft.com/zh-cn/office/excel-%E5%87%BD%E6%95%B0-%E6%8C%89%E7%B1%BB%E5%88%AB%E5%88%97%E5%87%BA-5f91f4e9-7b42-46d2-9bd1-63f26a86c0eb",target:"_blank",children:"\u516C\u5F0F\u6587\u6863"})]}),(0,e.jsxs)(R.Z,{children:[(0,e.jsx)(T.Z,{onClick:function(){l&&l()},children:"\u53D6\u6D88"}),(0,e.jsx)(T.Z,{type:"primary",onClick:function(N){N.stopPropagation(),s(j.current.getValue())},children:"\u786E\u5B9A"})]})]})]})]})})},ye=ui,li=(0,C.Pi)(function(){var i=(0,p.useContext)(te),n=i.flow,t=i.active,a=(0,C.cI)(),r=(0,le.IE)(),s=r.schema,o=(0,p.useState)(!1),u=(0,b.Z)(o,2),l=u[0],d=u[1],v=(0,p.useMemo)(function(){return We(r.schema)},[r]),h=a.query("".concat(t.id,".expression")).get("value");return(0,p.useEffect)(function(){n==null||n.setProperties(t.id,{conditionExpression:{"xsi:type":"tFormalExpression","#text":"${t.condition(execution)}"}})},[h]),(0,e.jsxs)(C.Wo,{name:t.id,children:[(0,e.jsx)(C.gN,{name:"id",value:t.id}),(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{style:{lineHeight:"40px",fontWeight:"bold"},children:["\u6761\u4EF6\u516C\u5F0F",(0,e.jsx)(T.Z,{type:"link",onClick:function(){return d(!0)},children:"\u70B9\u51FB\u8BBE\u7F6E"})]}),(0,e.jsx)("div",{className:"formula-container",children:(0,e.jsx)(K.Z,{name:"expression",children:(0,e.jsx)(he,{variable:v,readOnly:!0,placeholder:"\u516C\u5F0F\u4E3A\u7A7A\uFF0C\u8BF7\u8BBE\u7F6E"})})}),r.schema&&(0,e.jsx)(ye,{visible:l,value:h,title:"\u6761\u4EF6\u516C\u5F0F\u8BBE\u7F6E",schema:s,onCancel:function(){return d(!1)},functions:[{name:"\u57FA\u7840",functions:[{name:"hah",description:"heih"}]}],onOk:function(B){a.setValuesIn("".concat(t.id,".expression"),B),d(!1)}})]})]})});ue("sequenceFlow",li);var ze=Y.Z.TabPane,ci=(0,C.Pi)(function(){var i=(0,p.useContext)(te),n=i.flow,t=i.active,a=(0,C.cI)(),r=(0,le.IE)(),s=(0,p.useState)(!1),o=(0,b.Z)(s,2),u=o[0],l=o[1],d=(0,p.useMemo)(function(){return We(r.schema)},[r]),v=a.query("".concat(t.id,".expression")).get("value"),h=a.query("".concat(t.id,".flowType")).get("value");return(0,p.useEffect)(function(){n==null||n.setProperties(t.id,{"flowable:expression":"${t.serve(execution)}"})},[v,t]),(0,p.useEffect)(function(){if(h){var m;a.query("*(".concat(t.id,".copyToFlowType,").concat(t.id,".mailFlowType,").concat(t.id,".smsFlowType,").concat(t.id,".httpFlowType)")).forEach(function(B){return B.setDisplay("none")}),(m=a.query("".concat(t.id,".").concat(h,"FlowType")).take())===null||m===void 0||m.setDisplay("visible"),n==null||n.setProperties(t.id,{"s:type":h})}},[h,t]),(0,e.jsxs)(C.Wo,{name:t.id,children:[(0,e.jsx)(C.gN,{name:"id",value:t.id}),(0,e.jsxs)("div",{children:[(0,e.jsx)(ce.Z,{gutter:[10,10],children:(0,e.jsxs)(J.Z,{span:12,children:[(0,e.jsx)("div",{style:{lineHeight:"40px",fontWeight:"bold"},children:"\u670D\u52A1\u7C7B\u578B"}),(0,e.jsx)("div",{children:(0,e.jsx)(K.Z,{name:"flowType",initialValue:"copyTo",children:(0,e.jsxs)(I.Z,{style:{width:200},children:[(0,e.jsx)(I.Z.Option,{value:"copyTo",children:"\u6284\u9001\u4EFB\u52A1"}),(0,e.jsx)(I.Z.Option,{value:"mail",children:"\u53D1\u9001\u90AE\u4EF6"}),(0,e.jsx)(I.Z.Option,{value:"sms",children:"\u53D1\u9001\u77ED\u4FE1"}),(0,e.jsx)(I.Z.Option,{value:"http",children:"\u8C03\u7528\u63A5\u53E3"})]})})})]})}),h==="copyTo"&&(0,e.jsx)(C.jG,{name:"sendFlowType",children:(0,e.jsxs)(Y.Z,{defaultActiveKey:"1",children:[(0,e.jsx)(ze,{tab:"\u5B57\u6BB5\u8BBE\u7F6E",children:(0,e.jsx)(K.Z,{name:"fieldPermission",children:(0,e.jsx)(Ze,{})})},"fieldPermission"),(0,e.jsx)(ze,{tab:"\u57FA\u7840\u8BBE\u7F6E",children:(0,e.jsx)(Le,{settings:["flowLogVisible"]})},"basicSetting"),(0,e.jsx)(ze,{tab:"\u9AD8\u7EA7\u8BBE\u7F6E",children:"\u9AD8\u7EA7\u8BBE\u7F6E"},"advanceSetting")]})}),h==="mail"&&(0,e.jsxs)(C.jG,{name:"mailFlowType",children:[(0,e.jsx)("div",{style:{lineHeight:"40px",fontWeight:"bold"},children:"\u6536\u4EF6\u4EBA"}),(0,e.jsxs)("div",{children:[(0,e.jsx)(ve,{name:"identity"}),(0,e.jsxs)("div",{style:{lineHeight:"40px",fontWeight:"bold"},children:["\u6761\u4EF6\u516C\u5F0F",(0,e.jsx)(T.Z,{type:"link",onClick:function(){return l(!0)},children:"\u70B9\u51FB\u8BBE\u7F6E"})]}),(0,e.jsx)("div",{className:"formula-container",children:(0,e.jsx)(K.Z,{name:"expression",children:(0,e.jsx)(he,{variable:d,readOnly:!0,placeholder:"\u6A21\u677F\u4E3A\u7A7A\uFF0C\u8BF7\u8BBE\u7F6E"})})}),r.schema&&(0,e.jsx)(ye,{visible:u,value:v,title:"\u90AE\u4EF6\u6A21\u677F\u8BBE\u7F6E",schema:r.schema,onCancel:function(){return l(!1)},functionVisible:!1,onOk:function(B){a.setValuesIn("".concat(t.id,".expression"),B),l(!1)}})]})]}),h==="sms"&&(0,e.jsxs)(C.jG,{name:"smsFlowType",children:[(0,e.jsx)("div",{style:{lineHeight:"40px",fontWeight:"bold"},children:"\u6536\u4EF6\u4EBA"}),(0,e.jsxs)("div",{children:[(0,e.jsx)(ve,{name:"identity"}),(0,e.jsxs)("div",{style:{lineHeight:"40px",fontWeight:"bold"},children:["\u6761\u4EF6\u516C\u5F0F",(0,e.jsx)(T.Z,{type:"link",onClick:function(){return l(!0)},children:"\u70B9\u51FB\u8BBE\u7F6E"})]}),(0,e.jsx)("div",{className:"formula-container",children:(0,e.jsx)(K.Z,{name:"expression",children:(0,e.jsx)(he,{variable:d,readOnly:!0,placeholder:"\u6A21\u677F\u4E3A\u7A7A\uFF0C\u8BF7\u8BBE\u7F6E"})})}),r.schema&&(0,e.jsx)(ye,{visible:u,value:v,title:"\u77ED\u4FE1\u6A21\u677F\u8BBE\u7F6E",schema:r.schema,onCancel:function(){return l(!1)},functionVisible:!1,onOk:function(B){a.setValuesIn("".concat(t.id,".expression"),B),l(!1)}})]})]}),h==="http"&&(0,e.jsxs)(C.jG,{name:"httpFlowType",children:[(0,e.jsxs)("div",{style:{lineHeight:"40px",fontWeight:"bold"},children:["\u63A5\u53E3\u5730\u5740\u914D\u7F6E",(0,e.jsx)(T.Z,{type:"link",onClick:function(){return l(!0)},children:"\u70B9\u51FB\u8BBE\u7F6E"})]}),(0,e.jsx)("div",{className:"formula-container",children:(0,e.jsx)(K.Z,{name:"expression",children:(0,e.jsx)(he,{variable:d,readOnly:!0,placeholder:"\u8BF7\u8F93\u5165\u63A5\u53E3\u5730\u5740"})})}),r.schema&&(0,e.jsx)(ye,{visible:u,value:v,title:"\u63A5\u53E3\u5730\u5740\u8BBE\u7F6E",schema:r.schema,onCancel:function(){return l(!1)},functionVisible:!1,onOk:function(B){a.setValuesIn("".concat(t.id,".expression"),B),l(!1)}})]})]})]})});ue("serviceTask",ci);var di=c(73171),vi={Process:"\u53D1\u8D77\u4EBA",serviceTask:"\u53D1\u9001\u8282\u70B9",userTask:"\u5BA1\u6279\u8282\u70B9",sequenceFlow:"\u6D41\u7A0B\u5206\u652F"},hi=(0,C.Pi)(function(){var i=(0,p.useContext)(te),n=i.active,t=i.flow,a=(0,C.cI)(),r=a.query("".concat(n.id,".name")).get("value");return(0,p.useEffect)(function(){t==null||t.updateText(n.id,r)},[n,r,t]),(0,e.jsxs)("div",{className:Ee()("header",(0,gt.snakeCase)(n.type)),children:[(0,e.jsx)("div",{children:(0,e.jsx)(K.P,{name:"name",basePath:n.id,children:(0,e.jsx)(On,{})})}),(0,e.jsxs)("div",{className:"action",children:[vi[n.type],(0,e.jsx)(Ct.Z,{type:"vertical"}),(0,e.jsx)("span",{className:"action-delete",children:(0,e.jsx)(di.Z,{})})]})]})}),fi=hi,te=p.createContext({}),pi=(0,C.Pi)(function(){var i=(0,p.useContext)(te),n=i.active,t=function(){var r=be(n.type);return n&&n.type&&!r&&console.log(n.type+"\u672A\u6CE8\u518C"),n&&n.type&&r?p.createElement(be(n.type)):p.createElement(be("Process"))};return(0,e.jsx)("div",{children:(0,e.jsxs)(ft.Z,{visible:!0,mask:!1,closable:!1,width:500,className:"properties-panel",children:[(0,e.jsx)(fi,{}),t()]})})}),mi=pi,xi=c(99008),It=c(54531);function gi(i){var n=i.lf;function t(){n.dnd.startDrag({type:"startEvent",text:"\u5F00\u59CB"})}function a(){n.dnd.startDrag({type:"userTask"})}function r(){n.dnd.startDrag({type:"serviceTask"})}function s(){n.dnd.startDrag({type:"exclusiveGateway"})}function o(){n.dnd.startDrag({type:"endEvent",text:"\u7ED3\u675F"})}function u(){n.updateEditConfig({stopMoveGraph:!0})}return n&&n.on("selection:selected",function(){n.updateEditConfig({stopMoveGraph:!1})}),(0,e.jsxs)("div",{className:"pattern",children:[(0,e.jsx)("div",{className:"pattern-selection",onMouseDown:function(){return u()}}),(0,e.jsx)("div",{children:"\u9009\u533A"}),(0,e.jsx)("div",{className:"pattern-start",onMouseDown:function(){return t()}}),(0,e.jsx)("div",{children:"\u5F00\u59CB"}),(0,e.jsx)("div",{className:"pattern-user",onMouseDown:function(){return a()}}),(0,e.jsx)("div",{children:"\u5BA1\u6279\u8282\u70B9"}),(0,e.jsx)("div",{className:"pattern-send",onMouseDown:function(){return r()}}),(0,e.jsx)("div",{children:"\u6284\u9001\u8282\u70B9"}),(0,e.jsx)("div",{className:"pattern-condition",onMouseDown:function(){return s()}}),(0,e.jsx)("div",{children:"\u6761\u4EF6\u5224\u65AD"}),(0,e.jsx)("div",{className:"pattern-end",onMouseDown:function(){return o()}}),(0,e.jsx)("div",{children:"\u7ED3\u675F"})]})}var Ei=function(n){return`
<definitions id="Definitions_`.concat(n,`" xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" xmlns:flowable="http://flowable.org/bpmn" xmlns:s="http://surveyking.cn/bpmn" targetNamespace="http://bpmn.io/schema/bpmn" exporter="bpmn-js (https://demo.bpmn.io)" exporterVersion="7.3.0">
  <process id="`).concat(n,`" isExecutable="true">
    <startEvent id="starter" />
  </process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_1">
    <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="`).concat(n,`">
        <bpmndi:BPMNShape id="starter_di" bpmnElement="starter">
          <dc:Bounds x="180" y="120" width="40" height="40" />
        </bpmndi:BPMNShape>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</definitions>
`)},$i={type:"startEvent",text:"\u5F00\u59CB",label:"\u5F00\u59CB",icon:"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='32' height='32'%3E%3Cpath fill='none' d='M0 0h24v24H0z'/%3E%3Cpath d='M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10-4.477 10-10 10zm0-2a8 8 0 1 0 0-16 8 8 0 0 0 0 16zM10.622 8.415l4.879 3.252a.4.4 0 0 1 0 .666l-4.88 3.252a.4.4 0 0 1-.621-.332V8.747a.4.4 0 0 1 .622-.332z' fill='rgba(24,125,255,1)'/%3E%3C/svg%3E"},Ge={type:"userTask",label:"\u5BA1\u6279",icon:"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='32' height='32'%3E%3Cpath fill='none' d='M0 0h24v24H0z'/%3E%3Cpath d='M4 22a8 8 0 1 1 16 0h-2a6 6 0 1 0-12 0H4zm8-9c-3.315 0-6-2.685-6-6s2.685-6 6-6 6 2.685 6 6-2.685 6-6 6zm0-2c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4z' fill='rgba(24,125,255,1)'/%3E%3C/svg%3E",properties:{}},He={type:"serviceTask",label:"\u53D1\u9001",icon:"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='32' height='32'%3E%3Cpath fill='none' d='M0 0h24v24H0z'/%3E%3Cpath d='M1.923 9.37c-.51-.205-.504-.51.034-.689l19.086-6.362c.529-.176.832.12.684.638l-5.454 19.086c-.15.529-.475.553-.717.07L11 13 1.923 9.37zm4.89-.2l5.636 2.255 3.04 6.082 3.546-12.41L6.812 9.17z' fill='rgba(24,125,255,1)'/%3E%3C/svg%3E",cls:"import_icon"},Lt={type:"exclusiveGateway",label:"\u6761\u4EF6\u5224\u65AD",icon:"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='32' height='32'%3E%3Cpath fill='none' d='M0 0H24V24H0z'/%3E%3Cpath d='M9.536 13H7.329c-.412 1.166-1.523 2-2.829 2-1.657 0-3-1.343-3-3s1.343-3 3-3c1.306 0 2.418.835 2.83 2h2.206L13 5h3.17c.412-1.165 1.524-2 2.83-2 1.657 0 3 1.343 3 3s-1.343 3-3 3c-1.306 0-2.417-.834-2.829-2h-2.017l-2.886 4.999L14.155 17h2.016c.411-1.165 1.523-2 2.829-2 1.657 0 3 1.343 3 3s-1.343 3-3 3c-1.306 0-2.417-.834-2.829-2H13l-3.464-6zM19 17c-.552 0-1 .448-1 1s.448 1 1 1 1-.448 1-1-.448-1-1-1zM4.5 11c-.552 0-1 .448-1 1s.448 1 1 1 1-.448 1-1-.448-1-1-1zM19 5c-.552 0-1 .448-1 1s.448 1 1 1 1-.448 1-1-.448-1-1-1z' fill='rgba(24,125,255,1)'/%3E%3C/svg%3E"},yi={type:"endEvent",label:"\u7ED3\u675F",icon:"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='32' height='32'%3E%3Cpath fill='none' d='M0 0h24v24H0z'/%3E%3Cpath d='M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10-4.477 10-10 10zm0-2a8 8 0 1 0 0-16 8 8 0 0 0 0 16zM9 9h6v6H9V9z' fill='rgba(24,125,255,1)'/%3E%3C/svg%3E"},Yi={label:"\u9009\u533A",icon:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAAH6ji2bAAAABGdBTUEAALGPC/xhBQAAAOVJREFUOBGtVMENwzAIjKP++2026ETdpv10iy7WFbqFyyW6GBywLCv5gI+Dw2Bluj1znuSjhb99Gkn6QILDY2imo60p8nsnc9bEo3+QJ+AKHfMdZHnl78wyTnyHZD53Zzx73MRSgYvnqgCUHj6gwdck7Zsp1VOrz0Uz8NbKunzAW+Gu4fYW28bUYutYlzSa7B84Fh7d1kjLwhcSdYAYrdkMQVpsBr5XgDGuXwQfQr0y9zwLda+DUYXLaGKdd2ZTtvbolaO87pdo24hP7ov16N0zArH1ur3iwJpXxm+v7oAJNR4JEP8DoAuSFEkYH7cAAAAASUVORK5CYII=",callback:function(){lf.openSelectionSelect(),lf.once("selection:selected",function(){lf.closeSelectionSelect()})}};function ji(i){var n={icon:"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='32' height='32'%3E%3Cpath fill='none' d='M0 0h24v24H0z'/%3E%3Cpath d='M17 6h5v2h-2v13a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V8H2V6h5V3a1 1 0 0 1 1-1h8a1 1 0 0 1 1 1v3zm1 2H6v12h12V8zm-4.586 6l1.768 1.768-1.414 1.414L12 15.414l-1.768 1.768-1.414-1.414L10.586 14l-1.768-1.768 1.414-1.414L12 12.586l1.768-1.768 1.414 1.414L13.414 14zM9 4v2h6V4H9z' fill='rgba(24,125,255,1)'/%3E%3C/svg%3E",callback:function(a){i.deleteElement(a.id),i.hideContextMenu()}};i.setContextMenuItems(n),i.setContextMenuByType("startEvent",[Ge,He,Lt]),i.setContextMenuByType("userTask",[Ge,He,Lt,yi]),i.setContextMenuByType("exclusiveGateway",[Ge,He])}M().use(ht),M().use(Jt),M().use(L.a9),L.a9.init({disabledPlugins:[L.v2.name]}),M().use(L.Qs),M().use(L.jX),M().use(L.Ou),M().use(L.v2),M().use(L.xV),M().use(F),M().use(L.aC),M().use(L.Ju);function Ji(i,n){var t=document.createElement("a");t.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(n)),t.setAttribute("download",i),t.style.display="none",document.body.appendChild(t),t.click(),document.body.removeChild(t)}var Rt=(0,C.Pi)(function(){var i=(0,le.IE)(),n=(0,le.Ge)(),t=i.id,a=i.name,r=n.loading,s=n.bpmnXml,o=(0,p.useRef)(null),u=(0,p.useRef)(),l=(0,p.useMemo)(function(){return{type:"Process",x:0,y:0,id:t}},[]),d=(0,p.useState)(l),v=(0,b.Z)(d,2),h=v[0],m=v[1];(0,p.useEffect)(function(){if(h.id){var g;(g=u.current)===null||g===void 0||g.selectElementById(h.id)}},[h]),(0,p.useEffect)(function(){if(s){var g;(g=u.current)===null||g===void 0||g.render(s)}},[s]),(0,p.useEffect)(function(){n.getFlow(t)},[n,t]);var B=function(){var x,w,A,N=(x=u.current)===null||x===void 0?void 0:x.getGraphData(),Z=(w=u.current)===null||w===void 0?void 0:w.getGraphRawData(),_=Z==null?void 0:(A=Z.edges.map(function(H){return H.id})).concat.apply(A,(0,k.Z)(Z.nodes.map(function(H){return H.id}))),fe=Object.values(n.form.values).filter(function(H){return(_==null?void 0:_.includes(H.id))||H.id===t});N&&n.saveFlow({bpmnXml:N,projectId:t,nodes:fe}).then(function(H){H.success?O.default.success("\u4FDD\u5B58\u6210\u529F"):O.default.error(H.message)})},P=function(){var x,w,A,N=(x=u.current)===null||x===void 0?void 0:x.getGraphData(),Z=(w=u.current)===null||w===void 0?void 0:w.getGraphRawData(),_=Z==null?void 0:(A=Z.edges.map(function(X){return X.id})).concat.apply(A,(0,k.Z)(Z.nodes.map(function(X){return X.id}))),fe=Object.values(n.form.values).filter(function(X){return(_==null?void 0:_.includes(X.id))||X.id===t}),H=Z.nodes.filter(function(X){return X.type==="startEvent"});if(H.length===0){O.default.error("\u5F00\u59CB\u8282\u70B9\u672A\u8BBE\u7F6E");return}if(H.length!==1){O.default.error("\u5F00\u59CB\u8282\u70B9\u53EA\u80FD\u8BBE\u7F6E\u4E00\u4E2A");return}var kt=Z.nodes.filter(function(X){return X.type==="endEvent"});if(kt.length===0){O.default.error("\u7ED3\u675F\u8282\u70B9\u672A\u8BBE\u7F6E");return}if(kt.length!==1){O.default.error("\u7ED3\u675F\u8282\u70B9\u53EA\u80FD\u8BBE\u7F6E\u4E00\u4E2A");return}N&&n.saveFlow({bpmnXml:N,projectId:t,nodes:fe}).then(function(X){X.success&&n.deploy(t).then(function(Ut){Ut.success?O.default.success("\u53D1\u5E03\u6210\u529F"):O.default.error(Ut.message)})})};(0,p.useEffect)(function(){if(o.current){F.addItem({key:"save",iconClass:"save-icon",title:"",text:"\u4FDD\u5B58",onClick:function(){return B()}}),F.addItem({key:"deploy",iconClass:"deploy-icon",title:"",text:"\u53D1\u5E03",onClick:function(){se.Z.confirm({type:"confirm",title:"\u6D41\u7A0B\u53D1\u5E03",content:"\u786E\u5B9A\u53D1\u5E03\u5F53\u524D\u6D41\u7A0B\u5417\uFF1F",onOk:function(){P()}})}});var g=new(M())({extraConf:{id:t},container:o.current,hideAnchors:!1,grid:{type:"dot",size:20},keyboard:{enabled:!0},snapline:!0});u.current=g,ji(g),g.render(s||Ei(t)),g.on("element:click",function(x){var w=["starter","exclusiveGateway","endEvent"];w.includes(x.data.type)?m(l):m(x.data)}),g.on("blank:click",function(x){m(l)}),g.on("node:add",function(x){m(x.data)})}return function(){F.removeItem("deploy"),F.removeItem("save")}},[]);var D=(0,p.useState)({visible:!1}),j=(0,b.Z)(D,2),f=j[0],E=j[1];return(0,e.jsx)(C.RV,{form:n.form,children:(0,e.jsxs)("div",{style:{height:"100vh",position:"relative"},className:"flow",children:[(0,e.jsx)("div",{ref:o,style:{height:"100%",flex:1}}),(0,e.jsx)(gi,{lf:u.current}),(0,e.jsx)("div",{style:{width:500},children:(0,e.jsx)(te.Provider,{value:{flow:u.current,active:h},children:(0,e.jsx)(mi,{})})}),(0,e.jsxs)(R.Z,{style:{position:"absolute",left:100,bottom:10},children:[(0,e.jsx)(T.Z,{onClick:(0,W.Z)(xe().mark(function g(){var x,w;return xe().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:try{w=(x=u.current)===null||x===void 0?void 0:x.getGraphData(),E({visible:!0,xml:w})}catch(Z){console.error(Z)}case 1:case"end":return N.stop()}},g)})),icon:(0,e.jsx)(xi.Z,{}),size:"small",children:"XML"}),(0,e.jsx)(T.Z,{onClick:function(){var x;console.log((x=u.current)===null||x===void 0?void 0:x.getGraphRawData()),console.log((0,It.ZN)(n.form.values[h.id])),console.log((0,It.ZN)(n.form.values))},children:"\u6570\u636E"})]}),(0,e.jsx)(hn,(0,S.Z)((0,S.Z)({},f),{},{onClose:function(x){E({visible:!1})}}))]})})}),Ci=Rt},11628:function(je,Q,c){"use strict";c.d(Q,{xI:function(){return ne},Ge:function(){return T},IE:function(){return ee}});var S=c(67294),ne=(0,S.createContext)({}),R=ne.Provider;function ee(){var W=(0,S.useContext)(ne);return W.store}function T(){var W=ee();return W.flowStore}}}]);
