(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-03f49971"],{"1b55":function(e,r,t){"use strict";t.r(r);var a=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"wrapper-visual-api"},[t("div",{staticClass:"form-container"},[t("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,"status-icon":"",rules:e.rules,"label-width":"160px"}},[t("el-form-item",{attrs:{label:"请求路径",prop:"path"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.ruleForm.path,callback:function(r){e.$set(e.ruleForm,"path",r)},expression:"ruleForm.path"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"API名称",prop:"name"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.ruleForm.name,callback:function(r){e.$set(e.ruleForm,"name",r)},expression:"ruleForm.name"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"API分组",prop:"group_id"}},[t("el-input",{model:{value:e.ruleForm.group_id,callback:function(r){e.$set(e.ruleForm,"group_id",r)},expression:"ruleForm.group_id"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"数据源ID",prop:"datasource_id"}},[e.sourceList?t("el-select",{staticStyle:{width:"310px"},attrs:{placeholder:"请选择"},model:{value:e.ruleForm.datasource_id,callback:function(r){e.$set(e.ruleForm,"datasource_id",r)},expression:"ruleForm.datasource_id"}},e._l(e.sourceList,(function(e){return t("el-option",{key:"datasource_id_"+e.id,attrs:{label:e.datasourceName,value:e.id}})})),1):e._e()],1),e._v(" "),t("el-form-item",{attrs:{label:"执行的SQL语句",prop:"sql_text"}},[t("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:12},placeholder:"请输入"},model:{value:e.ruleForm.sql_text,callback:function(r){e.$set(e.ruleForm,"sql_text",r)},expression:"ruleForm.sql_text"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"请求参数(传递的json)",prop:"params"}},[t("el-input",{staticStyle:{"white-space":"pre"},attrs:{autosize:{minRows:2,maxRows:12},type:"textarea",placeholder:"请输入"},model:{value:e.ruleForm.params,callback:function(r){e.$set(e.ruleForm,"params",r)},expression:"ruleForm.params"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"描述",prop:"describe"}},[t("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"请输入"},model:{value:e.ruleForm.describe,callback:function(r){e.$set(e.ruleForm,"describe",r)},expression:"ruleForm.describe"}})],1),e._v(" "),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(r){return e.submitForm("ruleForm")}}},[e._v("提交")]),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:function(r){return e.testConnect("ruleForm")}}},[e._v("发送请求")])],1)],1)],1),e._v(" "),t("div",{staticClass:"res-form",domProps:{innerHTML:e._s(e.resStr)}})])},s=[],o=(t("7f7f"),t("b775"));function l(e){return Object(o["a"])({url:"/api/apiConfig/add",method:"post",data:e})}function u(e){return Object(o["a"])({url:"/api/apiConfig/execute",method:"post",data:e})}function i(e){return Object(o["a"])({url:"/api/apiConfig/listDataSourceName",method:"get",params:e})}var n={data:function(){return{ruleForm:{name:"",path:"",group_id:"",describe:"",datasource_id:"",params:"",sql_text:""},paramsArr:[],rules:{name:[{required:!0,message:"不能为空",trigger:"blur"}],path:[{required:!0,message:"不能为空",trigger:"blur"}],group_id:[{required:!0,message:"不能为空",trigger:"blur"}],describe:[{required:!0,message:"不能为空",trigger:"blur"}],datasource_id:[{required:!0,message:"不能为空",trigger:"blur"}],params:[{required:!0,message:"不能为空",trigger:"blur"}],sql_text:[{required:!0,message:"不能为空",trigger:"blur"}]},resStr:"",sourceList:null}},mounted:function(){var e=this;i().then((function(r){e.sourceList=r.content.data}))},methods:{submitForm:function(e){var r=this;this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),!1;l({name:r.ruleForm.name,path:r.ruleForm.path,group_id:r.ruleForm.group_id,describe:r.ruleForm.describe,datasource_id:r.ruleForm.datasource_id,params:r.ruleForm.params,sql_text:r.ruleForm.sql_text}).then((function(){r.$message.success("新增成功"),r.ruleForm={name:"",path:"",group_id:"",describe:"",datasource_id:"",params:"",sql_text:""}}))}))},testConnect:function(e){var r=this;this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),!1;u({datasource_id:r.ruleForm.datasource_id,params:r.ruleForm.params,sql_text:r.ruleForm.sql_text}).then((function(e){r.resStr=JSON.stringify(e,null,2),r.$message.success("连接成功")}),(function(e){r.resStr=JSON.stringify(e,null,2)}))}))},resetForm:function(e){this.$refs[e].resetFields()}}},m=n,c=(t("e554"),t("2877")),p=Object(c["a"])(m,a,s,!1,null,"b428b4f6",null);r["default"]=p.exports},e360:function(e,r,t){},e554:function(e,r,t){"use strict";t("e360")}}]);